<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="Your Site&#x27;s RSS Feed" href="/acorns/rss.xml"/><link rel="stylesheet" type="text/css" href="/acorns/libs/zoom/zoom.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/story-writer-markdown-default.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/story-writer-markdown-components.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/fonts/Webfonts/oswald/stylesheet.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/xsjfonts/fontstyles/zh.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/font-awesome.min.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/svg-with-js.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/gitalk.css?version=sculpting_1_1"/><link rel="icon" type="image/png" href="/acorns/favicon/favicon.png"/><link rel="mask-icon" href="/acorns/favicon/icon.svg" color="brown"/><link rel="icon" type="image/svg+xml" href="/acorns/favicon/favicon.svg"/><link rel="stylesheet" type="text/css" href="/acorns/fonts/Webfonts/aladin/stylesheet.css"/><link as="script" rel="preload" href="/acorns/webpack-runtime-b733388348fff5eacca1.js"/><link as="script" rel="preload" href="/acorns/framework-29ba174b433dc5858bed.js"/><link as="script" rel="preload" href="/acorns/545f34e4-5287ae6acbc1289e5dd0.js"/><link as="script" rel="preload" href="/acorns/252f366e-a013f1a16a738605ba7c.js"/><link as="script" rel="preload" href="/acorns/app-769f74fe8327c9fb4428.js"/><link as="script" rel="preload" href="/acorns/41aca86e-8b5629aa189eae61d7b0.js"/><link as="script" rel="preload" href="/acorns/05d954cf-b0068c1aacfd08ef52dc.js"/><link as="script" rel="preload" href="/acorns/d24d3e064b601c3fa92397aa9f8c5e3fc3365436-b3b52e1b95113f3f815e.js"/><link as="script" rel="preload" href="/acorns/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js-fb9d310599f1bd239803.js"/><link as="fetch" rel="preload" href="/acorns/page-data/https:/crospnet/blog/administration/install-configure-redsocks-proxy-centos-linux/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/acorns/page-data/sq/d/2682448919.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/acorns/page-data/sq/d/2682448919.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/acorns/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="116ag8">body{--theme-ui-colors-text:var(--theme-ui-colors-text,#000);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#33e);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#119);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#f6f6f6);--theme-ui-colors-accent:var(--theme-ui-colors-accent,#609);--theme-ui-colors-gray:var(--theme-ui-colors-gray,#777);--theme-ui-colors-meta:var(--theme-ui-colors-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,#ffffcc);color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#fff);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#060606);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#3cf);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#e0f);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#191919);--theme-ui-colors-gray:var(--theme-ui-colors-modes-dark-gray,#999);--theme-ui-colors-accent:var(--theme-ui-colors-modes-dark-accent,#c0f);--theme-ui-colors-meta:var(--theme-ui-colors-modes-dark-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-modes-dark-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-modes-dark-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-modes-dark-highlight,#29112c);}body.theme-ui-deep{--theme-ui-colors-text:var(--theme-ui-colors-modes-deep-text,hsl(210,50%,96%));--theme-ui-colors-background:var(--theme-ui-colors-modes-deep-background,hsl(230,25%,18%));--theme-ui-colors-primary:var(--theme-ui-colors-modes-deep-primary,hsl(260,100%,80%));--theme-ui-colors-secondary:var(--theme-ui-colors-modes-deep-secondary,hsl(290,100%,80%));--theme-ui-colors-accent:var(--theme-ui-colors-modes-deep-accent,hsl(290,100%,80%));--theme-ui-colors-muted:var(--theme-ui-colors-modes-deep-muted,hsla(230,20%,0%,20%));--theme-ui-colors-gray:var(--theme-ui-colors-modes-deep-gray,hsl(210,50%,60%));--theme-ui-colors-meta:var(--theme-ui-colors-modes-deep-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-modes-deep-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-modes-deep-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-modes-deep-highlight,hsl(260,20%,40%));}body.theme-ui-swiss{--theme-ui-colors-text:var(--theme-ui-colors-modes-swiss-text,hsl(10,20%,20%));--theme-ui-colors-background:var(--theme-ui-colors-modes-swiss-background,hsl(10,10%,98%));--theme-ui-colors-primary:var(--theme-ui-colors-modes-swiss-primary,hsl(10,80%,50%));--theme-ui-colors-secondary:var(--theme-ui-colors-modes-swiss-secondary,hsl(10,60%,50%));--theme-ui-colors-accent:var(--theme-ui-colors-modes-swiss-accent,hsl(250,60%,30%));--theme-ui-colors-muted:var(--theme-ui-colors-modes-swiss-muted,hsl(10,20%,94%));--theme-ui-colors-gray:var(--theme-ui-colors-modes-swiss-gray,hsl(10,20%,50%));--theme-ui-colors-meta:var(--theme-ui-colors-modes-swiss-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-modes-swiss-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-modes-swiss-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-modes-swiss-highlight,hsl(10,40%,90%));}</style><style data-emotion-css="1s13q8j">*{box-sizing:border-box;}body{margin:0;font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;line-height:1.5;font-weight:400;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="14i9w9y">.css-14i9w9y{min-height:100VH;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="css-14i9w9y"><style data-emotion-css="7zod2p">html{overflow-y:scroll;}body{margin:0;color:#000;background-color:#fff;}</style><div class="headroom-wrapper"><div style="position:relative;top:0;left:0;right:0;z-index:2;-webkit-transform:translate3D(0, 0, 0);-ms-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)" class="headroom headroom--unfixed"><style data-emotion-css="st9nty">.css-st9nty{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--theme-ui-colors-background,#fff);border-bottom:1px solid;width:100%;}.css-st9nty h1{margin:0;}.css-st9nty ul{margin-left:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;list-style-type:none;}.css-st9nty li{margin-left:16px;}</style><style data-emotion-css="luk5ak">.css-luk5ak{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--theme-ui-colors-background,#fff);border-bottom:1px solid;width:100%;}.css-luk5ak h1{margin:0;}.css-luk5ak ul{margin-left:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;list-style-type:none;}.css-luk5ak li{margin-left:16px;}</style><div class="css-luk5ak"><style data-emotion-css="16qc66y">.css-16qc66y{font-family:inherit;font-size:24px;color:inherit;background-color:transparent;width:32px;height:32px;padding:4px;margin:0;margin-left:16px;border:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;}.css-16qc66y:focus{outline:2px solid;}@media screen and (min-width:40em){.css-16qc66y{display:none;}}</style><button title="Toggle Menu" class="css-16qc66y"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button><style data-emotion-css="umt6is">.css-umt6is{margin-left:16px;font-weight:bold;font-size:1.5em;}.css-umt6is a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}</style><div class="css-umt6is"><a href="https://suziwen.github.io/acorns"><style data-emotion-css="11lk46i">.css-11lk46i{font-size:1.5em;vertical-align:text-bottom;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-11lk46i" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M206.135 23.568c-61.993.106-133.212 38.319-173.762 85.328 0 0 94.532-8.388 109.732 35.477 24.55 70.846-103.768 62.832-105.619 173.623-1.394 83.471 89.36 169.758 176.1 169.812 4.214 1.405 181.953 0 181.953 0 19.783-.28 20.606-22.551-48.812-36.637 145.592-147.853-86.742-159.073-85.456-45.779-17.956-18.803.577-99.816 97.692-95.832 32.91 23.48 51.817 27.373 88.56 19.284 6.982-1.537 12.05-25.665-5.462-27.064l-31.78-2.54c-28.106-25.677-34.818-36.477-6.67-57.463 68.87 18.058 77.047 12.076 77.016-13.33-.03-24.855-9.527-90.633-65.832-93.815-7.701-10.311 9.79-42.042-3.953-42.957-19.014-1.266-50.482 28.417-46.266 43.787-18.335 7.755-38.728 31.156-59.15 59.614-69.316 25.43-119.49 142.639-120.15 170.632-.579-182.435 153.242-180.594 140.216-244.77-14.07-69.324-66.992-97.458-118.357-97.37zM432.807 169.97c7.164 0 12.972 5.808 12.972 12.973 0 7.164-5.808 12.972-12.972 12.972-7.165 0-12.973-5.808-12.973-12.972 0-7.165 5.808-12.973 12.973-12.973z"></path></svg><style data-emotion-css="14uqj98">.css-14uqj98{font-family:aladin,sans-serif;font-weight:normal;}</style><span class="css-14uqj98">Scrat&#x27;s Acorn</span></a></div><style data-emotion-css="qwlsg7">.css-qwlsg7{display:none;margin-left:auto;}@media screen and (min-width:650px){.css-qwlsg7{display:block;}}</style><div class="css-qwlsg7"><ul><li><style data-emotion-css="1dbh7qa">.css-1dbh7qa{display:block;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:14px;font-weight:bold;}.css-1dbh7qa.active{color:var(--theme-ui-colors-primary,#33e);}</style><style data-emotion-css="bpnmkh">.css-bpnmkh{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary,#33e);display:block;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:14px;font-weight:bold;}.css-bpnmkh:hover{color:var(--theme-ui-colors-secondary,#119);}.css-bpnmkh.active{color:var(--theme-ui-colors-primary,#33e);}</style><a class="css-bpnmkh" href="/acorns/">主页</a></li><li><a class="css-bpnmkh" href="/acorns/tags">标签</a></li><li><a class="css-bpnmkh" href="/acorns/archives">归档</a></li><li><a class="css-bpnmkh" href="/acorns/search">搜索</a></li><li><a href="https://github.com/suziwen/markdownxiaoshujiang" target="_blank" rel="noopener noreferrer" class="css-1dbh7qa">Github</a></li></ul></div><style data-emotion-css="oiscss">.css-oiscss{margin-left:auto;margin-right:16px;}@media screen and (min-width:650px){.css-oiscss{margin-left:8px;}}</style><style data-emotion-css="ofhzqr">.css-ofhzqr{-webkit-appearance:none;-moz-appearance:none;appearance:none;font-family:inherit;font-size:14px;font-weight:bold;margin:0;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-muted,#f6f6f6);border:0;border-radius:2px;margin-left:auto;margin-right:16px;}.css-ofhzqr:focus{outline:2px solid;}@media screen and (min-width:650px){.css-ofhzqr{margin-left:8px;}}</style><button class="css-ofhzqr">default</button></div></div></div><style data-emotion-css="13pmxen">.css-13pmxen{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;}</style><div class="css-13pmxen"><style data-emotion-css="mzzgn5">.css-mzzgn5{width:initial;-webkit-flex:none;-ms-flex:none;flex:none;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:32px;margin-top:64px;}@media screen and (min-width:650px){.css-mzzgn5{display:none;width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-top:0;}}</style><div><style data-emotion-css="rrk7cz">.css-rrk7cz{position:fixed;top:0;left:0;bottom:0;z-index:1;min-width:0;width:256px;max-height:100vh;overflow-x:visible;overflow-y:auto;-webkit-overflow-scrolling:touch;-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translate(-100%);-ms-transform:translate(-100%);transform:translate(-100%);background-color:var(--theme-ui-colors-background,#fff);width:initial;-webkit-flex:none;-ms-flex:none;flex:none;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:32px;margin-top:64px;}@media screen and (min-width:650px){.css-rrk7cz{position:-webkit-sticky;position:sticky;bottom:auto;max-height:none;-webkit-transform:none;-ms-transform:none;transform:none;background-color:transparent;}}@media screen and (min-width:650px){.css-rrk7cz{display:none;width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-top:0;}}</style><div class="css-rrk7cz"><style data-emotion-css="1rvtlej">.css-1rvtlej{list-style:none;padding:0;margin:0;}</style><ul class="css-1rvtlej"><li><style data-emotion-css="70qvj9">.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/">主页</a></div></li><li><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/tags">标签</a></div></li><li><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/archives">归档</a></div></li><li><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/search">搜索</a></div></li><li><div class="css-70qvj9"><a class="css-1dbh7qa" href="https://github.com/suziwen/markdownxiaoshujiang" target="_blank" rel="noopener noreferrer">Github</a></div></li></ul></div></div><style data-emotion-css="2mmr94">.css-2mmr94{position:fixed;max-width:210px;z-index:1;display:none;opacity:0.3;-webkit-transition:opacity .5s;transition:opacity .5s;top:0;bottom:0;left:initial;right:0;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media screen and (min-width:650px){.css-2mmr94{display:none;left:0;right:initial;}}@media screen and (min-width:850px){.css-2mmr94{display:none;}}@media screen and (min-width:1200px){.css-2mmr94{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-2mmr94:hover{opacity:1;}.css-2mmr94 .toc-list{background-color:var(--theme-ui-colors-background,#fff);list-style-type:none;margin:0;padding:0;padding-left:16px;padding-top:16px;}.css-2mmr94 .toc-list .toc-list-item{line-height:1.2em;padding-bottom:16px;}.css-2mmr94 .toc-list .toc-list-item:last-child{padding-bottom:0;}.css-2mmr94 .toc-list .toc-link{color:var(--theme-ui-colors-gray,#777);-webkit-text-decoration:none;text-decoration:none;}.css-2mmr94 .toc-list .is-active-link{color:var(--theme-ui-colors-text,#000);font-weight:bold;}</style><div class="toc css-2mmr94"></div><style data-emotion-css="judnid">.css-judnid{-webkit-flex:1;-ms-flex:1;flex:1;z-index:0;overflow:hidden;}</style><div class="css-judnid"><style data-emotion-css="16jkoar">.css-16jkoar{padding:16px;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;min-height:100%;max-width:900px;}@media screen and (min-width:650px){.css-16jkoar{padding:64px;}}</style><div class="css-16jkoar"><section><style data-emotion-css="bzcaho">.css-bzcaho{position:fixed;top:0;left:0;right:0;width:100%;height:3px;background:var(--theme-ui-colors-highlight,#ffffcc);z-index:999;-webkit-transform-origin:0;-ms-transform-origin:0;transform-origin:0;}@media screen and (min-width:1200px){.css-bzcaho{display:none;}}</style><div style="transform:scaleX(0) translateZ(0)" class="css-bzcaho"></div><style data-emotion-css="1yzwfkz">.css-1yzwfkz{cursor:pointer;-webkit-transition:0.35s opacity;transition:0.35s opacity;position:fixed;bottom:1rem;right:1.5rem;height:48px;width:48px;overflow:hidden;z-index:999;display:none;opacity:0;pointer-events:none;}@media screen and (min-width:1200px){.css-1yzwfkz{display:block;}}.css-1yzwfkz:hover #arrow{opacity:1;}</style><div class="css-1yzwfkz"><style data-emotion-css="tfdnh9">.css-tfdnh9 #arrow{-webkit-transition:0.35s all;transition:0.35s all;fill:var(--theme-ui-colors-gray,#777);-webkit-transform:scale(0.22) translate(48px,48px);-ms-transform:scale(0.22) translate(48px,48px);transform:scale(0.22) translate(48px,48px);}.css-tfdnh9 #progress{stroke:var(--theme-ui-colors-text,#000);}.css-tfdnh9 #outline{stroke:var(--theme-ui-colors-gray,#777);}</style><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 35 35" xml:space="preserve" class="css-tfdnh9"><path id="outline" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"></path><path id="arrow" d="M3.352,48.296l28.56-28.328l28.58,28.347c0.397,0.394,0.917,0.59,1.436,0.59c0.52,0,1.04-0.196,1.436-0.59   c0.793-0.787,0.793-2.062,0-2.849l-29.98-29.735c-0.2-0.2-0.494-0.375-0.757-0.475c-0.75-0.282-1.597-0.107-2.166,0.456   L0.479,45.447c-0.793,0.787-0.793,2.062,0,2.849C1.273,49.082,2.558,49.082,3.352,48.296z"></path><path fill="none" id="progress" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"></path></svg></div><style data-emotion-css="1tr4euk">.css-1tr4euk{font-family:oswald,sans-serif;}</style><p class="css-1tr4euk">August 04, 2021</p></section><style data-emotion-css="1ud4cyp">.css-1ud4cyp{box-sizing:border-box;margin:0;min-width:0;font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;font-weight:700;line-height:1.25;}</style><h1 class="css-1ud4cyp">How to install and configure Redsocks on Centos Linux</h1><section class="post-body"><style data-emotion-css="1jye6mf">.css-1jye6mf{font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;line-height:1.5;font-weight:400;}.css-1jye6mf root{font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;line-height:1.5;font-weight:400;}.css-1jye6mf h1{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:32px;}.css-1jye6mf h2{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:24px;}.css-1jye6mf h3{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:20px;}.css-1jye6mf h4{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:16px;}.css-1jye6mf h5{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:14px;}.css-1jye6mf h6{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:12px;}.css-1jye6mf p{color:var(--theme-ui-colors-text,#000);font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;font-weight:400;line-height:1.5;}.css-1jye6mf a{color:var(--theme-ui-colors-primary,#33e);}.css-1jye6mf a:hover{color:var(--theme-ui-colors-secondary,#119);}.css-1jye6mf pre{font-family:'Roboto Mono',monospace;overflow-x:auto;}.css-1jye6mf pre code{color:inherit;}.css-1jye6mf code{font-family:'Roboto Mono',monospace;color:var(--theme-ui-colors-secondary,#119);font-size:14px;}.css-1jye6mf table{width:100%;margin-top:32px;margin-bottom:32px;border-collapse:separate;border-spacing:0;}.css-1jye6mf table th,.css-1jye6mf table td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted,#f6f6f6);border-bottom-style:solid;}.css-1jye6mf th{vertical-align:bottom;border-bottom-width:2px;}.css-1jye6mf td{vertical-align:top;border-bottom-width:1px;}.css-1jye6mf img{max-width:100%;}.css-1jye6mf Container{padding:16px;max-width:1024px;}.css-1jye6mf inlineCode{font-family:'Roboto Mono',monospace;color:var(--theme-ui-colors-secondary,#119);background-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf hr{border:0;border-bottom:1px solid;border-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf blockquote{padding:16px;margin-top:16px;margin-bottom:16px;margin-left:8px;margin-right:16px;border-left-width:5px;border-left-style:solid;border-left-color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf .xiaoshujiang_pre{white-space:pre-wrap;font-family:'Roboto Mono',monospace;tab-size:4;}.css-1jye6mf .xiaoshujiang_pre .ol_linenums{margin-top:0;}.css-1jye6mf .hljs{padding:8px;color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf .hljs .hljs-subst{color:var(--theme-ui-colors-text,#000);}.css-1jye6mf .hljs .hljs-comment{color:var(--theme-ui-colors-gray,#777);}.css-1jye6mf .hljs .hljs-keyword,.css-1jye6mf .hljs .hljs-attribute,.css-1jye6mf .hljs .hljs-selector-tag,.css-1jye6mf .hljs .hljs-meta-keyword,.css-1jye6mf .hljs .hljs-doctag,.css-1jye6mf .hljs .hljs-name{font-weight:bold;}.css-1jye6mf .hljs .hljs-type,.css-1jye6mf .hljs .hljs-string,.css-1jye6mf .hljs .hljs-number,.css-1jye6mf .hljs .hljs-selector-id,.css-1jye6mf .hljs .hljs-selector-class,.css-1jye6mf .hljs .hljs-quote,.css-1jye6mf .hljs .hljs-template-tag,.css-1jye6mf .hljs .hljs-deletion{color:var(--theme-ui-colors-primary,#33e);}.css-1jye6mf .hljs .hljs-title,.css-1jye6mf .hljs .hljs-section{color:var(--theme-ui-colors-primary,#33e);font-weight:bold;}.css-1jye6mf .hljs .hljs-regexp,.css-1jye6mf .hljs .hljs-symbol,.css-1jye6mf .hljs .hljs-variable,.css-1jye6mf .hljs .hljs-template-variable,.css-1jye6mf .hljs .hljs-link,.css-1jye6mf .hljs .hljs-selector-attr,.css-1jye6mf .hljs .hljs-selector-pseudo{color:var(--theme-ui-colors-secondary,#119);}.css-1jye6mf .hljs .hljs-literal{color:var(--theme-ui-colors-literal,#78A960);}.css-1jye6mf .hljs .hljs-built_in,.css-1jye6mf .hljs .hljs-bullet,.css-1jye6mf .hljs .hljs-code,.css-1jye6mf .hljs .hljs-addition{color:var(--theme-ui-colors-built,#397300);}.css-1jye6mf .hljs .hljs-meta{color:var(--theme-ui-colors-meta,#1f7199);}.css-1jye6mf .hljs .hljs-meta-string{color:var(--theme-ui-colors-accent,#609);}.css-1jye6mf .hljs .hljs-emphasis{font-style:italic;}.css-1jye6mf .hljs .hljs-strong{font-weight:bold;}</style><div class="css-1jye6mf"><div><style></style>


	<div class="preview html_preview xsj_export_zip"><div style="overflow: hidden; position: absolute; top: 0; height: 1px; width: auto; padding: 0; border: 0; margin: 0; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><svg><defs id="MathJax_SVG_glyphs"/><defs xmlns="http://www.w3.org/2000/svg"><filter xmlns="http://www.w3.org/2000/svg" id="dropshadow" height="130%">      <fegaussianblur in="SourceAlpha" stddeviation="3"/>       <feoffset dx="2" dy="2" result="offsetblur"/>       <femerge>         <femergenode/>        <femergenode in="SourceGraphic"/>       </femerge>    </filter><filter id="editing-stripe-bk" filterunits="userSpaceOnUse" x="-100%" y="-100%" width="300%" height="300%"><feflood flood-color="#700f0f" result="flood1"/><feflood flood-color="#fff" flood-opacity="0.5" result="flood2"/><feimage xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAwcHgiIGhlaWdodD0iMTAwMHB4Ij48ZGVmcz48cGF0dGVybiBpZD0icGF0dGVybiIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjQiIGhlaWdodD0iNCI+PHBhdGggZD0iTSAtNCAtNCBMIDggOCBNIC04IC00IEwgNCA4IE0gLTQgLTggTCA4IDQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI3BhdHRlcm4pIi8+PC9zdmc+" x="0" y="0" width="2000" height="1000" result="image"/><fetile in="image" result="tile"/><fecomposite operator="in" in="flood1" in2="tile" result="tile2"/><fegaussianblur in="SourceAlpha" stddeviation="10" result="blur"/><fecomposite operator="in" in="tile2" in2="blur" result="cloud"/><femorphology operator="dilate" radius="2" in="SourceAlpha" result="dilate"/><fecomposite operator="in" in="flood2" in2="dilate" result="base"/><femerge><femergenode in="cloud"/><femergenode in="base"/><femergenode in="SourceGraphic"/></femerge></filter></defs></svg></div><blockquote class="markdown_blockquote">
<p class="xsj_paragraph xsj_paragraph_level_1"><span class="xsj_placeholder_span"></span>本文为转载文章, 仅用于自己的知识管理收集, 如果涉及侵权,请联系 <a href="mailto:suziwen1@gmail.com" class="xsj_link xsj_auto_link">suziwen1@gmail.com</a>,会第一时间删除<br>
收集该文章,并非代表本人支持文中观点,只是觉得文章内容容易引起思考,讨论,有它自有的价值</p>
<p class="xsj_paragraph xsj_paragraph_level_1"><span class="xsj_placeholder_span"></span>转载自: <a href="https://crosp.net/blog/administration/install-configure-redsocks-proxy-centos-linux/" class="xsj_link xsj_auto_link">https://crosp.net/blog/administration/install-configure-redsocks-proxy-centos-linux/</a></p>
</blockquote>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="toc mindmap_toc mindmap_container" data-vdom-skip="true" data-hash="3490696b6cfb21db7e5c468e915a10ca_mindmap_toc"><div class="xsj_mindmap xsj_mindmap_toc"><svg id="xsj_mindmap_toc_1628091625283" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="xsj_svg_viewbox" style="max-width:1425px;max-height:692px;" viewbox="0 0 1425 692" width="100%" height="100%"><g transform="translate(571,368) scale(1)"><g class="markmap-link" style="fill:none;"><path stroke="#dc3912" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,234 443,234 L445,234"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,234)"><path class="markmap-node-path" d="M0,0L96,0" stroke-width="4" stroke="#dc3912"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(96, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(220, 57, 18);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#ff9900" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,156 443,156 L445,156"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,156)"><path class="markmap-node-path" d="M0,0L356,0" stroke-width="4" stroke="#ff9900"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(356, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(255, 153, 0);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#109618" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,78 443,78 L445,78"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,78)"><path class="markmap-node-path" d="M0,0L283,0" stroke-width="4" stroke="#109618"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(283, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(16, 150, 24);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#990099" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,0 443,0 L445,0"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,0)"><path class="markmap-node-path" d="M0,0L283,0" stroke-width="4" stroke="#990099"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(283, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(153, 0, 153);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#0099c6" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,-78 443,-78 L445,-78"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,-78)"><path class="markmap-node-path" d="M0,0L269,0" stroke-width="4" stroke="#0099c6"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(269, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(0, 153, 198);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#dd4477" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,-156 443,-156 L445,-156"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,-156)"><path class="markmap-node-path" d="M0,0L362,0" stroke-width="4" stroke="#dd4477"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(362, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(221, 68, 119);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#66aa00" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,-234 443,-234 L445,-234"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,-234)"><path class="markmap-node-path" d="M0,0L245,0" stroke-width="4" stroke="#66aa00"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(245, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(102, 170, 0);"/></g></g><g class="markmap-link" style="fill:none;"><path stroke="#3366cc" stroke-width="4" d="M335,-39 L340,-39 C412,-39 407,-312 443,-312 L445,-312"/><polygon class="markmap-link-polygon" stroke-width="0" transform="translate(335, -39)" points="0,-3 5,0 0,3 -5,0" style="fill: white;"/><g transform="translate(443,-312)"><path class="markmap-node-path" d="M0,0L115,0" stroke-width="4" stroke="#3366cc"/><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(115, 0)" points="0,-2 5,0 0,2 -5,0" style="fill: rgb(51, 102, 204);"/></g></g><g class="markmap-node markmap-root-node" transform="translate(-479,-39)"><polygon class="markmap-node-polygon" stroke-width="0" transform="translate(813, 0)" points="0,-3 5,0 0,3 -5,0" style="fill: rgb(51, 102, 204);"/><g transform="translate(1, -34)"><rect class="markmap-node-rect" rx="10" ry="10" height="68" width="812" fill="rgb(78, 156, 255)" stroke="#3366cc" stroke-width="1"/><text class="markmap-node-text" alignment-baseline="middle" x="407" y="38" text-anchor="middle" style="font: bolder 30px sans-serif; fill-opacity: 1; fill: rgb(255, 255, 255);">How to install and configure Redsocks on Centos Linux</text></g></g><g class="markmap-node" transform="translate(443,234)"><a xlink:href="#conclusion_8"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); stroke: white; stroke-width: 2px; cursor: pointer;">Conclusion</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); cursor: pointer;">Conclusion</text></a></g><g class="markmap-node" transform="translate(443,156)"><a xlink:href="#step20520e2809420testing20proxies20with20redsocks_7"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); stroke: white; stroke-width: 2px; cursor: pointer;">Step 5 — Testing proxies with Redsocks</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); cursor: pointer;">Step 5 — Testing proxies with Redsocks</text></a></g><g class="markmap-node" transform="translate(443,78)"><a xlink:href="#step20420e2809420configuring20redsocks_6"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;">Step 4 — Configuring Redsocks</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;">Step 4 — Configuring Redsocks</text></a></g><g class="markmap-node" transform="translate(443,0)"><a xlink:href="#step20320e2809420setting20iptables20rules_5"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(153, 0, 153); stroke: white; stroke-width: 2px; cursor: pointer;">Step 3 — Setting Iptables Rules</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(153, 0, 153); cursor: pointer;">Step 3 — Setting Iptables Rules</text></a></g><g class="markmap-node" transform="translate(443,-78)"><a xlink:href="#step20220e2809420compiling20redsocks_4"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(0, 153, 198); stroke: white; stroke-width: 2px; cursor: pointer;">Step 2 — Compiling Redsocks</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(0, 153, 198); cursor: pointer;">Step 2 — Compiling Redsocks</text></a></g><g class="markmap-node" transform="translate(443,-156)"><a xlink:href="#step20120e2809420getting20redsocks20source20code_3"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(221, 68, 119); stroke: white; stroke-width: 2px; cursor: pointer;">Step 1 — Getting Redsocks source code</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(221, 68, 119); cursor: pointer;">Step 1 — Getting Redsocks source code</text></a></g><g class="markmap-node" transform="translate(443,-234)"><a xlink:href="#how20does20redsocks20work20_2"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(102, 170, 0); stroke: white; stroke-width: 2px; cursor: pointer;">How does Redsocks work ?</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(102, 170, 0); cursor: pointer;">How does Redsocks work ?</text></a></g><g class="markmap-node" transform="translate(443,-312)"><a xlink:href="#prerequisites_1"><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;">Prerequisites</text><text class="markmap-node-text" y="-5" text-anchor="start" x="0" style="fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;">Prerequisites</text></a></g><g class="annotation-group"><g class="annotations"/></g></g></svg></div></div><p></p>
<p class="xsj_paragraph xsj_paragraph_level_0"><strong class="markdown_strong_asterisk">Redsocks</strong> is the tool that allows you to proxify(redirect) network traffic through a <strong class="markdown_strong_asterisk">SOCKS4</strong>, <strong class="markdown_strong_asterisk">SOCKS5</strong> or <strong class="markdown_strong_asterisk">HTTPs</strong> proxy server. It works on the lowest level, the kernel level (<strong class="markdown_strong_asterisk">iptables</strong>). The other possible way is to use <strong class="markdown_strong_asterisk">application level proxy</strong>, when <strong class="markdown_strong_asterisk">the proxy client</strong> is implemented in the same language as an application is written in. <strong class="markdown_strong_asterisk">Redsocks</strong> operates on the lowest system level, that’s why all running application don’t even have an idea that network traffic is sent through a proxy server, as a result it is called a <strong class="markdown_strong_asterisk">transparent proxy redirector</strong>.</p>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="prerequisites_1"><div class="xiaoshujiang_element xsj_anchor">
  <a name="prerequisites_1" class="blank_anchor_name"></a><a id="prerequisites_1" class="blank_anchor_id"></a><a name="prerequisites" class="blank_anchor_name"></a><a id="prerequisites" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Prerequisites</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">If you are reading this article, you should probably have an idea why do you need to use <strong class="markdown_strong_asterisk">a proxy server</strong>. Furthermore, you should be acquainted with basic proxy terms and definitions in order to understand everything described in this tutorial. It wouldn’t hurt to have some Linux administration skills as well.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">For this tutorial I will be using <strong class="markdown_strong_asterisk">Centos 7 Minimal installation</strong>, it has only the most essential applications installed. But you are free to use any distro, you may skip some steps then.</p>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="how20does20redsocks20work20_2"><div class="xiaoshujiang_element xsj_anchor">
  <a name="how20does20redsocks20work20_2" class="blank_anchor_name"></a><a id="how20does20redsocks20work20_2" class="blank_anchor_id"></a><a name="how-does-redsocks-work" class="blank_anchor_name"></a><a id="how-does-redsocks-work" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">How does Redsocks work ?</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">Before start installing <strong class="markdown_strong_asterisk">Redsocks</strong>, I think it is always worth to know how something works internally. And it will help to understand this tool better and therefore troubleshoot issues.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">First of all, <strong class="markdown_strong_asterisk">Redsocks</strong> leverages features provided by <strong class="markdown_strong_asterisk">the Linux kernel firewall</strong> (<strong class="markdown_strong_asterisk">Netfilter module</strong>)</p>
<p class="xsj_paragraph xsj_paragraph_level_0">I hope this diagram will help you to understand the flow of a packet while using <strong class="markdown_strong_asterisk">Redsocks</strong>.</p>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:688px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 61.328125%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='246'%3e%3cpath%20d='M367%202l-9%202-4%201v12c0%2012%200%2012-2%2012l-2%201c1%201%200%202-1%202l-1%202%202-1h3c1-1%201%200%201%205v7l9%202%2013%203c2-1%204-1%205%201%203%203%2011%202%2014-1%205-5%205-12%201-17-3-2-3-3-3-15V5l-8-3c-9-2-10-2-18%200m0%201l-9%203h-1l-1%202c0%201%201%202%207%204l7%203-7-1-7-3v9c0%206%200%208%201%206l1-4%202%203%207%205%205%202V21l1-10%204-2%209-2%205-1-8-3-8-2-8%202M14%2027l-1%205c0%203%201%204%206%204l6-2c1-1%201-1%203%201h5l3%201c3%200%204-5%202-7-2-1-5%200-5%202%201%201-4%204-5%203s1-4%202-3l2-1c0-2-3-2-4-1-2%202-2%202-3%200-2-2-5%200-5%203l-2%202c-3%200-3-1-3-4l-1-3m345%2040c-2%201-1%203%202%204l1%201h-4c0%202%203%202%205%201h8l2%201%202-1-1-1-2-2%202-1%202%201v2c0%202%200%202%201%201h2l1%201v-5h-1l-2-2h-1c0%201-1%202-2%201l-3%201h-1c-2-2-5-1-5%201l-1%201v-3c0-2-4-3-5-1M111%2096c-16%2017-20%2020-22%2020H76l-11%201c-1%201%202%201%2010%201l12%201h3c2-1%203-1%2022%2019l20%2019%2020-19%2020-20h7l8%201h2c2-1%202-1%202%209%200%208%200%2010%202%2011%201%202%205%202%2034%202%2036%200%2034%200%2034-8%200-3%200-3%202-2l2%201-2-2c-2-1-2-2-2-8v-6h33a3397%203397%200%200058%203c2-1%202-1%202%205l1%206%209%203c6%202%2010%203%2012%202s3%200%205%201c4%203%2011%203%2015-1l3-5%201-2v-2l-1-2-3-5-3-3V90l-9-2-9-3-10%203-10%203-1%2012c0%2012%200%2012-2%2011-2%200-2%200-1%201l-19%201-45-1h-26v-6c0-4%201-6%202-7v-2c-2%201-2%200-2-4%200-8%201-8-35-8-38%200-35-1-35%2016%200%2012%200%2012-2%2012h-17l-20-20-20-20-21%2020m1%201l-19%2020%2020%2019%2019%2019%2019-19%2019-19-19-20-20-19-19%2019m252-8c-7%202-8%203-8%205l1%202c1-1%2013%203%2013%204l-7-1-7-2a96%2096%200%20001%2015c0-5%200-5%202-3%201%202%2011%208%2012%208l1-10V96l4-1%209-2c6-2%206-2-2-4-7-2-8-2-19%200m-169%2029v20h21c19%200%2021%200%2018-1l-6-2c-5%200-15-4-18-6-2-2-2-3-2-12l-1-11v-4c0-2%201-2%2010-2l11%201-1%204v4h7c6%200%209%201%207%204-2%205-1%209%203%2013%205%204%205%206%202%209l-2%203h14V99l-32-1h-31v20M24%20106l-1%2012%201%2010h17l18-1v-21c-2-2-33-1-35%200m1%2011v9l3-2%205-5%203-3-5-4-6-5v10m3-10l7%206%206%206%204-3%207-6%204-3H28m24%205l-5%205%205%204%205%205%201-9v-10l-6%205m-19%2010l-5%204%2014%201c15%200%2015%200%207-6-4-3-4-3-6-2-1%202-2%202-4%200-2-1-2-1-6%203m93%202l-1%201-5-1c-4%200-5%200-5%203v3l1-2%201-3%201%203c0%202%200%202%202%201h1c0%202%203%201%204-1h1c2%203%205%202%205-2%200-2%200-3%202-3v1l-1%203c0%204%203%204%204%200l1-2v2c0%203%202%204%202%202h1c2%202%204%201%204-1l1%201c2%201%202%201%202-1l1-3c1-1-1-1-3-1-4%200-5%201-6%202-1%202-1%202-1%200%201-3%200-5-1-3h-9c-1-1-1-1-2%201m94%2028l-2%201c-2%201-2%202-2%204l1%203h8l9-1h2c1%201%204%201%204-1h-1c-2%201-3%200-3-2l2-1c2%201%203-1%200-2l-3%201-1%201c-1-3-5-2-6%200%200%201-1%202-2%201l-1-1%202-1-2-1c-2%201-3%200-3-1l-1-1-1%201m145%2022l-10%203-1%2010-1%209h-2l-2-1v1l1%203%202%201c2%200%202%201%202%208l1%208%209%203c6%202%209%203%2012%202%202-1%203%200%205%201%2012%208%2025-7%2015-17l-3-3v-26l-9-2-9-3-10%203m-1%201c-7%202-8%203-8%205l1%202c1-1%2013%203%2013%204l-9-2-5-1v8l1%205c0-3%200-3%202-1%201%202%2011%208%2012%208l1-10v-11l4-1%209-2%206-2-7-2c-8-2-9-2-20%200'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><img src="/acorns/static/da873d98f82462fd16703e257e771596/ebf47/1628091098582.png" data-vdom-skip="true" data-vdom-cache="true" alt="Redsocks packet flow" title="Redsocks packet flow" name="images/1628091098582.png" data-src="./images/1628091098582.png" class="front_image" loading="lazy" srcSet="/acorns/static/da873d98f82462fd16703e257e771596/6f3f2/1628091098582.png 256w,
/acorns/static/da873d98f82462fd16703e257e771596/01e7c/1628091098582.png 512w,
/acorns/static/da873d98f82462fd16703e257e771596/ebf47/1628091098582.png 688w" sizes="(max-width: 688px) 100vw, 688px" data-action="zoom" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div><br><div class="story_image_caption ">Redsocks packet flow</div></div></div><p></p>
<p class="xsj_paragraph xsj_paragraph_level_0">Here is a brief explanation how does a packet get redirected to <strong class="markdown_strong_asterisk">Redsocks</strong>.</p>
<ol class="markdown_ol">
<li><span class="xsj_placeholder_span"></span>When a packet is sent from an app in the system it is handled by the kernel, it triggers the <strong class="markdown_strong_asterisk">NT_ hooks</strong> (defined in &lt;linux/netfilter.h&gt;).</li>
<li><span class="xsj_placeholder_span"></span>The <strong class="markdown_strong_asterisk">ip_tables kernel module</strong> registers at <strong class="markdown_strong_asterisk">netfilter’s hooks</strong> and proceed them according to defined rules.</li>
<li><span class="xsj_placeholder_span"></span>We are defining rules using <strong class="markdown_strong_asterisk">the iptables command line utility</strong> (these rules will be described later in this article). And they are defined in the way that some or mostly all packets are redirected to the local process listening on a port, <strong class="markdown_strong_asterisk">12345</strong> in case of <strong class="markdown_strong_asterisk">Redsocks</strong>.</li>
<li><span class="xsj_placeholder_span"></span>All redirected packets are handled by <strong class="markdown_strong_asterisk">Redsokcs</strong> conforming to the configuration file rules.</li>
<li><strong class="markdown_strong_asterisk">Redsocks</strong> redirects packets to proxy servers.</li>
</ol>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="step20120e2809420getting20redsocks20source20code_3"><div class="xiaoshujiang_element xsj_anchor">
  <a name="step20120e2809420getting20redsocks20source20code_3" class="blank_anchor_name"></a><a id="step20120e2809420getting20redsocks20source20code_3" class="blank_anchor_id"></a><a name="step-1-getting-redsocks-source-code" class="blank_anchor_name"></a><a id="step-1-getting-redsocks-source-code" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Step 1 — Getting Redsocks source code</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">First and foremost, you need to update repositories and installed software on the system.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>yum update<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">In order to install <strong class="markdown_strong_asterisk">Redsocks</strong> we need to compile it at first. Change into a directory you want to keep source code in.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>cd /opt/<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">By default the <strong class="markdown_strong_asterisk">git command line tool</strong> is not installed in most Centos distros. So install it at first.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>yum install git<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">And clone <strong class="markdown_strong_asterisk">Redsocks source code</strong> from the git repository.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>git clone https://github.com/darkk/redsocks<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Now change the directory to the <strong class="markdown_strong_asterisk">redsocks</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>cd redsocks/<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Try to compile the application, but it will probably fail. In my case I don’t have even <strong class="markdown_strong_asterisk">make</strong> installed.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>[root@centos7 redsocks]# make<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>-bash: make: command not found<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>[root@centos7 redsocks]#<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="step20220e2809420compiling20redsocks_4"><div class="xiaoshujiang_element xsj_anchor">
  <a name="step20220e2809420compiling20redsocks_4" class="blank_anchor_name"></a><a id="step20220e2809420compiling20redsocks_4" class="blank_anchor_id"></a><a name="step-2-compiling-redsocks" class="blank_anchor_name"></a><a id="step-2-compiling-redsocks" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Step 2 — Compiling Redsocks</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">Firstly you need to install <strong class="markdown_strong_asterisk">build-tools(Development Tools)</strong> if you haven’t already.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>yum group install "Development Tools"<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Next, we need to install dependencies to successfully compile <strong class="markdown_strong_asterisk">Redsocks</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>yum install libevent libevent-devel<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">After installation try to compile <strong class="markdown_strong_asterisk">Redsocks</strong> again using the <strong class="markdown_strong_asterisk">make</strong> command. If compilation succeed you should see the compiled binary file in the current directory.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>[root@centos7 redsocks]# ls -l redsocks<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>-rwxr-xr-x 1 root root 415968 Jul  7 08:49 redsocks<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Now you can copy the binary file to any folder defined in <strong class="markdown_strong_asterisk">the $PATH variable</strong>, to be able to execute it without specifying a full path to <strong class="markdown_strong_asterisk">Redsocks</strong>.</p>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="step20320e2809420setting20iptables20rules_5"><div class="xiaoshujiang_element xsj_anchor">
  <a name="step20320e2809420setting20iptables20rules_5" class="blank_anchor_name"></a><a id="step20320e2809420setting20iptables20rules_5" class="blank_anchor_id"></a><a name="step-3-setting-iptables-rules" class="blank_anchor_name"></a><a id="step-3-setting-iptables-rules" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Step 3 — Setting Iptables Rules</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">To redirect necessary packets to <strong class="markdown_strong_asterisk">Redsocks</strong> we need to define some <strong class="markdown_strong_asterisk">iptables rules</strong>. I will use the rules suggested on <a href="http://darkk.net.ru/redsocks/" class="xsj_link xsj_manu_link">the official Redsocks page</a>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span># Create new chain<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>iptables -t nat -N REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">The rule above creates a new custom chain in <strong class="markdown_strong_asterisk">the NAT table</strong>.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Next we need to exclude all local and reserved network addresses. As a result all packets with the destination address from the following ranges will not be sent to <strong class="markdown_strong_asterisk">Redsocks</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span># Exclude local and reserved addresses<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>iptables -t nat -A REDSOCKS -d 0.0.0.0/8 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>iptables -t nat -A REDSOCKS -d 10.0.0.0/8 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>iptables -t nat -A REDSOCKS -d 127.0.0.0/8 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>iptables -t nat -A REDSOCKS -d 169.254.0.0/16 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>iptables -t nat -A REDSOCKS -d 172.16.0.0/12 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>iptables -t nat -A REDSOCKS -d 192.168.0.0/16 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>iptables -t nat -A REDSOCKS -d 224.0.0.0/4 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>iptables -t nat -A REDSOCKS -d 240.0.0.0/4 -j RETURN<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Now we need to add a rule that will redirect all packets from our custom <strong class="markdown_strong_asterisk">REDSOCKS chain</strong> to the local port, we will use the default one – <strong class="markdown_strong_asterisk">12345</strong></p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports 12345<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Please note, this rule doesn’t redirect every packet sent in the system to <strong class="markdown_strong_asterisk">the port 12345</strong>, it only redirects packets that are <strong class="markdown_strong_asterisk">already passed</strong> inside <strong class="markdown_strong_asterisk">the REDSOCKS chain</strong>. You can check this, for example using the following command.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>wget google.com<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Consequently, we need to define a rule that will redirect chosen packets by some criteria to <strong class="markdown_strong_asterisk">the REDSOCKS chain</strong>. You are free to apply any rules you want, but I will show how to redirect all HTTP and HTTPS packets through a proxy. Define the following rules.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span># Redirect all HTTP and HTTPS outgoing packets through Redsocks<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>iptables -t nat -A OUTPUT -p tcp --dport 443 -j REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>iptables -t nat -A OUTPUT -p tcp --dport 80 -j REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Also you may need to define the following rules in the <strong class="markdown_strong_asterisk">PREROUTING chain</strong>. For redirecting incomming packets to <strong class="markdown_strong_asterisk">the REDSOCKS chain</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>iptables -t nat -A PREROUTING -p tcp --dport 1080 -j REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Do not be confused about these rules. They are applied only for incoming packets, that’s why the chain is called <strong class="markdown_strong_asterisk">PRE ROUTING</strong>. Here is the diagram that shows <strong class="markdown_strong_asterisk">the packet flow</strong> through <strong class="markdown_strong_asterisk">iptables tables and chains</strong>.</p>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:514px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 199.21875%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='797'%3e%3cpath%20d='M0%2026v26h71v17l-1%2016-1-3c-1-1-1-2-2-1l2%205%201%205%204%201%203-1-3-1c-1%200-1-1%201-5l2-4c-1-1-2%200-3%203l-2%204V52h71V0H0v26m250%200v26h36c36%200%2037%200%2034%204l-2%206%202-3c2-3%202-2%202%2027v30l-19%2010-18%2010a544%20544%200%200037%2020l-2%205-2%205s2-1%202-3c2-2%202-2%202%208v10h-17c-15%200-18%200-18%202l-1%2015%201%2014c0%202%203%202%2018%202l17%201-3%205-1%205%202-3c2-3%202-3%202%207v10h3l3-1-2-1c-3%200-3%200-3-9s0-9%202-8l1%204%201%201c1-1%200-3-1-5-3-6-4-6%2015-6h17v-33h-35v-11c0-10%200-10%202-7l2%203c1%200%201-1-1-5l-2-4c0-1%208-6%2019-11%2020-11%2022-11%2029-6%206%204%2013%2015%2015%2024a8206%208206%200%20016%2031l2%2024c1%208%202%2062%202%20231%200%20207-1%20220-2%20231-3%2015-8%2032-12%2038-9%2014-24%2013-42-3l-3-3%203%201%203-1-4-2c-2%200-3%200-2-1%203%200%202-2-1-2-4%200-4%201-2%207%201%205%204%207%202%202%200-2%200-2%206%203%2023%2018%2039%2014%2047-14l7-27a13323%2013323%200%2000-2-487l-2-9c-4-28-16-48-29-48-3%200-36-16-40-19l-1-30c0-26%200-29%201-28l2%203%201%201c1%200%200-3-2-5l-2-5h71V0H250v26M1%2026v24h141V1H1v25m251%200v24h140V1H252v25M32%2020l2%201%201%204%201%204%201-4c0-3%200-4%202-4l3%204c1%205%204%205%205%201l1-3v3l3%203%203-9c0-2-2-1-3%202l-1%203v-3c-1-4-3-4-5-1v3l-1-3c0-2-1-2-6-2l-6%201m250%200l1%201c1%200%202%201%202%204%201%205%203%205%203%200%200-6%203-6%205%200%201%205%203%205%204%201l2-3v3c1%204%204%204%205-1v-6l-2%202-1%202-1-2c0-3-3-2-4%201l-1%203v-3c-1-3-1-3-7-3l-6%201M28%2071C16%2076%208%2087%204%20106a28178%2028178%200%20001%20506c0%204%206%2027%209%2033%203%207%209%2013%2014%2015l22%2010%2018%2010v30c0%2024%200%2029-1%2027-2-4-3-1-1%203l2%204H37l-31%201-1%2025v26h372v-51l-27-1h-27v-15c0-13%200-14%202-13l1%203%201%201-1-4c-2-5-3-6-1-6l3-1-3-1c-3%200-4%200-3%201l-2%206-2%205%202-2c2-3%202-3%202%2011v15H71l2-4%201-4-3%203c-1%203-1%200-1-28v-31l19-10%2019-10-19-10c-20-11-19-10-16-16v-4l-2%203c-1%202-1-3-1-22%200-23%200-24%202-24l2-1-3-1h-3v25c0%2023%200%2024-2%2022%200-2-1-3-2-3l2%205%202%205-19%2011c-17%209-17%209-21%208-12-4-20-26-23-66V110c3-19%2013-34%2023-37%209-2%2019%201%2024%208%203%204%203%205%201%203l-3-1%202%203%205%204c2%202%207%203%207%201l-2-1c-1%200-2%200-2-5%200-6-2-8-2-3v3l-6-6c-8-8-16-11-24-8m29%2032c0%204%203%206%203%202h1c2%202%204%203%204%201h1c4%203%2010-1%207-5-2-3-8-2-8%202l-1%202v-3c0-2-1-3-4-3s-3%200-3%204m-22%2011l-1%2017v16h37v15l-2-3c-2-5-2-2%200%203l2%204H25v17l1%2017h45v8c0%208%200%208-2%205-2-5-3-3-1%202l2%204-18%201-17%201-1%2016v17h36v7c0%203%200%206-1%205%200-2-2-3-2-1l2%205%202%204H25v33h92v-33H95c-24%200-24%200-20-6%202-3%202-4%201-4%200%200-2%201-2%203-2%202-2%202-2-5v-8h37v-33l-18-1H73l2-4c2-4%202-5%201-5l-2%202c-1%202-1%201-1-5v-8h45v-34H73l2-4c2-5%202-8%200-3l-2%203v-15h36v-33l-37-1-37%201m270%2012l-16%2010%2017%209%2017%209%2018-9%2016-10-18-9-16-9-18%209m-158%2088v52h100V162H147v52m2%200v50h96V163h-96v51M27%20183v15h89v-30H27v15m126%200l-1%207v6h13v-13l-6-1-6%201m135%2015v14h69v-29h-69v15m-136%208v6h13v-13h-13v7m0%2016v6h13v-13h-13v7m0%2017v6h13v-13h-13v7m128%2011c0%204%202%206%203%203l2-2%202-1%201%201c2%203%207%203%208%201%203-4-3-8-7-5h-2l-4-1c-3%200-3%200-3%204m25-3l1%201%201%203c0%202%201%203%202%203l1-3c0-2%201-3%202-3l1%203c0%203%203%204%203%201h1c2%202%204%203%204%201h1c4%203%2010-1%207-5-2-3-8-2-8%202l-1%202v-3c0-2-1-3-8-3l-7%201m-153%208v6h13v-13h-13v7m130%2025v16h20l20%201-3%204-1%205h1l1-3c2-1%202-1%202%205v7h-20l-20%201v33h81v-33l-20-1h-19v-6c0-5%201-6%201-4l2%202c1%200%201-1-1-5-3-6-4-6%2018-6h19v-33h-81v17M70%20321c0%205%200%208-1%207l-1-2c-1%200-1%201%201%204%202%205%202%205-18%205H32v33h36v14c0%2014%200%2014-2%2011l-2-3%201%206%203%204-3%202a647%20647%200%2001-35%2019l8%205%2019%2010%2011%205v13c0%2011%200%2012-1%2011l-2-3-1-1%201%205c2%202%203%205%202%206l3%201c4%200%205-2%202-2-2%200-2-1%200-5%202-5%201-7-1-2-1%203-2%203-2-9l1-14a489%20489%200%200143-20c6%200%206%200%205%201l-3%202-1%201c1%201%203%200%206-2%206-3%206-3-2-6-5-2-5-1-1%201l4%202h-15l-19-10-18-10%203-4c3-5%202-7-1-3l-2%203v-14l1-13%2020-1h21v-32l-19-1-19-1%202-4%201-4-2%203c-2%204-2%202-2-6%200-9%200-9%203-9%202-1%202-1-1-1h-4v8m-36%2031v15h75v-30H34v15m264%203c-1%201%200%201%201%201%203%200%202%201-2%204l-3%204%203-1c3-3%203-2%201%203a285%20285%200%2001-31%2055c1%200%201%201%207-7%209-14%2017-29%2027-50l1-2v2c0%205%202%203%202-1%200-7-1-9-4-9l-2%201m24%200v1l-2%206c-2%202-3%204-2%205l1-1%201-3c2-1%202-1%202%209v10l-18%209-19%2010%2018%2011%2019%2010-3%205-1%205c1%200%202-1%202-3%202-3%202-3%202%204v8h3c2%200%203%200%202-1l-2-1c-1%200-2-1-2-6%200-6%200-6%201-5l2%203%201%201-1-5-3-5%2019-10%2018-11-19-10-18-9v-11c0-10%200-10%202-7l2%203c1%200%201-1-1-5-3-5-3-6%200-6l2-1h-6m-17%2037l-18%209%2018%2010%2018%209%2017-9%2016-10-17-9-16-9-18%209M50%20412l-17%209%208%204%2018%2010%2010%205%208-5a689%20689%200%200126-14l-34-18-19%209m83%2018v16h57v-16h5c5%200%205%200%203%201l-3%202-1%201c0%201%201%201%205-1l4-2%201%208v7h56v-33h-56v8c0%208%200%208-5%206-3-2-6-2-4%200%202%201%202%201-1%201h-4v-15h-57v17m73%200v14h26l26%201v-30h-52v15m91%2051l1%2017h11c13%200%2013%200%2010%206l-1%204%202-2c1-2%201-1%201%204v6h-44l-1%2016v17h22l23%201-2%205c-2%204-2%205-1%205l2-3c1-2%201-2%201%204v6h-12l-11%201-1%2016v17h12l12%201-2%204c-2%204-2%205-1%205l2-2c1-2%201%200%201%206v8h-45v33h23l22%201-2%204c-2%204-2%205-1%205l2-2c1-2%201-1%201%203v6h-24v33h51v-33h-25v-13l2%203%202%203c1%200%201-1-1-6l-3-4h46v-33h-45l-1-9c0-9%200-9%202-6l2%203c1%200%201-1-1-6l-3-4h25v-33l-13-1h-12v-7c0-6%200-6%202-4%200%202%202%203%202%203l-2-5-2-5h46v-33h-46v-7c0-7%200-7%201-4l3%203-1-5-3-5h24v-34h-50v17m2%200v15h46v-30h-46v15m-236%200c0%203%200%207%202%208l1-1c0-3%205-4%206-2%201%204%207%203%207-2l2-2%201%204c0%204%202%204%203-1%200-2%201-3%202-3v-1l-5-1c-5%200-6%201-6%203%200%204-2%204-2%200%200-3-2-4-3-1h-1c-1-2-6-3-7-1m-19%2015l-1%2016v16h25v9c0%208%200%2010-2%206l-2-3%202%205%202%205H38v17l1%2017h59v-34H70l2-4a633%20633%200%2000-1-4l-1-5v-8l12-1h12v-33H69l-25%201m-4%2071v15h56v-30H40v15m238%2072v15h89v-30h-89v15m-222%209a1372%201372%200%2001-21%2012l34%2018%2035-18-4-3-18-9-13-7-13%207m104%2043c0%201%201%203%203%203h1l2%201%201-2h1c2%201%206%201%208-1h1l1%202h3l2%201%201-1%201-1c1%201%202%200%202-1%200-2-4-4-6-2h-14c0-1-6-1-7%201M7%20770v24h368v-48H7v24'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><img src="/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/dea13/1628091098586.png" data-vdom-skip="true" data-vdom-cache="true" alt title name="images/1628091098586.png" data-src="./images/1628091098586.png" class="front_image" loading="lazy" srcSet="/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/6f3f2/1628091098586.png 256w,
/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/01e7c/1628091098586.png 512w,
/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/dea13/1628091098586.png 514w" sizes="(max-width: 514px) 100vw, 514px" data-action="zoom" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div><br><div class="story_image_caption story_image_blank_caption"></div></div></div><p></p>
<p class="xsj_paragraph xsj_paragraph_level_0">Furthermore, you are free to define any rules you need, just remember to jump <strong class="markdown_strong_asterisk">(-j REDSOCKS)</strong> to the <strong class="markdown_strong_asterisk">REDSOCKS chain</strong>. Here another example from the official documentation. It redirects only packets sent <strong class="markdown_strong_asterisk">from a specific user</strong>, this could be very useful in some cases. You can follow the <strong class="markdown_strong_asterisk">user per application strategy (similar used in Android)</strong>, as a result you will be able set <strong class="markdown_strong_asterisk">application specific rules</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>iptables -t nat -A OUTPUT -p tcp -m owner --uid-owner crosp -j REDSOCKS<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">One more important point, avoid using <strong class="markdown_strong_asterisk">the root user</strong> in <strong class="markdown_strong_asterisk">iptables rules</strong> or you may get stuck in <strong class="markdown_strong_asterisk">the infinite loop</strong>. Here is <a href="https://github.com/darkk/redsocks/issues/108" class="xsj_link xsj_manu_link">a problem</a> I’ve encountered because of my inattention.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Having set iptables rules the final step is to <strong class="markdown_strong_asterisk">configure Redsocks</strong> itself using the configuration file.</p>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="step20420e2809420configuring20redsocks_6"><div class="xiaoshujiang_element xsj_anchor">
  <a name="step20420e2809420configuring20redsocks_6" class="blank_anchor_name"></a><a id="step20420e2809420configuring20redsocks_6" class="blank_anchor_id"></a><a name="step-4-configuring-redsocks" class="blank_anchor_name"></a><a id="step-4-configuring-redsocks" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Step 4 — Configuring Redsocks</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">Create a file with the name <strong class="markdown_strong_asterisk">redsocks.conf</strong> in the same directory (or any other directory) where the binary file is located. And let’s start by defining the <strong class="markdown_strong_asterisk">base section</strong> of the configuration file as follows.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>base {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span> log_debug = on;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span> log_info = on;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span> log = "stderr";<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span> daemon = off;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span> redirector = iptables;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">I think each parameter is self-explanatory. You can find a complete description of every option in the example of <a href="https://github.com/darkk/redsocks/blob/master/redsocks.conf.example" class="xsj_link xsj_manu_link">configuration file</a> in the <a href="https://github.com/darkk/redsocks" class="xsj_link xsj_manu_link">official repository</a>.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Next we need to define <strong class="markdown_strong_asterisk">proxies</strong>. This is done using <strong class="markdown_strong_asterisk">redsocks sections</strong>. Here is an example of a possible proxy configuration.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>redsocks {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>    // Local IP listen to<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    local_ip = 127.0.0.1;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>    // Port to listen to<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>    local_port = 12345;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>    // Remote proxy address<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>    ip = super.socks.proxy.com;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>    port = 9966;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    // Proxy type<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>    type = socks5;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>    // Username to authorize on proxy server<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>    login = anonymous;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span>    // Password for a proxy user<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span>    password = verystrongpassword;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="15"><span class="li_linenum_before_span li_linenum_before_span_hide">15</span>    // Do not disclose real IP<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="16"><span class="li_linenum_before_span li_linenum_before_span_hide">16</span>    disclose_src = false;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="17"><span class="li_linenum_before_span li_linenum_before_span_hide">17</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">As you can see from the configuration above, this is the <strong class="markdown_strong_asterisk">SOCKS5 proxy configuration</strong>. Redsocks will listen to the <strong class="markdown_strong_asterisk">port 12345</strong>. We have provided credentials to authenticate ourselves on the proxy server as well.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">You create multiple <strong class="markdown_strong_asterisk">redsocks sections</strong>. But you have to specify <strong class="markdown_strong_asterisk">a different local port</strong> and as a result you need to set <strong class="markdown_strong_asterisk">appropriate iptables rules</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>redsocks {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>    // Local IP listen to<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    local_ip = 127.0.0.1;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>    // Port to listen to<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>    local_port = 83333;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>    // Remote proxy address<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>    ip = puper.socks.proxy.com;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>    port = 6699;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    // Proxy type<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>    type = socks5;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>    // Username to authorize on proxy server<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>    login = anonymous2;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span>    // Password for a proxy user<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span>    password = verystrongpassword;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="15"><span class="li_linenum_before_span li_linenum_before_span_hide">15</span>    // Do not disclose real IP<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="16"><span class="li_linenum_before_span li_linenum_before_span_hide">16</span>    disclose_src = false;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="17"><span class="li_linenum_before_span li_linenum_before_span_hide">17</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">As an example, you can use the tricky technique to simulate <strong class="markdown_strong_asterisk">load balancing</strong> with the help of <strong class="markdown_strong_asterisk">the random module</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>iptables -t nat -A REDSOCKS -p tcp -m random --mode random --probability 0.5 -j REDIRECT --to-ports 83333<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports 12345<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">There are lot of other ways to define iptables rules for using with <strong class="markdown_strong_asterisk">multiple proxies</strong>, for instance you can use <strong class="markdown_strong_asterisk">the mangle table</strong>, <strong class="markdown_strong_asterisk">create another chain</strong> (ex. REDSOCKS_HTTP) and so on.</p>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="step20520e2809420testing20proxies20with20redsocks_7"><div class="xiaoshujiang_element xsj_anchor">
  <a name="step20520e2809420testing20proxies20with20redsocks_7" class="blank_anchor_name"></a><a id="step20520e2809420testing20proxies20with20redsocks_7" class="blank_anchor_id"></a><a name="step-5-testing-proxies-with-redsocks" class="blank_anchor_name"></a><a id="step-5-testing-proxies-with-redsocks" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Step 5 — Testing proxies with Redsocks</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">Now it is time to test our configuration. Save the configuration file. Navigate to the folder with the <strong class="markdown_strong_asterisk">Redsocks compiled executable file</strong>. And execute the following command.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>./redsocks -c /etc/redsocks.conf<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">If your configuration file is valid and there are no other errors you should almost return immediately in case or running in <strong class="markdown_strong_asterisk">the daemon mode</strong> or see the similar output <strong class="markdown_strong_asterisk">with the daemon mode off</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>1499876514.801445 notice main.c:165 main(...) redsocks started, conn_max=128<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Furthermore, you can use <strong class="markdown_strong_asterisk">the netstat tool</strong> to get list of processes <strong class="markdown_strong_asterisk">bound to ports</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>[root@centos ~]# netstat -tulpn<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>Active Internet connections (only servers)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>tcp        0      0 127.0.0.1:27017         0.0.0.0:*               LISTEN      533/mongod<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      50/sshd<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>tcp        0      0 127.0.0.1:12345         0.0.0.0:*               LISTEN      465/./redsocks<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>tcp6       0      0 :::22                   :::*                    LISTEN      50/sshd<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>udp        0      0 0.0.0.0:14332           0.0.0.0:*                           229/dhclient<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>udp        0      0 0.0.0.0:68              0.0.0.0:*                           229/dhclient<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>udp6       0      0 :::28185                :::*                                229/dhclient<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Now try to make any request as <strong class="markdown_strong_asterisk">the specified user</strong> or to match a rule you defined on your own. For example, use the following curl request to get <strong class="markdown_strong_asterisk">your external IP address</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>curl 'https://api.ipify.org?format=json'<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">If <strong class="markdown_strong_asterisk">the redsocks process</strong> is attached to the terminal, you should see something like that in <strong class="markdown_strong_asterisk">stderr</strong>.</p>
<div class="xiaoshujiang_code_container"><div data-processed="true" class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>1499882494.465788 info redsocks.c:1243 redsocks_accept_client(...) [192.168.0.128:34470-&gt;50.19.238.1:443]: accepted<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>1499882495.249026 debug redsocks.c:341 redsocks_start_relay(...) [192.168.0.128:34470-&gt;50.19.238.1:443]: data relaying started<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>1499882496.359465 info redsocks.c:671 redsocks_drop_client(...) [192.168.0.128:34470-&gt;50.19.238.1:443]: connection closed<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">If you encountered any error check debug output in the first place.</p>
<h2 class="xsj_heading_hash xsj_heading xsj_heading_h2" id="conclusion_8"><div class="xiaoshujiang_element xsj_anchor">
  <a name="conclusion_8" class="blank_anchor_name"></a><a id="conclusion_8" class="blank_anchor_id"></a><a name="conclusion" class="blank_anchor_name"></a><a id="conclusion" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Conclusion</span></h2>
<p class="xsj_paragraph xsj_paragraph_level_0">In this tutorial I’ve described how to install <strong class="markdown_strong_asterisk">Redsocks</strong> on <strong class="markdown_strong_asterisk">Centos 7</strong>. Redsocks provides a very convenient way to configure a proxy environment, starting from a single proxy server to a dozens of proxies of different type. In addition if you are missing some features <a href="https://github.com/darkk/redsocks" class="xsj_link xsj_manu_link">in the original project</a>, you can check out a fork – <a href="https://github.com/semigodking/redsocks" class="xsj_link xsj_manu_link">Redsocks2</a>.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">I hope this tutorial was useful for you. If you have any troubles with setting up Redsocks, please feel free to leave comments below.</p>
</div>

</div></div></section><strong>Tagged with <span><style data-emotion-css="1it6e0j">.css-1it6e0j{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary,#33e);}.css-1it6e0j:hover{color:var(--theme-ui-colors-secondary,#119);}</style><a class="css-1it6e0j" href="/acorns/tags/技术">技术</a><span> | </span></span><span><a class="css-1it6e0j" href="/acorns/tags/代理">代理</a><span> | </span></span><span><a class="css-1it6e0j" href="/acorns/tags/网络">网络</a></span></strong><style data-emotion-css="k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-k008qs"><style data-emotion-css="1eziwv">.css-1eziwv{-webkit-flex:1;-ms-flex:1;flex:1;text-align:left;}</style><div class="css-1eziwv"><a class="css-1it6e0j" href="/acorns/bike_magic"><h4 class="css-1tr4euk"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" style="vertical-align:sub" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>Previous</h4><span>2021-8-4 魔术头巾的绑法</span></a></div><style data-emotion-css="1bge839">.css-1bge839{-webkit-flex:1;-ms-flex:1;flex:1;text-align:right;}</style><div class="css-1bge839"><a class="css-1it6e0j" href="/acorns/https:/docsgooglecom/document/d/1OGIrebKWq__Lt0ADxprxapevC1BEzPaR6ry9XY_WDdA"><h4 class="css-1tr4euk">Next<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" style="vertical-align:sub" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"></path></svg></h4><span>利用PPTP, redsocks, iptables, https/socks5 proxy实现全局代理上网</span></a></div></div></div></div></div><style data-emotion-css="lvzlb4">.css-lvzlb4{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:0;background-color:var(--theme-ui-colors-background,#fff);border-top:1px solid;width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:16px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width:650px){.css-lvzlb4{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><style data-emotion-css="1t4nmqc">.css-1t4nmqc{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:0;background-color:var(--theme-ui-colors-background,#fff);border-top:1px solid;width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:16px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width:650px){.css-1t4nmqc{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><div class="css-1t4nmqc"><style data-emotion-css="kfpyh1">.css-kfpyh1{font-size:20px;}@media screen and (min-width:650px){.css-kfpyh1{font-size:24px;}}</style><div class="css-kfpyh1"><span class="css-14uqj98">Time Flies, No Time for Nuts <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-11lk46i" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M422.625 18.28c-24.68.13-51.932 15.455-74.094 36.907 1.868 1.036 3.742 2.07 5.626 3.157 8.05 4.642 15.615 9.363 22.72 14.125 25.19-9.583 55.47-14.465 103.437-2.97-12.036-37.07-33.633-51.345-57.688-51.22zM237.78 40.22l28.97 94.25c12.57 6.443 24.827 13.41 36.813 20.843l-36.625-111.97c-8.476-1.68-16.657-2.662-24.563-3-1.54-.065-3.074-.108-4.594-.124zm-19.218 1.124c-1.602.206-3.202.427-4.78.687-8.815 1.454-17.338 3.755-25.595 6.876l15.688 58.625c13.62 4.75 26.922 10.064 39.906 15.907l-25.218-82.093zm69.875 7.593l40.157 122.876c15.922 11.124 31.32 23.128 46.25 35.906L325.906 64.374c-13.092-6.527-25.568-11.643-37.47-15.438zm-117.5 7.844c-14.657 7.857-28.523 18.348-41.875 31.095 18.42 3.334 36.298 7.632 53.657 12.813L170.937 56.78zm179.25 20.907l53.282 155.97c10.798 10.382 21.322 21.187 31.624 32.374.395-1.174.75-2.332 1.125-3.5L379.843 97.407c-8.84-6.63-18.706-13.185-29.656-19.72zM136.595 108.25c-17.05 11.436-32.43 27.876-45.344 50.22-42.303 73.19-61.83 198.325-24.53 265.717l-.064-.062c.752 23.392-7.597 45.63-17.812 67.594 27.268-12.192 54.897-17.815 82.687-20.783l-.468-.343c87.895 19.01 212.87-49.42 260.688-132.156 13.547-23.44 20.606-46.14 22.28-67.72-77.218-81.572-166.868-139.912-277.436-162.468zm271.469 14L444.188 228c2.638-20.573.96-39.855-5.688-58.25-5.856-16.202-15.717-32.01-30.438-47.5z"></path></svg></span></div><style data-emotion-css="7ipau9">.css-7ipau9{font-family:oswald,sans-serif;font-size:14px;text-align:center;}@media screen and (min-width:650px){.css-7ipau9{font-size:16px;text-align:right;}}</style><div class="css-7ipau9"><div>Copyright © 2020 <!-- -->suziwen</div><div>Build with  <style data-emotion-css="ksfbmy">.css-ksfbmy{color:var(--theme-ui-colors-primary,#33e);}.css-ksfbmy:hover{color:var(--theme-ui-colors-secondary,#119);}</style><a href="https://www.gatsbyjs.com/" target="_blank" rel="noopener noreferrer" class="css-ksfbmy">Gatsbyjs</a>  and  <a href="https://www.github.com/suziwen/gatsby-theme-sculpting" target="_blank" rel="noopener noreferrer" class="css-ksfbmy">Sculpting</a> theme</div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script src="/acorns/libs/zoom/zoom-vanilla.min.js"></script><script>
                  var _hmt = _hmt || [];
                  (function() {
                      var hm = document.createElement("script");
                      hm.src = "//hm.baidu.com/hm.js?c02140dc523f5a309a2717a9a2bac552";
                      var s = document.getElementsByTagName("script")[0]; 
                      s.parentNode.insertBefore(hm, s);
                  })();
              </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/https:/crospnet/blog/administration/install-configure-redsocks-proxy-centos-linux";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-48d6d113cdbd8eaeb1e6.js"],"app":["/app-769f74fe8327c9fb4428.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-404-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-404-js-c8b71f0b9c706e216a1d.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-search-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-search-js-e5540d250449237db552.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-archive-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-archive-js-3371becbe3b208851cf3.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-list-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-list-js-6af4602795e2f8374acc.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js-fb9d310599f1bd239803.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-tag-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-tag-js-26b309cc8838d6e433aa.js"]};/*]]>*/</script><script src="/acorns/polyfill-48d6d113cdbd8eaeb1e6.js" nomodule=""></script><script src="/acorns/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js-fb9d310599f1bd239803.js" async=""></script><script src="/acorns/d24d3e064b601c3fa92397aa9f8c5e3fc3365436-b3b52e1b95113f3f815e.js" async=""></script><script src="/acorns/05d954cf-b0068c1aacfd08ef52dc.js" async=""></script><script src="/acorns/41aca86e-8b5629aa189eae61d7b0.js" async=""></script><script src="/acorns/app-769f74fe8327c9fb4428.js" async=""></script><script src="/acorns/252f366e-a013f1a16a738605ba7c.js" async=""></script><script src="/acorns/545f34e4-5287ae6acbc1289e5dd0.js" async=""></script><script src="/acorns/framework-29ba174b433dc5858bed.js" async=""></script><script src="/acorns/webpack-runtime-b733388348fff5eacca1.js" async=""></script></body></html>