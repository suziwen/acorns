<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="Your Site&#x27;s RSS Feed" href="/acorns/rss.xml"/><link rel="stylesheet" type="text/css" href="/acorns/libs/zoom/zoom.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/story-writer-markdown-default.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/story-writer-markdown-components.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/fonts/Webfonts/oswald/stylesheet.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/xsjfonts/fontstyles/zh.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/font-awesome.min.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/svg-with-js.css?version=sculpting_1_1"/><link rel="stylesheet" type="text/css" href="/acorns/css/gitalk.css?version=sculpting_1_1"/><link rel="icon" type="image/png" href="/acorns/favicon/favicon.png"/><link rel="mask-icon" href="/acorns/favicon/icon.svg" color="brown"/><link rel="icon" type="image/svg+xml" href="/acorns/favicon/favicon.svg"/><link rel="stylesheet" type="text/css" href="/acorns/fonts/Webfonts/aladin/stylesheet.css"/><link as="script" rel="preload" href="/acorns/webpack-runtime-b733388348fff5eacca1.js"/><link as="script" rel="preload" href="/acorns/framework-29ba174b433dc5858bed.js"/><link as="script" rel="preload" href="/acorns/545f34e4-5287ae6acbc1289e5dd0.js"/><link as="script" rel="preload" href="/acorns/252f366e-a013f1a16a738605ba7c.js"/><link as="script" rel="preload" href="/acorns/app-769f74fe8327c9fb4428.js"/><link as="script" rel="preload" href="/acorns/41aca86e-8b5629aa189eae61d7b0.js"/><link as="script" rel="preload" href="/acorns/05d954cf-b0068c1aacfd08ef52dc.js"/><link as="script" rel="preload" href="/acorns/d24d3e064b601c3fa92397aa9f8c5e3fc3365436-b3b52e1b95113f3f815e.js"/><link as="script" rel="preload" href="/acorns/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js-fb9d310599f1bd239803.js"/><link as="fetch" rel="preload" href="/acorns/page-data/tech/how-to-write-your-own-virtual-dom/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/acorns/page-data/sq/d/2682448919.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/acorns/page-data/sq/d/2682448919.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/acorns/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="116ag8">body{--theme-ui-colors-text:var(--theme-ui-colors-text,#000);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#33e);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#119);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#f6f6f6);--theme-ui-colors-accent:var(--theme-ui-colors-accent,#609);--theme-ui-colors-gray:var(--theme-ui-colors-gray,#777);--theme-ui-colors-meta:var(--theme-ui-colors-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,#ffffcc);color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#fff);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#060606);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#3cf);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#e0f);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#191919);--theme-ui-colors-gray:var(--theme-ui-colors-modes-dark-gray,#999);--theme-ui-colors-accent:var(--theme-ui-colors-modes-dark-accent,#c0f);--theme-ui-colors-meta:var(--theme-ui-colors-modes-dark-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-modes-dark-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-modes-dark-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-modes-dark-highlight,#29112c);}body.theme-ui-deep{--theme-ui-colors-text:var(--theme-ui-colors-modes-deep-text,hsl(210,50%,96%));--theme-ui-colors-background:var(--theme-ui-colors-modes-deep-background,hsl(230,25%,18%));--theme-ui-colors-primary:var(--theme-ui-colors-modes-deep-primary,hsl(260,100%,80%));--theme-ui-colors-secondary:var(--theme-ui-colors-modes-deep-secondary,hsl(290,100%,80%));--theme-ui-colors-accent:var(--theme-ui-colors-modes-deep-accent,hsl(290,100%,80%));--theme-ui-colors-muted:var(--theme-ui-colors-modes-deep-muted,hsla(230,20%,0%,20%));--theme-ui-colors-gray:var(--theme-ui-colors-modes-deep-gray,hsl(210,50%,60%));--theme-ui-colors-meta:var(--theme-ui-colors-modes-deep-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-modes-deep-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-modes-deep-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-modes-deep-highlight,hsl(260,20%,40%));}body.theme-ui-swiss{--theme-ui-colors-text:var(--theme-ui-colors-modes-swiss-text,hsl(10,20%,20%));--theme-ui-colors-background:var(--theme-ui-colors-modes-swiss-background,hsl(10,10%,98%));--theme-ui-colors-primary:var(--theme-ui-colors-modes-swiss-primary,hsl(10,80%,50%));--theme-ui-colors-secondary:var(--theme-ui-colors-modes-swiss-secondary,hsl(10,60%,50%));--theme-ui-colors-accent:var(--theme-ui-colors-modes-swiss-accent,hsl(250,60%,30%));--theme-ui-colors-muted:var(--theme-ui-colors-modes-swiss-muted,hsl(10,20%,94%));--theme-ui-colors-gray:var(--theme-ui-colors-modes-swiss-gray,hsl(10,20%,50%));--theme-ui-colors-meta:var(--theme-ui-colors-modes-swiss-meta,#1f7199);--theme-ui-colors-built:var(--theme-ui-colors-modes-swiss-built,#397300);--theme-ui-colors-literal:var(--theme-ui-colors-modes-swiss-literal,#78A960);--theme-ui-colors-highlight:var(--theme-ui-colors-modes-swiss-highlight,hsl(10,40%,90%));}</style><style data-emotion-css="1s13q8j">*{box-sizing:border-box;}body{margin:0;font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;line-height:1.5;font-weight:400;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="14i9w9y">.css-14i9w9y{min-height:100VH;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="css-14i9w9y"><style data-emotion-css="7zod2p">html{overflow-y:scroll;}body{margin:0;color:#000;background-color:#fff;}</style><div class="headroom-wrapper"><div style="position:relative;top:0;left:0;right:0;z-index:2;-webkit-transform:translate3D(0, 0, 0);-ms-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)" class="headroom headroom--unfixed"><style data-emotion-css="st9nty">.css-st9nty{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--theme-ui-colors-background,#fff);border-bottom:1px solid;width:100%;}.css-st9nty h1{margin:0;}.css-st9nty ul{margin-left:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;list-style-type:none;}.css-st9nty li{margin-left:16px;}</style><style data-emotion-css="luk5ak">.css-luk5ak{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--theme-ui-colors-background,#fff);border-bottom:1px solid;width:100%;}.css-luk5ak h1{margin:0;}.css-luk5ak ul{margin-left:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;list-style-type:none;}.css-luk5ak li{margin-left:16px;}</style><div class="css-luk5ak"><style data-emotion-css="16qc66y">.css-16qc66y{font-family:inherit;font-size:24px;color:inherit;background-color:transparent;width:32px;height:32px;padding:4px;margin:0;margin-left:16px;border:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;}.css-16qc66y:focus{outline:2px solid;}@media screen and (min-width:40em){.css-16qc66y{display:none;}}</style><button title="Toggle Menu" class="css-16qc66y"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button><style data-emotion-css="umt6is">.css-umt6is{margin-left:16px;font-weight:bold;font-size:1.5em;}.css-umt6is a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}</style><div class="css-umt6is"><a href="https://suziwen.github.io/acorns"><style data-emotion-css="11lk46i">.css-11lk46i{font-size:1.5em;vertical-align:text-bottom;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-11lk46i" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M206.135 23.568c-61.993.106-133.212 38.319-173.762 85.328 0 0 94.532-8.388 109.732 35.477 24.55 70.846-103.768 62.832-105.619 173.623-1.394 83.471 89.36 169.758 176.1 169.812 4.214 1.405 181.953 0 181.953 0 19.783-.28 20.606-22.551-48.812-36.637 145.592-147.853-86.742-159.073-85.456-45.779-17.956-18.803.577-99.816 97.692-95.832 32.91 23.48 51.817 27.373 88.56 19.284 6.982-1.537 12.05-25.665-5.462-27.064l-31.78-2.54c-28.106-25.677-34.818-36.477-6.67-57.463 68.87 18.058 77.047 12.076 77.016-13.33-.03-24.855-9.527-90.633-65.832-93.815-7.701-10.311 9.79-42.042-3.953-42.957-19.014-1.266-50.482 28.417-46.266 43.787-18.335 7.755-38.728 31.156-59.15 59.614-69.316 25.43-119.49 142.639-120.15 170.632-.579-182.435 153.242-180.594 140.216-244.77-14.07-69.324-66.992-97.458-118.357-97.37zM432.807 169.97c7.164 0 12.972 5.808 12.972 12.973 0 7.164-5.808 12.972-12.972 12.972-7.165 0-12.973-5.808-12.973-12.972 0-7.165 5.808-12.973 12.973-12.973z"></path></svg><style data-emotion-css="14uqj98">.css-14uqj98{font-family:aladin,sans-serif;font-weight:normal;}</style><span class="css-14uqj98">Scrat&#x27;s Acorn</span></a></div><style data-emotion-css="qwlsg7">.css-qwlsg7{display:none;margin-left:auto;}@media screen and (min-width:650px){.css-qwlsg7{display:block;}}</style><div class="css-qwlsg7"><ul><li><style data-emotion-css="1dbh7qa">.css-1dbh7qa{display:block;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:14px;font-weight:bold;}.css-1dbh7qa.active{color:var(--theme-ui-colors-primary,#33e);}</style><style data-emotion-css="bpnmkh">.css-bpnmkh{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary,#33e);display:block;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:14px;font-weight:bold;}.css-bpnmkh:hover{color:var(--theme-ui-colors-secondary,#119);}.css-bpnmkh.active{color:var(--theme-ui-colors-primary,#33e);}</style><a class="css-bpnmkh" href="/acorns/">主页</a></li><li><a class="css-bpnmkh" href="/acorns/tags">标签</a></li><li><a class="css-bpnmkh" href="/acorns/archives">归档</a></li><li><a class="css-bpnmkh" href="/acorns/search">搜索</a></li><li><a href="https://github.com/suziwen/markdownxiaoshujiang" target="_blank" rel="noopener noreferrer" class="css-1dbh7qa">Github</a></li></ul></div><style data-emotion-css="oiscss">.css-oiscss{margin-left:auto;margin-right:16px;}@media screen and (min-width:650px){.css-oiscss{margin-left:8px;}}</style><style data-emotion-css="ofhzqr">.css-ofhzqr{-webkit-appearance:none;-moz-appearance:none;appearance:none;font-family:inherit;font-size:14px;font-weight:bold;margin:0;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-muted,#f6f6f6);border:0;border-radius:2px;margin-left:auto;margin-right:16px;}.css-ofhzqr:focus{outline:2px solid;}@media screen and (min-width:650px){.css-ofhzqr{margin-left:8px;}}</style><button class="css-ofhzqr">default</button></div></div></div><style data-emotion-css="13pmxen">.css-13pmxen{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;}</style><div class="css-13pmxen"><style data-emotion-css="mzzgn5">.css-mzzgn5{width:initial;-webkit-flex:none;-ms-flex:none;flex:none;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:32px;margin-top:64px;}@media screen and (min-width:650px){.css-mzzgn5{display:none;width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-top:0;}}</style><div><style data-emotion-css="rrk7cz">.css-rrk7cz{position:fixed;top:0;left:0;bottom:0;z-index:1;min-width:0;width:256px;max-height:100vh;overflow-x:visible;overflow-y:auto;-webkit-overflow-scrolling:touch;-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translate(-100%);-ms-transform:translate(-100%);transform:translate(-100%);background-color:var(--theme-ui-colors-background,#fff);width:initial;-webkit-flex:none;-ms-flex:none;flex:none;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:32px;margin-top:64px;}@media screen and (min-width:650px){.css-rrk7cz{position:-webkit-sticky;position:sticky;bottom:auto;max-height:none;-webkit-transform:none;-ms-transform:none;transform:none;background-color:transparent;}}@media screen and (min-width:650px){.css-rrk7cz{display:none;width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-top:0;}}</style><div class="css-rrk7cz"><style data-emotion-css="1rvtlej">.css-1rvtlej{list-style:none;padding:0;margin:0;}</style><ul class="css-1rvtlej"><li><style data-emotion-css="70qvj9">.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/">主页</a></div></li><li><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/tags">标签</a></div></li><li><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/archives">归档</a></div></li><li><div class="css-70qvj9"><a class="css-bpnmkh" href="/acorns/search">搜索</a></div></li><li><div class="css-70qvj9"><a class="css-1dbh7qa" href="https://github.com/suziwen/markdownxiaoshujiang" target="_blank" rel="noopener noreferrer">Github</a></div></li></ul></div></div><style data-emotion-css="2mmr94">.css-2mmr94{position:fixed;max-width:210px;z-index:1;display:none;opacity:0.3;-webkit-transition:opacity .5s;transition:opacity .5s;top:0;bottom:0;left:initial;right:0;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media screen and (min-width:650px){.css-2mmr94{display:none;left:0;right:initial;}}@media screen and (min-width:850px){.css-2mmr94{display:none;}}@media screen and (min-width:1200px){.css-2mmr94{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-2mmr94:hover{opacity:1;}.css-2mmr94 .toc-list{background-color:var(--theme-ui-colors-background,#fff);list-style-type:none;margin:0;padding:0;padding-left:16px;padding-top:16px;}.css-2mmr94 .toc-list .toc-list-item{line-height:1.2em;padding-bottom:16px;}.css-2mmr94 .toc-list .toc-list-item:last-child{padding-bottom:0;}.css-2mmr94 .toc-list .toc-link{color:var(--theme-ui-colors-gray,#777);-webkit-text-decoration:none;text-decoration:none;}.css-2mmr94 .toc-list .is-active-link{color:var(--theme-ui-colors-text,#000);font-weight:bold;}</style><div class="toc css-2mmr94"></div><style data-emotion-css="judnid">.css-judnid{-webkit-flex:1;-ms-flex:1;flex:1;z-index:0;overflow:hidden;}</style><div class="css-judnid"><style data-emotion-css="16jkoar">.css-16jkoar{padding:16px;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;min-height:100%;max-width:900px;}@media screen and (min-width:650px){.css-16jkoar{padding:64px;}}</style><div class="css-16jkoar"><section><style data-emotion-css="bzcaho">.css-bzcaho{position:fixed;top:0;left:0;right:0;width:100%;height:3px;background:var(--theme-ui-colors-highlight,#ffffcc);z-index:999;-webkit-transform-origin:0;-ms-transform-origin:0;transform-origin:0;}@media screen and (min-width:1200px){.css-bzcaho{display:none;}}</style><div style="transform:scaleX(0) translateZ(0)" class="css-bzcaho"></div><style data-emotion-css="1yzwfkz">.css-1yzwfkz{cursor:pointer;-webkit-transition:0.35s opacity;transition:0.35s opacity;position:fixed;bottom:1rem;right:1.5rem;height:48px;width:48px;overflow:hidden;z-index:999;display:none;opacity:0;pointer-events:none;}@media screen and (min-width:1200px){.css-1yzwfkz{display:block;}}.css-1yzwfkz:hover #arrow{opacity:1;}</style><div class="css-1yzwfkz"><style data-emotion-css="tfdnh9">.css-tfdnh9 #arrow{-webkit-transition:0.35s all;transition:0.35s all;fill:var(--theme-ui-colors-gray,#777);-webkit-transform:scale(0.22) translate(48px,48px);-ms-transform:scale(0.22) translate(48px,48px);transform:scale(0.22) translate(48px,48px);}.css-tfdnh9 #progress{stroke:var(--theme-ui-colors-text,#000);}.css-tfdnh9 #outline{stroke:var(--theme-ui-colors-gray,#777);}</style><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 35 35" xml:space="preserve" class="css-tfdnh9"><path id="outline" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"></path><path id="arrow" d="M3.352,48.296l28.56-28.328l28.58,28.347c0.397,0.394,0.917,0.59,1.436,0.59c0.52,0,1.04-0.196,1.436-0.59   c0.793-0.787,0.793-2.062,0-2.849l-29.98-29.735c-0.2-0.2-0.494-0.375-0.757-0.475c-0.75-0.282-1.597-0.107-2.166,0.456   L0.479,45.447c-0.793,0.787-0.793,2.062,0,2.849C1.273,49.082,2.558,49.082,3.352,48.296z"></path><path fill="none" id="progress" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"></path></svg></div><style data-emotion-css="1tr4euk">.css-1tr4euk{font-family:oswald,sans-serif;}</style><p class="css-1tr4euk">May 03, 2020</p></section><style data-emotion-css="1ud4cyp">.css-1ud4cyp{box-sizing:border-box;margin:0;min-width:0;font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;font-weight:700;line-height:1.25;}</style><h1 class="css-1ud4cyp">2020-5-2 How to write your own Virtual DOM</h1><section class="post-body"><style data-emotion-css="1jye6mf">.css-1jye6mf{font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;line-height:1.5;font-weight:400;}.css-1jye6mf root{font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;line-height:1.5;font-weight:400;}.css-1jye6mf h1{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:32px;}.css-1jye6mf h2{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:24px;}.css-1jye6mf h3{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:20px;}.css-1jye6mf h4{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:16px;}.css-1jye6mf h5{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:14px;}.css-1jye6mf h6{color:var(--theme-ui-colors-text,#000);font-family:'Noto Sans SC','Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','Microsoft YaHei','微软雅黑','WenQuanYi Micro Hei',Heiti,'黑体',sans-serif;line-height:1.25;font-weight:700;font-size:12px;}.css-1jye6mf p{color:var(--theme-ui-colors-text,#000);font-family:'Noto Serif SC',system-ui,'Helvetica Neue',Helvetica,Tahoma,Arial,'Hiragino Sans GB','NSimSun','仿宋体','SimSun','宋体',serif;font-weight:400;line-height:1.5;}.css-1jye6mf a{color:var(--theme-ui-colors-primary,#33e);}.css-1jye6mf a:hover{color:var(--theme-ui-colors-secondary,#119);}.css-1jye6mf pre{font-family:'Roboto Mono',monospace;overflow-x:auto;}.css-1jye6mf pre code{color:inherit;}.css-1jye6mf code{font-family:'Roboto Mono',monospace;color:var(--theme-ui-colors-secondary,#119);font-size:14px;}.css-1jye6mf table{width:100%;margin-top:32px;margin-bottom:32px;border-collapse:separate;border-spacing:0;}.css-1jye6mf table th,.css-1jye6mf table td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted,#f6f6f6);border-bottom-style:solid;}.css-1jye6mf th{vertical-align:bottom;border-bottom-width:2px;}.css-1jye6mf td{vertical-align:top;border-bottom-width:1px;}.css-1jye6mf img{max-width:100%;}.css-1jye6mf Container{padding:16px;max-width:1024px;}.css-1jye6mf inlineCode{font-family:'Roboto Mono',monospace;color:var(--theme-ui-colors-secondary,#119);background-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf hr{border:0;border-bottom:1px solid;border-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf blockquote{padding:16px;margin-top:16px;margin-bottom:16px;margin-left:8px;margin-right:16px;border-left-width:5px;border-left-style:solid;border-left-color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf .xiaoshujiang_pre{white-space:pre-wrap;font-family:'Roboto Mono',monospace;tab-size:4;}.css-1jye6mf .xiaoshujiang_pre .ol_linenums{margin-top:0;}.css-1jye6mf .hljs{padding:8px;color:var(--theme-ui-colors-text,#000);background-color:var(--theme-ui-colors-muted,#f6f6f6);}.css-1jye6mf .hljs .hljs-subst{color:var(--theme-ui-colors-text,#000);}.css-1jye6mf .hljs .hljs-comment{color:var(--theme-ui-colors-gray,#777);}.css-1jye6mf .hljs .hljs-keyword,.css-1jye6mf .hljs .hljs-attribute,.css-1jye6mf .hljs .hljs-selector-tag,.css-1jye6mf .hljs .hljs-meta-keyword,.css-1jye6mf .hljs .hljs-doctag,.css-1jye6mf .hljs .hljs-name{font-weight:bold;}.css-1jye6mf .hljs .hljs-type,.css-1jye6mf .hljs .hljs-string,.css-1jye6mf .hljs .hljs-number,.css-1jye6mf .hljs .hljs-selector-id,.css-1jye6mf .hljs .hljs-selector-class,.css-1jye6mf .hljs .hljs-quote,.css-1jye6mf .hljs .hljs-template-tag,.css-1jye6mf .hljs .hljs-deletion{color:var(--theme-ui-colors-primary,#33e);}.css-1jye6mf .hljs .hljs-title,.css-1jye6mf .hljs .hljs-section{color:var(--theme-ui-colors-primary,#33e);font-weight:bold;}.css-1jye6mf .hljs .hljs-regexp,.css-1jye6mf .hljs .hljs-symbol,.css-1jye6mf .hljs .hljs-variable,.css-1jye6mf .hljs .hljs-template-variable,.css-1jye6mf .hljs .hljs-link,.css-1jye6mf .hljs .hljs-selector-attr,.css-1jye6mf .hljs .hljs-selector-pseudo{color:var(--theme-ui-colors-secondary,#119);}.css-1jye6mf .hljs .hljs-literal{color:var(--theme-ui-colors-literal,#78A960);}.css-1jye6mf .hljs .hljs-built_in,.css-1jye6mf .hljs .hljs-bullet,.css-1jye6mf .hljs .hljs-code,.css-1jye6mf .hljs .hljs-addition{color:var(--theme-ui-colors-built,#397300);}.css-1jye6mf .hljs .hljs-meta{color:var(--theme-ui-colors-meta,#1f7199);}.css-1jye6mf .hljs .hljs-meta-string{color:var(--theme-ui-colors-accent,#609);}.css-1jye6mf .hljs .hljs-emphasis{font-style:italic;}.css-1jye6mf .hljs .hljs-strong{font-weight:bold;}</style><div class="css-1jye6mf"><div><style></style>


	<div class="preview html_preview xsj_export_zip"><div style="overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><svg/></div><p class="xsj_paragraph xsj_paragraph_level_0">There are two things you need to know to build your own Virtual DOM. You do not even need to dive into React’s source. Or into source code of any other Virtual DOM implementations. They are so large and complex — but in reality the main part of Virtual DOM can be written in less than ~50 lines of code. 50. Lines. Of. Code. !!!</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Here are these two concepts:</p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>Virtual DOM is any kind of representation of a real DOM</li>
<li><span class="xsj_placeholder_span"></span>When we change something in our Virtual DOM Tree, we get a new Virtual Tree. Algorithm compares these two trees (old and new), finds differences and makes only necessary small changes to real DOM so it reflects virtual</li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0">That’s all! Let’s dive deeper into each of these concepts.</p>
<blockquote class="markdown_blockquote">
<p class="xsj_paragraph xsj_paragraph_level_1"><span class="xsj_placeholder_span"></span>UPDATE: The second article about setting props &amp; events in Virtual DOM is <a href="https://medium.com/@deathmood/write-your-virtual-dom-2-props-events-a957608f5c76" class="xsj_link xsj_manu_link">here</a></p>
</blockquote>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="representing20our20dom20tree_1"><div class="xiaoshujiang_element xsj_anchor">
  <a name="representing20our20dom20tree_1" class="blank_anchor_name"></a><a id="representing20our20dom20tree_1" class="blank_anchor_id"></a><a name="representing-our-dom-tree" class="blank_anchor_name"></a><a id="representing-our-dom-tree" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Representing our DOM Tree</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Well, first we need to store somehow our DOM tree in memory. And we can do that with plain old JS objects. Suppose we have this tree:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-html hljs xml code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">”list”</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Looks pretty simple, yeah? How could we represent that with just JS objects?</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-json hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>{ type: ‘ul’, props: { ‘class’: ‘list’ }, children: [<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  { type: ‘li’, props: {}, children: [‘item <span class="hljs-number">1</span>’] },<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  { type: ‘li’, props: {}, children: [‘item <span class="hljs-number">2</span>’] }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>] }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Here you can notice two things:</p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>We represent DOM elements with objects like</li>
</ul>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>{ type: ‘…’, props: { … }, children: [ … ] }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>We represent DOM text nodes with plain JS strings</li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0">But writing big trees in such way is quite difficult. So let’s write a helper function, so it will be easier for us to understand structure:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">type, props, …children</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">return</span> { type, props, children };<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Now we can write our DOM tree like this:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>h(‘ul’, { ‘<span class="hljs-class"><span class="hljs-keyword">class</span>’: ‘<span class="hljs-title">list</span>’ },</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span><span class="hljs-class">  <span class="hljs-title">h</span>(‘<span class="hljs-title">li</span>’, </span>{}, ‘item <span class="hljs-number">1</span>’),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  h(‘li’, {}, ‘item <span class="hljs-number">2</span>’),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">It looks a lot cleaner, yeah? But we can go even further. You’ve heard about JSX, haven’t you? Yes, I want it here too. So how does it work?</p>
<p class="xsj_paragraph xsj_paragraph_level_0">If you read official Babel JSX documentation <a href="https://babeljs.io/docs/plugins/transform-react-jsx/" class="xsj_link xsj_manu_link">here</a> , you’ll know, that Babel transpiles this code:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-html hljs xml code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">”list”</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Into smth like this:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>React.createElement(‘ul’, { <span class="hljs-attr">className</span>: ‘list’ },<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  React.createElement(‘li’, {}, ‘item <span class="hljs-number">1</span>’),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  React.createElement(‘li’, {}, ‘item <span class="hljs-number">2</span>’),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Notice any similarities? Yes, yes.. If we could just replace those <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">React.createElement(…)’</em></strong> s with our <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">h(…)’</em></strong> s calls… It turns out we can — by using smth called <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">jsx pragma</em></strong>. We just need to include comment-like line at the top of our source file:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-jsx hljs javascript code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-comment">/** @jsx h */</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>&lt;ul className=”list”&gt;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>  &lt;li&gt;item <span class="hljs-number">2</span>&lt;<span class="hljs-regexp">/li&gt;</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span><span class="hljs-number">&lt;/u</span>l&gt;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Well, it actually tells Babel ‘hey, transpile that jsx but instead of <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">React.createElement</em></strong> , put <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">h</em></strong>’. You can put anything instead of <code>h</code> there. And that will be transpiled.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">So, to sum up what I’ve said before, we will write our DOM in such way:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-jsx hljs javascript code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-comment">/** @jsx h */</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span><span class="hljs-keyword">const</span> a = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">”list”</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">And that will be transpiled by Babel to this code:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-keyword">const</span> a = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  h(‘ul’, { <span class="hljs-attr">className</span>: ‘list’ },<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    h(‘li’, {}, ‘item <span class="hljs-number">1</span>’),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>    h(‘li’, {}, ‘item <span class="hljs-number">2</span>’),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>  );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">When function <code>h</code> executes, it will return plain JS objects — our Virtual DOM representation:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-keyword">const</span> a = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  { <span class="hljs-attr">type</span>: ‘ul’, <span class="hljs-attr">props</span>: { <span class="hljs-attr">className</span>: ‘list’ }, <span class="hljs-attr">children</span>: [<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    { <span class="hljs-attr">type</span>: ‘li’, <span class="hljs-attr">props</span>: {}, <span class="hljs-attr">children</span>: [‘item <span class="hljs-number">1</span>’] },<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>    { <span class="hljs-attr">type</span>: ‘li’, <span class="hljs-attr">props</span>: {}, <span class="hljs-attr">children</span>: [‘item <span class="hljs-number">2</span>’] }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>  ] }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Go ahead and try that in JSFiddle (don’t forget to set Babel as your language):</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-jsx hljs javascript code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-comment">/** @jsx h */</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">type, props, ...children</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>  <span class="hljs-keyword">return</span> { type, props, children };<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span><span class="hljs-keyword">const</span> a = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list"</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span><span class="hljs-built_in">console</span>.log(a);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="applying20our20dom20representation_2"><div class="xiaoshujiang_element xsj_anchor">
  <a name="applying20our20dom20representation_2" class="blank_anchor_name"></a><a id="applying20our20dom20representation_2" class="blank_anchor_id"></a><a name="applying-our-dom-representation" class="blank_anchor_name"></a><a id="applying-our-dom-representation" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Applying our DOM Representation</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Ok, now we have our DOM tree represented as plain JS objects, with our own structure. That’s cool, but we need to somehow create a real DOM from it. ’Cause we can’t just append our representation into DOM.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">First let’s make some assumptions and set up terminology:</p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>I will write all variables with real DOM nodes (elements, text nodes) starting with <code>$</code> — so <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">$parent</em></strong> will be real DOM element</li>
<li><span class="xsj_placeholder_span"></span>Virtual DOM representation will be in variable named <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">node</em></strong></li>
<li><span class="xsj_placeholder_span"></span>Like in React, you can have only <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">one root node</em></strong> — all other nodes will be inside</li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0">Ok, having that said, let us write a function <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">createElement(…)</em></strong> that will take a virtual DOM node and return a real DOM node. Forget about <code>props</code> and <code>children</code> for now — we’ll set up that later:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span>(<span class="hljs-params">node</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node === ‘string’) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createTextNode(node);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(node.type);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">So, because we can have both <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">text nodes</em></strong> — that are plain JS strings and <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">elements</em></strong> — that are JS objects of type like:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="nohighlight hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span>{ type: ‘…’, props: { … }, children: [ … ] }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Thus, we can pass here both virtual text nodes and virtual element nodes — and that will work.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Now let’s think about children — each of them is also either a text node or an element. So they can also be created with our <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">createElement(…)</em></strong> function. Yeah, do you feel that? It feels recursively :)) So we can call <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">createElement(…)</em></strong><br>
for each of element’s children and then <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">appendChild()</em></strong> them into our element like this:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span>(<span class="hljs-params">node</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node === ‘string’) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createTextNode(node);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>  <span class="hljs-keyword">const</span> $el = <span class="hljs-built_in">document</span>.createElement(node.type);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>  node.children<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>    .map(createElement)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>    .forEach($el.appendChild.bind($el));<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>  <span class="hljs-keyword">return</span> $el;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Wow, that looks nice. Let’s put aside node <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">props</em></strong> for now. We’ll talk about them later. We do not need them for understanding basic concepts of Virtual DOM but they’ll add more complexity.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Now go ahead and try that in JSFiddle:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-jsx hljs javascript code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-comment">/** @jsx h */</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">type, props, ...children</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>  <span class="hljs-keyword">return</span> { type, props, children };<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span>(<span class="hljs-params">node</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node === <span class="hljs-string">'string'</span>) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createTextNode(node);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>  <span class="hljs-keyword">const</span> $el = <span class="hljs-built_in">document</span>.createElement(node.type);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>  node.children<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span>    .map(createElement)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span>    .forEach($el.appendChild.bind($el));<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="15"><span class="li_linenum_before_span li_linenum_before_span_hide">15</span>  <span class="hljs-keyword">return</span> $el;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="16"><span class="li_linenum_before_span li_linenum_before_span_hide">16</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="17"><span class="li_linenum_before_span li_linenum_before_span_hide">17</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="18"><span class="li_linenum_before_span li_linenum_before_span_hide">18</span><span class="hljs-keyword">const</span> a = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="19"><span class="li_linenum_before_span li_linenum_before_span_hide">19</span>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list"</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="20"><span class="li_linenum_before_span li_linenum_before_span_hide">20</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="21"><span class="li_linenum_before_span li_linenum_before_span_hide">21</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="22"><span class="li_linenum_before_span li_linenum_before_span_hide">22</span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="23"><span class="li_linenum_before_span li_linenum_before_span_hide">23</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="24"><span class="li_linenum_before_span li_linenum_before_span_hide">24</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="25"><span class="li_linenum_before_span li_linenum_before_span_hide">25</span><span class="hljs-keyword">const</span> $root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="26"><span class="li_linenum_before_span li_linenum_before_span_hide">26</span>$root.appendChild(createElement(a));<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="handling20changes_3"><div class="xiaoshujiang_element xsj_anchor">
  <a name="handling20changes_3" class="blank_anchor_name"></a><a id="handling20changes_3" class="blank_anchor_id"></a><a name="handling-changes" class="blank_anchor_name"></a><a id="handling-changes" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Handling changes</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Ok, now that we can turn our virtual DOM into a real DOM, it’s time to think about diffing our virtual trees. So basically we need to write an algo, that will compare two virtual trees — old and new — and make only necessary changes into real DOM.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">How to diff trees? Well, we need to handle next cases:</p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>There is no old node at some place — so node was added and we need to <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">appendChild(…)</em></strong> that</li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:426px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 18.359375%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='73'%3e%3cpath%20d='M0%2037v36h401V0H0v37'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><img src="/acorns/static/175fa040728ff2978999e4ef0ce97625/531e1/1588388855987.png" alt title name="images/1588388855987.png" data-src="./images/1588388855987.png" class="front_image" loading="lazy" srcSet="/acorns/static/175fa040728ff2978999e4ef0ce97625/6f3f2/1588388855987.png 256w,
/acorns/static/175fa040728ff2978999e4ef0ce97625/531e1/1588388855987.png 426w" sizes="(max-width: 426px) 100vw, 426px" data-action="zoom" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div><br><div class="story_image_caption story_image_blank_caption"></div></div></div><p></p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>There is no new node at some place — thus node was deleted and we need to <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">removeChild(…)</em></strong></li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:407px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 22.265625%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='89'%3e%3cpath%20d='M0%2045v44h401V0H0v45'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><img src="/acorns/static/aae2c6014f804a776cafad5148b15cc4/0ff56/1588388855988.png" alt title name="images/1588388855988.png" data-src="./images/1588388855988.png" class="front_image" loading="lazy" srcSet="/acorns/static/aae2c6014f804a776cafad5148b15cc4/6f3f2/1588388855988.png 256w,
/acorns/static/aae2c6014f804a776cafad5148b15cc4/0ff56/1588388855988.png 407w" sizes="(max-width: 407px) 100vw, 407px" data-action="zoom" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div><br><div class="story_image_caption story_image_blank_caption"></div></div></div><p></p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>There is a different node at that place — thus node changed and we need to <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">replaceChild(…)</em></strong></li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:534px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 18.359375%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='73'%3e%3cpath%20d='M0%2037v36h401V0H0v37'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><img src="/acorns/static/f36079b3260ccb6da1527e47062e948b/a07a7/1588388855989.png" alt title name="images/1588388855989.png" data-src="./images/1588388855989.png" class="front_image" loading="lazy" srcSet="/acorns/static/f36079b3260ccb6da1527e47062e948b/6f3f2/1588388855989.png 256w,
/acorns/static/f36079b3260ccb6da1527e47062e948b/01e7c/1588388855989.png 512w,
/acorns/static/f36079b3260ccb6da1527e47062e948b/a07a7/1588388855989.png 534w" sizes="(max-width: 534px) 100vw, 534px" data-action="zoom" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div><br><div class="story_image_caption story_image_blank_caption"></div></div></div><p></p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>Nodes are the same — so we need to go deeper and diff child nodes</li>
</ul>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:507px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 29.296875%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='118'%3e%3cpath%20d='M0%2059v59h401V0H0v59m0%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><img src="/acorns/static/4083f9effaf22e51701c6d4704c64a0f/3ebb1/1588388855994.png" alt title name="images/1588388855994.png" data-src="./images/1588388855994.png" class="front_image" loading="lazy" srcSet="/acorns/static/4083f9effaf22e51701c6d4704c64a0f/6f3f2/1588388855994.png 256w,
/acorns/static/4083f9effaf22e51701c6d4704c64a0f/3ebb1/1588388855994.png 507w" sizes="(max-width: 507px) 100vw, 507px" data-action="zoom" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div><br><div class="story_image_caption story_image_blank_caption"></div></div></div><p></p>
<p class="xsj_paragraph xsj_paragraph_level_0">Ok, let us write a function called <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">updateElement(…)</em></strong> that takes three parameters — <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">$parent</em></strong>, <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">newNode</em></strong> and **<em class="markdown_em_underline">oldNode,</em> **where <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">$parent</em></strong> is a real DOM element-parent of our virtual node. Now we’ll see how to handle all cases that described above.</p>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="there20is20no20old20node_4"><div class="xiaoshujiang_element xsj_anchor">
  <a name="there20is20no20old20node_4" class="blank_anchor_name"></a><a id="there20is20no20old20node_4" class="blank_anchor_id"></a><a name="there-is-no-old-node" class="blank_anchor_name"></a><a id="there-is-no-old-node" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">There is no old node</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Well, it is pretty straightforward here, I won’t even comment:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElement</span>(<span class="hljs-params">$parent, newNode, oldNode</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">if</span> (!oldNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    $parent.appendChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>      createElement(newNode)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="there20is20no20new20node_5"><div class="xiaoshujiang_element xsj_anchor">
  <a name="there20is20no20new20node_5" class="blank_anchor_name"></a><a id="there20is20no20new20node_5" class="blank_anchor_id"></a><a name="there-is-no-new-node" class="blank_anchor_name"></a><a id="there-is-no-new-node" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">There is no new node</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Here we’ve got a problem — if there is no node at current place in new virtual tree — we should remove it from a real DOM — but how should we do that? Yeah, we know parent element (it is passed to function) and thus we are supposed to call <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">$parent.removeChild(…)</em></strong> and pass real DOM element reference there. But we do not have that. Well, if we knew position of our node in parent, we could get its reference with <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">$parent.childNodes[index],</em></strong> where <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">index</em></strong> is position of our node in parent element.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">Ok let’s suppose that this <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">index</em></strong> will be passed to our function (and it really will be passed — you’ll see it later). So our code will be:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElement</span>(<span class="hljs-params">$parent, newNode, oldNode, index = <span class="hljs-number">0</span></span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">if</span> (!oldNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    $parent.appendChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>      createElement(newNode)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!newNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>    $parent.removeChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="node20changed_6"><div class="xiaoshujiang_element xsj_anchor">
  <a name="node20changed_6" class="blank_anchor_name"></a><a id="node20changed_6" class="blank_anchor_id"></a><a name="node-changed" class="blank_anchor_name"></a><a id="node-changed" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Node changed</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">First we need to write a function that will compare two nodes (old and new) and tell us if node really changed. We should consider that it can be both elements and text nodes:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changed</span>(<span class="hljs-params">node1, node2</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> node1 !== <span class="hljs-keyword">typeof</span> node2 ||<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>         <span class="hljs-keyword">typeof</span> node1 === ‘string’ &amp;&amp; node1 !== node2 ||<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>         node1.type !== node2.type<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">And now, having <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">index</em></strong> of current node in parent we can easily replace it with newly created node:</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElement</span>(<span class="hljs-params">$parent, newNode, oldNode, index = <span class="hljs-number">0</span></span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">if</span> (!oldNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    $parent.appendChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>      createElement(newNode)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!newNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>    $parent.removeChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (changed(newNode, oldNode)) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>    $parent.replaceChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>      createElement(newNode),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="15"><span class="li_linenum_before_span li_linenum_before_span_hide">15</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="16"><span class="li_linenum_before_span li_linenum_before_span_hide">16</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="diff20children_7"><div class="xiaoshujiang_element xsj_anchor">
  <a name="diff20children_7" class="blank_anchor_name"></a><a id="diff20children_7" class="blank_anchor_id"></a><a name="diff-children" class="blank_anchor_name"></a><a id="diff-children" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Diff children</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">And last, but not least — we should go through every child of both nodes and compare them — actually call <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">updateElement(…)</em></strong> for each of them. Yeah, recursion again.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">But there are some things to consider here before writing the code:</p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>We should compare children only if node is an element (text nodes can not have children)</li>
<li><span class="xsj_placeholder_span"></span>Now we pass reference to <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">current node</em></strong> as parent</li>
<li><span class="xsj_placeholder_span"></span>We should compare all children one by one — even if at some point we will have <code>undefined</code> — it is ok — our function can handle that</li>
<li><span class="xsj_placeholder_span"></span>And finally <strong class="markdown_strong_asterisk"><em class="markdown_em_underline">index</em></strong> — it is just index of child node in <code>children</code> array</li>
</ul>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-javascript hljs code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElement</span>(<span class="hljs-params">$parent, newNode, oldNode, index = <span class="hljs-number">0</span></span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span>  <span class="hljs-keyword">if</span> (!oldNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span>    $parent.appendChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>      createElement(newNode)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!newNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span>    $parent.removeChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (changed(newNode, oldNode)) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>    $parent.replaceChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>      createElement(newNode),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="15"><span class="li_linenum_before_span li_linenum_before_span_hide">15</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newNode.type) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="16"><span class="li_linenum_before_span li_linenum_before_span_hide">16</span>    <span class="hljs-keyword">const</span> newLength = newNode.children.length;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="17"><span class="li_linenum_before_span li_linenum_before_span_hide">17</span>    <span class="hljs-keyword">const</span> oldLength = oldNode.children.length;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="18"><span class="li_linenum_before_span li_linenum_before_span_hide">18</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; newLength || i &lt; oldLength; i++) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="19"><span class="li_linenum_before_span li_linenum_before_span_hide">19</span>      updateElement(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="20"><span class="li_linenum_before_span li_linenum_before_span_hide">20</span>        $parent.childNodes[index],<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="21"><span class="li_linenum_before_span li_linenum_before_span_hide">21</span>        newNode.children[i],<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="22"><span class="li_linenum_before_span li_linenum_before_span_hide">22</span>        oldNode.children[i],<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="23"><span class="li_linenum_before_span li_linenum_before_span_hide">23</span>        i<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="24"><span class="li_linenum_before_span li_linenum_before_span_hide">24</span>      );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="25"><span class="li_linenum_before_span li_linenum_before_span_hide">25</span>    }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="26"><span class="li_linenum_before_span li_linenum_before_span_hide">26</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="27"><span class="li_linenum_before_span li_linenum_before_span_hide">27</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="put20that20all20together_8"><div class="xiaoshujiang_element xsj_anchor">
  <a name="put20that20all20together_8" class="blank_anchor_name"></a><a id="put20that20all20together_8" class="blank_anchor_id"></a><a name="put-that-all-together" class="blank_anchor_name"></a><a id="put-that-all-together" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Put That All Together</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Yeah, this is it. We’re there. I’ve put all the code into JSFiddle and the implementation part took really 50 LOC — as I promised you. Go ahead and play with it.</p>
<div class="xiaoshujiang_code_container"><div class="xiaoshujiang_pre"><div class="language-jsx hljs javascript code_linenums xiaoshujiang_code"><ol start="1" class="ol_linenums" style="counter-reset: lines 0;"><li class="li_linenum " date-linenum="1"><span class="li_linenum_before_span li_linenum_before_span_hide">1</span><span class="hljs-comment">/** @jsx h */</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="2"><span class="li_linenum_before_span li_linenum_before_span_hide">2</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="3"><span class="li_linenum_before_span li_linenum_before_span_hide">3</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params">type, props, ...children</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="4"><span class="li_linenum_before_span li_linenum_before_span_hide">4</span>  <span class="hljs-keyword">return</span> { type, props, children };<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="5"><span class="li_linenum_before_span li_linenum_before_span_hide">5</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="6"><span class="li_linenum_before_span li_linenum_before_span_hide">6</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="7"><span class="li_linenum_before_span li_linenum_before_span_hide">7</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span>(<span class="hljs-params">node</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="8"><span class="li_linenum_before_span li_linenum_before_span_hide">8</span>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node === <span class="hljs-string">'string'</span>) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="9"><span class="li_linenum_before_span li_linenum_before_span_hide">9</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createTextNode(node);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="10"><span class="li_linenum_before_span li_linenum_before_span_hide">10</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="11"><span class="li_linenum_before_span li_linenum_before_span_hide">11</span>  <span class="hljs-keyword">const</span> $el = <span class="hljs-built_in">document</span>.createElement(node.type);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="12"><span class="li_linenum_before_span li_linenum_before_span_hide">12</span>  node.children<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="13"><span class="li_linenum_before_span li_linenum_before_span_hide">13</span>    .map(createElement)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="14"><span class="li_linenum_before_span li_linenum_before_span_hide">14</span>    .forEach($el.appendChild.bind($el));<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="15"><span class="li_linenum_before_span li_linenum_before_span_hide">15</span>  <span class="hljs-keyword">return</span> $el;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="16"><span class="li_linenum_before_span li_linenum_before_span_hide">16</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="17"><span class="li_linenum_before_span li_linenum_before_span_hide">17</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="18"><span class="li_linenum_before_span li_linenum_before_span_hide">18</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changed</span>(<span class="hljs-params">node1, node2</span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="19"><span class="li_linenum_before_span li_linenum_before_span_hide">19</span>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> node1 !== <span class="hljs-keyword">typeof</span> node2 ||<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="20"><span class="li_linenum_before_span li_linenum_before_span_hide">20</span>         <span class="hljs-keyword">typeof</span> node1 === <span class="hljs-string">'string'</span> &amp;&amp; node1 !== node2 ||<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="21"><span class="li_linenum_before_span li_linenum_before_span_hide">21</span>         node1.type !== node2.type<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="22"><span class="li_linenum_before_span li_linenum_before_span_hide">22</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="23"><span class="li_linenum_before_span li_linenum_before_span_hide">23</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="24"><span class="li_linenum_before_span li_linenum_before_span_hide">24</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElement</span>(<span class="hljs-params">$parent, newNode, oldNode, index = <span class="hljs-number">0</span></span>) </span>{<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="25"><span class="li_linenum_before_span li_linenum_before_span_hide">25</span>  <span class="hljs-keyword">if</span> (!oldNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="26"><span class="li_linenum_before_span li_linenum_before_span_hide">26</span>    $parent.appendChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="27"><span class="li_linenum_before_span li_linenum_before_span_hide">27</span>      createElement(newNode)<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="28"><span class="li_linenum_before_span li_linenum_before_span_hide">28</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="29"><span class="li_linenum_before_span li_linenum_before_span_hide">29</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!newNode) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="30"><span class="li_linenum_before_span li_linenum_before_span_hide">30</span>    $parent.removeChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="31"><span class="li_linenum_before_span li_linenum_before_span_hide">31</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="32"><span class="li_linenum_before_span li_linenum_before_span_hide">32</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="33"><span class="li_linenum_before_span li_linenum_before_span_hide">33</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (changed(newNode, oldNode)) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="34"><span class="li_linenum_before_span li_linenum_before_span_hide">34</span>    $parent.replaceChild(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="35"><span class="li_linenum_before_span li_linenum_before_span_hide">35</span>      createElement(newNode),<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="36"><span class="li_linenum_before_span li_linenum_before_span_hide">36</span>      $parent.childNodes[index]<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="37"><span class="li_linenum_before_span li_linenum_before_span_hide">37</span>    );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="38"><span class="li_linenum_before_span li_linenum_before_span_hide">38</span>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newNode.type) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="39"><span class="li_linenum_before_span li_linenum_before_span_hide">39</span>    <span class="hljs-keyword">const</span> newLength = newNode.children.length;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="40"><span class="li_linenum_before_span li_linenum_before_span_hide">40</span>    <span class="hljs-keyword">const</span> oldLength = oldNode.children.length;<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="41"><span class="li_linenum_before_span li_linenum_before_span_hide">41</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; newLength || i &lt; oldLength; i++) {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="42"><span class="li_linenum_before_span li_linenum_before_span_hide">42</span>      updateElement(<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="43"><span class="li_linenum_before_span li_linenum_before_span_hide">43</span>        $parent.childNodes[index],<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="44"><span class="li_linenum_before_span li_linenum_before_span_hide">44</span>        newNode.children[i],<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="45"><span class="li_linenum_before_span li_linenum_before_span_hide">45</span>        oldNode.children[i],<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="46"><span class="li_linenum_before_span li_linenum_before_span_hide">46</span>        i<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="47"><span class="li_linenum_before_span li_linenum_before_span_hide">47</span>      );<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="48"><span class="li_linenum_before_span li_linenum_before_span_hide">48</span>    }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="49"><span class="li_linenum_before_span li_linenum_before_span_hide">49</span>  }<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="50"><span class="li_linenum_before_span li_linenum_before_span_hide">50</span>}<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="51"><span class="li_linenum_before_span li_linenum_before_span_hide">51</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="52"><span class="li_linenum_before_span li_linenum_before_span_hide">52</span><span class="hljs-comment">// ---------------------------------------------------------------------</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="53"><span class="li_linenum_before_span li_linenum_before_span_hide">53</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="54"><span class="li_linenum_before_span li_linenum_before_span_hide">54</span><span class="hljs-keyword">const</span> a = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="55"><span class="li_linenum_before_span li_linenum_before_span_hide">55</span>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="56"><span class="li_linenum_before_span li_linenum_before_span_hide">56</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="57"><span class="li_linenum_before_span li_linenum_before_span_hide">57</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="58"><span class="li_linenum_before_span li_linenum_before_span_hide">58</span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="59"><span class="li_linenum_before_span li_linenum_before_span_hide">59</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="60"><span class="li_linenum_before_span li_linenum_before_span_hide">60</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="61"><span class="li_linenum_before_span li_linenum_before_span_hide">61</span><span class="hljs-keyword">const</span> b = (<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="62"><span class="li_linenum_before_span li_linenum_before_span_hide">62</span>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="63"><span class="li_linenum_before_span li_linenum_before_span_hide">63</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="64"><span class="li_linenum_before_span li_linenum_before_span_hide">64</span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>hello!<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="65"><span class="li_linenum_before_span li_linenum_before_span_hide">65</span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="66"><span class="li_linenum_before_span li_linenum_before_span_hide">66</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="67"><span class="li_linenum_before_span li_linenum_before_span_hide">67</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="68"><span class="li_linenum_before_span li_linenum_before_span_hide">68</span><span class="hljs-keyword">const</span> $root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="69"><span class="li_linenum_before_span li_linenum_before_span_hide">69</span><span class="hljs-keyword">const</span> $reload = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'reload'</span>);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="70"><span class="li_linenum_before_span li_linenum_before_span_hide">70</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="71"><span class="li_linenum_before_span li_linenum_before_span_hide">71</span>updateElement($root, a);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="72"><span class="li_linenum_before_span li_linenum_before_span_hide">72</span>$reload.addEventListener(<span class="hljs-string">'click'</span>, () =&gt; {<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="73"><span class="li_linenum_before_span li_linenum_before_span_hide">73</span>  updateElement($root, b, a);<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="74"><span class="li_linenum_before_span li_linenum_before_span_hide">74</span>});<span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="75"><span class="li_linenum_before_span li_linenum_before_span_hide">75</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="76"><span class="li_linenum_before_span li_linenum_before_span_hide">76</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li><li class="li_linenum " date-linenum="77"><span class="li_linenum_before_span li_linenum_before_span_hide">77</span><span style="user-select:none;display:none;">&nbsp;</span><br class="code_line_break_hack_br"><hr class="code_line_break_hack_hr code_line_break_hack" style="margin:0;border:0;border-top:0;border-bottom:0;"></li></ol></div></div></div>
<p class="xsj_paragraph xsj_paragraph_level_0">Open up Developer Tools and watch changes applied when you press <code>Reload</code> button.</p>
<p class="xsj_paragraph xsj_paragraph_level_0"></p><div class="story_image_container story_block_image"><div class="story_image"><div class="gatsby-wrapper-image" style="display:inline-block;max-width: 100%;width:415px; margin-left: auto; margin-right: auto;position:relative;"><div style="width:100%;display:block;padding-bottom: 43.75%;"></div><img class="background_image" src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='174'%3e%3cpath%20d='M0%2087v87h47a320%20320%200%200057-1l1%201%201-2h1c1%202%2014%202%2015%200h1c0%201%201%202%204%202l4-1h3l134%201h133V0H264L124%201c-2%200-3%203%200%203v1c-1%202-3%200-3-2l-1-2-1%202-1%202-1-2-1-2-1%202c0%203-2%202-2-1%200-1%200-2-1-1l-2%202v1l2%201h-9c-8%200-9%200-9-2s-1-3-2-2c-2%200-3%203%200%203v1c-1%201-4%200-4-1h-2c-1%202-3%202-3%201H72c-3%200-6-2-3-3%202%200%200-2-2-2l-4%202v2l-2-2c-2-2-2-2-31-2H0v87m94-71c0%204%202%205%205%203h8l3%201c2%200%202%200%200-1-3-1-2-5%201-6%203%200%203%200%203%203l1%204%201-3%201-4c2%200%204%203%204%205%200%203%202%202%202%200l1-4%201-2-2%201H98c-1-3-4-1-4%203m156%2055c-1%204%200%206%204%207l4-1%202-1%201%201c0%202%205%201%207-1%202-1%202-1%204%201%202%201%203%200%201-2v-4l-2%202c-1%201-1%201-2-1-1-3-6-3-6%201v3l-1-3c-2-3-3-4-4-1h-2c-1-2-5-3-6-1'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e" style="position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"><div class="gif_player"><div class="play_button"></div><img src="/acorns/static/ad7a743fe654fea4c8cc1cc1048c774e/d7d91/1588388855995.gif" alt title name="images/1588388855995.gif" data-src="/acorns/static/1588388855995-ad7a743fe654fea4c8cc1cc1048c774e.gif" class="front_image" loading="lazy" data-still="/acorns/static/ad7a743fe654fea4c8cc1cc1048c774e/d7d91/1588388855995.gif" style="max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;"></div></div><br><div class="story_image_caption story_image_blank_caption"></div></div></div><p></p>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="conclusion_9"><div class="xiaoshujiang_element xsj_anchor">
  <a name="conclusion_9" class="blank_anchor_name"></a><a id="conclusion_9" class="blank_anchor_id"></a><a name="conclusion" class="blank_anchor_name"></a><a id="conclusion" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">Conclusion</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">Congratulations! We’ve done that. We’ve written our Virtual DOM implementation. And it works. I hope that, having read this article, you understood basic concepts of how Virtual DOM should work and how React works under the hood.</p>
<p class="xsj_paragraph xsj_paragraph_level_0">However there are some things that were not highlighted here (I will try to cover them in future articles):</p>
<ul class="markdown_ul">
<li><span class="xsj_placeholder_span"></span>Setting element attributes (props) and diffing/updating them</li>
<li><span class="xsj_placeholder_span"></span>Handling events — adding event listeners to our elements</li>
<li><span class="xsj_placeholder_span"></span>Making our Virtual DOM work with components, like React</li>
<li><span class="xsj_placeholder_span"></span>Getting references to real DOM nodes</li>
<li><span class="xsj_placeholder_span"></span>Using Virtual DOM with libraries that directly mutate real DOM — like jQuery and its plugins</li>
<li><span class="xsj_placeholder_span"></span>and even more…</li>
</ul>
<h1 class="xsj_heading_hash xsj_heading xsj_heading_h1" id="ps_10"><div class="xiaoshujiang_element xsj_anchor">
  <a name="ps_10" class="blank_anchor_name"></a><a id="ps_10" class="blank_anchor_id"></a><a name="ps" class="blank_anchor_name"></a><a id="ps" class="blank_anchor_id"></a>
</div>
<span class="xsj_heading_content">P.S.</span></h1>
<p class="xsj_paragraph xsj_paragraph_level_0">If there any errors in code or article, or if there are any optimizations I can do to this code — feel free to express them in comments :)) And sorry for my English :)</p>
<blockquote class="markdown_blockquote">
<p class="xsj_paragraph xsj_paragraph_level_1"><span class="xsj_placeholder_span"></span>UPDATE: The second article about setting props &amp; events in Virtual DOM is <a href="https://medium.com/@deathmood/write-your-virtual-dom-2-props-events-a957608f5c76" class="xsj_link xsj_manu_link">here</a></p>
</blockquote>
<p class="xsj_paragraph xsj_paragraph_level_0">published from :<a href="https://medium.com/@deathmood/how-to-write-your-own-virtual-dom-ee74acc13060" class="xsj_link xsj_manu_link">How to write your own Virtual DOM - deathmood - Medium</a></p>
</div>

</div></div></section><strong>Tagged with <span><style data-emotion-css="1it6e0j">.css-1it6e0j{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary,#33e);}.css-1it6e0j:hover{color:var(--theme-ui-colors-secondary,#119);}</style><a class="css-1it6e0j" href="/acorns/tags/文章">文章</a><span> | </span></span><span><a class="css-1it6e0j" href="/acorns/tags/转载">转载</a><span> | </span></span><span><a class="css-1it6e0j" href="/acorns/tags/html">html</a><span> | </span></span><span><a class="css-1it6e0j" href="/acorns/tags/javascript">javascript</a><span> | </span></span><span><a class="css-1it6e0j" href="/acorns/tags/english">English</a></span></strong><style data-emotion-css="k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-k008qs"><style data-emotion-css="1eziwv">.css-1eziwv{-webkit-flex:1;-ms-flex:1;flex:1;text-align:left;}</style><div class="css-1eziwv"><a class="css-1it6e0j" href="/acorns/daily-notes/2020-04-30"><h4 class="css-1tr4euk"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" style="vertical-align:sub" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>Previous</h4><span>2020-4-30 工作日志</span></a></div><style data-emotion-css="1bge839">.css-1bge839{-webkit-flex:1;-ms-flex:1;flex:1;text-align:right;}</style><div class="css-1bge839"><a class="css-1it6e0j" href="/acorns/daily-notes/2020-5-8"><h4 class="css-1tr4euk">Next<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" style="vertical-align:sub" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"></path></svg></h4><span>2020-5-8 流浪到淡水</span></a></div></div></div></div></div><style data-emotion-css="lvzlb4">.css-lvzlb4{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:0;background-color:var(--theme-ui-colors-background,#fff);border-top:1px solid;width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:16px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width:650px){.css-lvzlb4{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><style data-emotion-css="1t4nmqc">.css-1t4nmqc{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:0;background-color:var(--theme-ui-colors-background,#fff);border-top:1px solid;width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:16px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width:650px){.css-1t4nmqc{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><div class="css-1t4nmqc"><style data-emotion-css="kfpyh1">.css-kfpyh1{font-size:20px;}@media screen and (min-width:650px){.css-kfpyh1{font-size:24px;}}</style><div class="css-kfpyh1"><span class="css-14uqj98">Time Flies, No Time for Nuts <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-11lk46i" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M422.625 18.28c-24.68.13-51.932 15.455-74.094 36.907 1.868 1.036 3.742 2.07 5.626 3.157 8.05 4.642 15.615 9.363 22.72 14.125 25.19-9.583 55.47-14.465 103.437-2.97-12.036-37.07-33.633-51.345-57.688-51.22zM237.78 40.22l28.97 94.25c12.57 6.443 24.827 13.41 36.813 20.843l-36.625-111.97c-8.476-1.68-16.657-2.662-24.563-3-1.54-.065-3.074-.108-4.594-.124zm-19.218 1.124c-1.602.206-3.202.427-4.78.687-8.815 1.454-17.338 3.755-25.595 6.876l15.688 58.625c13.62 4.75 26.922 10.064 39.906 15.907l-25.218-82.093zm69.875 7.593l40.157 122.876c15.922 11.124 31.32 23.128 46.25 35.906L325.906 64.374c-13.092-6.527-25.568-11.643-37.47-15.438zm-117.5 7.844c-14.657 7.857-28.523 18.348-41.875 31.095 18.42 3.334 36.298 7.632 53.657 12.813L170.937 56.78zm179.25 20.907l53.282 155.97c10.798 10.382 21.322 21.187 31.624 32.374.395-1.174.75-2.332 1.125-3.5L379.843 97.407c-8.84-6.63-18.706-13.185-29.656-19.72zM136.595 108.25c-17.05 11.436-32.43 27.876-45.344 50.22-42.303 73.19-61.83 198.325-24.53 265.717l-.064-.062c.752 23.392-7.597 45.63-17.812 67.594 27.268-12.192 54.897-17.815 82.687-20.783l-.468-.343c87.895 19.01 212.87-49.42 260.688-132.156 13.547-23.44 20.606-46.14 22.28-67.72-77.218-81.572-166.868-139.912-277.436-162.468zm271.469 14L444.188 228c2.638-20.573.96-39.855-5.688-58.25-5.856-16.202-15.717-32.01-30.438-47.5z"></path></svg></span></div><style data-emotion-css="7ipau9">.css-7ipau9{font-family:oswald,sans-serif;font-size:14px;text-align:center;}@media screen and (min-width:650px){.css-7ipau9{font-size:16px;text-align:right;}}</style><div class="css-7ipau9"><div>Copyright © 2020 <!-- -->suziwen</div><div>Build with  <style data-emotion-css="ksfbmy">.css-ksfbmy{color:var(--theme-ui-colors-primary,#33e);}.css-ksfbmy:hover{color:var(--theme-ui-colors-secondary,#119);}</style><a href="https://www.gatsbyjs.com/" target="_blank" rel="noopener noreferrer" class="css-ksfbmy">Gatsbyjs</a>  and  <a href="https://www.github.com/suziwen/gatsby-theme-sculpting" target="_blank" rel="noopener noreferrer" class="css-ksfbmy">Sculpting</a> theme</div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script src="/acorns/libs/zoom/zoom-vanilla.min.js"></script><script>
                  var _hmt = _hmt || [];
                  (function() {
                      var hm = document.createElement("script");
                      hm.src = "//hm.baidu.com/hm.js?c02140dc523f5a309a2717a9a2bac552";
                      var s = document.getElementsByTagName("script")[0]; 
                      s.parentNode.insertBefore(hm, s);
                  })();
              </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tech/how-to-write-your-own-virtual-dom";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-48d6d113cdbd8eaeb1e6.js"],"app":["/app-769f74fe8327c9fb4428.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-404-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-404-js-c8b71f0b9c706e216a1d.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-search-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-pages-search-js-e5540d250449237db552.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-archive-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-archive-js-3371becbe3b208851cf3.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-list-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-list-js-6af4602795e2f8374acc.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js-fb9d310599f1bd239803.js"],"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-tag-js":["/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-tag-js-26b309cc8838d6e433aa.js"]};/*]]>*/</script><script src="/acorns/polyfill-48d6d113cdbd8eaeb1e6.js" nomodule=""></script><script src="/acorns/component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js-fb9d310599f1bd239803.js" async=""></script><script src="/acorns/d24d3e064b601c3fa92397aa9f8c5e3fc3365436-b3b52e1b95113f3f815e.js" async=""></script><script src="/acorns/05d954cf-b0068c1aacfd08ef52dc.js" async=""></script><script src="/acorns/41aca86e-8b5629aa189eae61d7b0.js" async=""></script><script src="/acorns/app-769f74fe8327c9fb4428.js" async=""></script><script src="/acorns/252f366e-a013f1a16a738605ba7c.js" async=""></script><script src="/acorns/545f34e4-5287ae6acbc1289e5dd0.js" async=""></script><script src="/acorns/framework-29ba174b433dc5858bed.js" async=""></script><script src="/acorns/webpack-runtime-b733388348fff5eacca1.js" async=""></script></body></html>