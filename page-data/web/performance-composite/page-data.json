{"componentChunkName":"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js","path":"/web/performance-composite","result":{"data":{"zipFile":{"publicURL":"/acorns/static/a8a7d9b4f364a168f9c2f5006d497347/无线性能优化：Composite.zip"},"site":{"siteMetadata":{"siteUrl":"https://suziwen.github.io/acorns"}},"storyWriterMarkdown":{"id":"5200216d-395b-5cd6-a084-c5f1c80654c7","html":"\n\n\t<div class=\"preview html_preview xsj_export_zip\"><div style=\"overflow: hidden; position: absolute; top: 0; height: 1px; width: auto; padding: 0; border: 0; margin: 0; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;\"><svg><defs id=\"MathJax_SVG_glyphs\"/><defs xmlns=\"http://www.w3.org/2000/svg\"><filter xmlns=\"http://www.w3.org/2000/svg\" id=\"dropshadow\" height=\"130%\">      <fegaussianblur in=\"SourceAlpha\" stddeviation=\"3\"/>       <feoffset dx=\"2\" dy=\"2\" result=\"offsetblur\"/>       <femerge>         <femergenode/>        <femergenode in=\"SourceGraphic\"/>       </femerge>    </filter><filter id=\"editing-stripe-bk\" filterunits=\"userSpaceOnUse\" x=\"-100%\" y=\"-100%\" width=\"300%\" height=\"300%\"><feflood flood-color=\"#700f0f\" result=\"flood1\"/><feflood flood-color=\"#fff\" flood-opacity=\"0.5\" result=\"flood2\"/><feimage xlink:href=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAwcHgiIGhlaWdodD0iMTAwMHB4Ij48ZGVmcz48cGF0dGVybiBpZD0icGF0dGVybiIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjQiIGhlaWdodD0iNCI+PHBhdGggZD0iTSAtNCAtNCBMIDggOCBNIC04IC00IEwgNCA4IE0gLTQgLTggTCA4IDQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI3BhdHRlcm4pIi8+PC9zdmc+\" x=\"0\" y=\"0\" width=\"2000\" height=\"1000\" result=\"image\"/><fetile in=\"image\" result=\"tile\"/><fecomposite operator=\"in\" in=\"flood1\" in2=\"tile\" result=\"tile2\"/><fegaussianblur in=\"SourceAlpha\" stddeviation=\"10\" result=\"blur\"/><fecomposite operator=\"in\" in=\"tile2\" in2=\"blur\" result=\"cloud\"/><femorphology operator=\"dilate\" radius=\"2\" in=\"SourceAlpha\" result=\"dilate\"/><fecomposite operator=\"in\" in=\"flood2\" in2=\"dilate\" result=\"base\"/><femerge><femergenode in=\"cloud\"/><femergenode in=\"base\"/><femergenode in=\"SourceGraphic\"/></femerge></filter></defs></svg></div><blockquote class=\"markdown_blockquote\">\n<p class=\"xsj_paragraph xsj_paragraph_level_1\"><span class=\"xsj_placeholder_span\"></span>本文为转载文章, 仅用于自己的知识管理收集, 如果涉及侵权,请联系 <a href=\"mailto:suziwen1@gmail.com\" class=\"xsj_link xsj_auto_link\">suziwen1@gmail.com</a>,会第一时间删除<br>\n收集该文章,并非代表本人支持文中观点,只是觉得文章内容容易引起思考,讨论,有它自有的价值</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_1\"><span class=\"xsj_placeholder_span\"></span>转载自: <a href=\"https://fed.taobao.org/blog/2016/04/26/performance-composite/\" class=\"xsj_link xsj_auto_link\">https://fed.taobao.org/blog/2016/04/26/performance-composite/</a><br>\n相关 demo 的备份地址 <a href=\"https://github.com/suziwen/taofeddemo\" class=\"xsj_link xsj_auto_link\">https://github.com/suziwen/taofeddemo</a></p>\n</blockquote>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"toc mindmap_toc mindmap_container\" data-vdom-skip=\"true\" data-hash=\"353d96bd8a38c809e9811b9df70cf52f_mindmap_toc\"><div class=\"xsj_mindmap xsj_mindmap_toc\"><svg id=\"xsj_mindmap_toc_1603762455621\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" class=\"xsj_svg_viewbox\" style=\"max-width:1181px;max-height:639px;\" viewbox=\"0 0 1181 639\" width=\"100%\" height=\"100%\"><g transform=\"translate(353.5,377.5) scale(1)\"><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"1\" d=\"M662.5,-173.5 L667.5,-173.5 C703.5,-173.5 698.5,-173.5 734.5,-173.5 L736.5,-173.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(662.5, -173.5)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: white;\"/><g transform=\"translate(734.5,-173.5)\"><path class=\"markmap-node-path\" d=\"M0,0L44,0\" stroke-width=\"1\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(44, 0)\" points=\"0,-0.5 5,0 0,0.5 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"2\" d=\"M365.5,-249.5 L370.5,-249.5 C406.5,-249.5 401.5,-173.5 437.5,-173.5 L439.5,-173.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(365.5, -249.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(437.5,-173.5)\"><path class=\"markmap-node-path\" d=\"M0,0L224,0\" stroke-width=\"2\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(224, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"2\" d=\"M365.5,-249.5 L370.5,-249.5 C406.5,-249.5 401.5,-247.5 437.5,-247.5 L439.5,-247.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(365.5, -249.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(437.5,-247.5)\"><path class=\"markmap-node-path\" d=\"M0,0L214,0\" stroke-width=\"2\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(214, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"2\" d=\"M365.5,-249.5 L370.5,-249.5 C406.5,-249.5 401.5,-321.5 437.5,-321.5 L439.5,-321.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(365.5, -249.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(437.5,-321.5)\"><path class=\"markmap-node-path\" d=\"M0,0L179,0\" stroke-width=\"2\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(179, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"1\" d=\"M482.5,128.5 L487.5,128.5 C523.5,128.5 518.5,128.5 554.5,128.5 L556.5,128.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(482.5, 128.5)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: white;\"/><g transform=\"translate(554.5,128.5)\"><path class=\"markmap-node-path\" d=\"M0,0L74,0\" stroke-width=\"1\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(74, 0)\" points=\"0,-0.5 5,0 0,0.5 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M305.5,15.5 L310.5,15.5 C346.5,15.5 341.5,128.5 377.5,128.5 L379.5,128.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(305.5, 15.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(377.5,128.5)\"><path class=\"markmap-node-path\" d=\"M0,0L104,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(104, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M305.5,15.5 L310.5,15.5 C346.5,15.5 341.5,54.5 377.5,54.5 L379.5,54.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(305.5, 15.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(377.5,54.5)\"><path class=\"markmap-node-path\" d=\"M0,0L89,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(89, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M305.5,15.5 L310.5,15.5 C346.5,15.5 341.5,-19.5 377.5,-19.5 L379.5,-19.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(305.5, 15.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(377.5,-19.5)\"><path class=\"markmap-node-path\" d=\"M0,0L290,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(290, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M305.5,15.5 L310.5,15.5 C346.5,15.5 341.5,-93.5 377.5,-93.5 L379.5,-93.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(305.5, 15.5)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(377.5,-93.5)\"><path class=\"markmap-node-path\" d=\"M0,0L134,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(134, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#dc3912\" stroke-width=\"4\" d=\"M117.5,-28.1 L122.5,-28.1 C194.5,-28.1 189.5,171.5 225.5,171.5 L227.5,171.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(117.5, -28.1)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(225.5,171.5)\"><path class=\"markmap-node-path\" d=\"M0,0L39,0\" stroke-width=\"4\" stroke=\"#dc3912\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(39, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(220, 57, 18);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#ff9900\" stroke-width=\"4\" d=\"M117.5,-28.1 L122.5,-28.1 C194.5,-28.1 189.5,93.5 225.5,93.5 L227.5,93.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(117.5, -28.1)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(225.5,93.5)\"><path class=\"markmap-node-path\" d=\"M0,0L39,0\" stroke-width=\"4\" stroke=\"#ff9900\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(39, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(255, 153, 0);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"4\" d=\"M117.5,-28.1 L122.5,-28.1 C194.5,-28.1 189.5,15.5 225.5,15.5 L227.5,15.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(117.5, -28.1)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(225.5,15.5)\"><path class=\"markmap-node-path\" d=\"M0,0L79,0\" stroke-width=\"4\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(79, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#990099\" stroke-width=\"4\" d=\"M117.5,-28.1 L122.5,-28.1 C194.5,-28.1 189.5,-171.5 225.5,-171.5 L227.5,-171.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(117.5, -28.1)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(225.5,-171.5)\"><path class=\"markmap-node-path\" d=\"M0,0L139,0\" stroke-width=\"4\" stroke=\"#990099\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(139, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(153, 0, 153);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"4\" d=\"M117.5,-28.1 L122.5,-28.1 C194.5,-28.1 189.5,-249.5 225.5,-249.5 L227.5,-249.5\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(117.5, -28.1)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(225.5,-249.5)\"><path class=\"markmap-node-path\" d=\"M0,0L139,0\" stroke-width=\"4\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(139, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-node markmap-root-node\" transform=\"translate(-261.5,-28.1)\"><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(378, 0)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: rgb(51, 102, 204);\"/><g transform=\"translate(1, -34)\"><rect class=\"markmap-node-rect\" rx=\"10\" ry=\"10\" height=\"68\" width=\"377\" fill=\"rgb(78, 156, 255)\" stroke=\"#3366cc\" stroke-width=\"1\"/><text class=\"markmap-node-text\" alignment-baseline=\"middle\" x=\"189.5\" y=\"44\" text-anchor=\"middle\" style=\"font: bolder 30px sans-serif; fill-opacity: 1; fill: rgb(255, 255, 255);\">无线性能优化：Composite</text></g></g><g class=\"markmap-node\" transform=\"translate(225.5,171.5)\"><a xlink:href=\"#e58f82e88083_14\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); stroke: white; stroke-width: 2px; cursor: pointer;\">参考</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); cursor: pointer;\">参考</text></a></g><g class=\"markmap-node\" transform=\"translate(225.5,93.5)\"><a xlink:href=\"#e69c80e5908e_13\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); stroke: white; stroke-width: 2px; cursor: pointer;\">最后</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); cursor: pointer;\">最后</text></a></g><g class=\"markmap-node\" transform=\"translate(225.5,15.5)\"><a xlink:href=\"#e680a7e883bde4bc98e58c96_7\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">性能优化</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">性能优化</text></a></g><g class=\"markmap-node\" transform=\"translate(377.5,128.5)\"><a xlink:href=\"#e59088e79086e7aea1e79086e59088e68890e5b182_11\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">合理管理合成层</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">合理管理合成层</text></a></g><g class=\"markmap-node\" transform=\"translate(554.5,128.5)\"><a xlink:href=\"#e998b2e6ada2e5b182e78886e782b8_12\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">防止层爆炸</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">防止层爆炸</text></a></g><g class=\"markmap-node\" transform=\"translate(377.5,54.5)\"><a xlink:href=\"#e5878fe5b091e7bb98e588b6e58cbae59f9f_10\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">减少绘制区域</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">减少绘制区域</text></a></g><g class=\"markmap-node\" transform=\"translate(377.5,-19.5)\"><a xlink:href=\"#e4bdbfe794a820transform20e68896e8808520opacity20e69da5e5ae9ee78eb0e58aa8e794bbe69588e69e9c_9\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">使用 transform 或者 opacity 来实现动画效果</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">使用 transform 或者 opacity 来实现动画效果</text></a></g><g class=\"markmap-node\" transform=\"translate(377.5,-93.5)\"><a xlink:href=\"#e68f90e58d87e58aa8e794bbe69588e69e9ce79a84e58583e7b4a0_8\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">提升动画效果的元素</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">提升动画效果的元素</text></a></g><g class=\"markmap-node\" transform=\"translate(225.5,-171.5)\"><a xlink:href=\"#e5a682e4bd95e69fa5e79c8be59088e68890e5b182_6\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(153, 0, 153); stroke: white; stroke-width: 2px; cursor: pointer;\">如何查看合成层</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(153, 0, 153); cursor: pointer;\">如何查看合成层</text></a></g><g class=\"markmap-node\" transform=\"translate(225.5,-249.5)\"><a xlink:href=\"#e6b58fe8a788e599a8e6b8b2e69f93e58e9fe79086_1\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">浏览器渲染原理</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">浏览器渲染原理</text></a></g><g class=\"markmap-node\" transform=\"translate(437.5,-173.5)\"><a xlink:href=\"#e4bb8e20paintlayers20e588b020graphicslayers_4\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">从 PaintLayers 到 GraphicsLayers</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">从 PaintLayers 到 GraphicsLayers</text></a></g><g class=\"markmap-node\" transform=\"translate(734.5,-173.5)\"><a xlink:href=\"#e5b182e58e8be7bca9_5\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">层压缩</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">层压缩</text></a></g><g class=\"markmap-node\" transform=\"translate(437.5,-247.5)\"><a xlink:href=\"#e4bb8e20layoutobjects20e588b020paintlayers_3\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">从 LayoutObjects 到 PaintLayers</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">从 LayoutObjects 到 PaintLayers</text></a></g><g class=\"markmap-node\" transform=\"translate(437.5,-321.5)\"><a xlink:href=\"#e4bb8e20nodes20e588b020layoutobjects_2\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">从 Nodes 到 LayoutObjects</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">从 Nodes 到 LayoutObjects</text></a></g><g class=\"annotation-group\"><g class=\"annotations\"/></g></g></svg></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">一个 Web 页面的展示，简单来说可以认为经历了以下下几个步骤。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 15.234375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='61'%3e%3cpath%20d='M13%2011l-2%202a1974%201974%200%20010%2036l44%201h44l4-9%205-11-5-11-2-5-1-3H13m90%200l4%2010%205%209-5%209-4%2010c0%201%2058%202%2060%201l5-11%204-9-5-10-4-10h-30l-30%201m63%200l5%2010%204%209-4%2010-5%2010h66l4-10%205-10-5-10-4-10h-33l-33%201m69%200l4%2010%205%209-5%2010-4%2010h59l5-9c5-11%205-10-1-21l-4-10h-30l-29%201m63%200l4%209c4%208%205%2012%203%2013l-4%209-4%208h93V10h-46l-46%201M52%2026v4l-1-1c-1-3-8-4-9-1-1%201-1%201-1-1s0-2-1-1h-8v4c0%204%200%204%203%204l4-1h6l12%201c12%200%2012%200%2012-3l1-2c1-1%201%200%201%202%200%203%202%204%202%201%201-1%201%200%201%202%200%203%202%204%203%202l1-1%202-2h1c2%202%204%201%203-2l1-2c2%202%201-2-1-3-1-2-2-2-2-1l-5%201c-3%201-4%200-4-1%201-1%200-1-1-1s-2%200-1%201l-7%201-4%202h-2l1-2c1%200%201-1-1-1-3-1-5-1-6%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/1b882c131d28eb11a0cbc9d5f0173720/80e3c/1603721617640.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617640.jpg\" data-src=\"./images/1603721617640.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/1b882c131d28eb11a0cbc9d5f0173720/e4a55/1603721617640.jpg 256w,\n/acorns/static/1b882c131d28eb11a0cbc9d5f0173720/36dd4/1603721617640.jpg 512w,\n/acorns/static/1b882c131d28eb11a0cbc9d5f0173720/80e3c/1603721617640.jpg 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>JavaScript：一般来说，我们会使用 JavaScript 来实现一些视觉变化的效果。比如做一个动画或者往页面里添加一些 DOM 元素等。</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>Style：计算样式，这个过程是根据 CSS 选择器，对每个 DOM 元素匹配对应的 CSS 样式。这一步结束之后，就确定了每个 DOM 元素上该应用什么 CSS 样式规则。</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>Layout：布局，上一步确定了每个 DOM 元素的样式规则，这一步就是具体计算每个 DOM 元素最终在屏幕上显示的大小和位置。web 页面中元素的布局是相对的，因此一个元素的布局发生变化，会联动地引发其他元素的布局发生变化。比如，<code>&lt;body&gt;</code> 元素的宽度的变化会影响其子元素的宽度，其子元素宽度的变化也会继续对其孙子元素产生影响。因此对于浏览器来说，布局过程是经常发生的。</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>Paint：绘制，本质上就是填充像素的过程。包括绘制文字、颜色、图像、边框和阴影等，也就是一个 DOM 元素所有的可视效果。一般来说，这个绘制过程是在多个层上完成的。</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>Composite：渲染层合并，由上一步可知，对页面中 DOM 元素的绘制是在多个层上进行的。在每个层上完成绘制过程之后，浏览器会将所有层按照合理的顺序合并成一个图层，然后显示在屏幕上。对于有位置重叠的元素的页面，这个过程尤其重要，因为一旦图层的合并顺序出错，将会导致元素显示异常。</p>\n</li>\n</ul>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">当然，本文我们只来关注 Composite 部分。</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e6b58fe8a788e599a8e6b8b2e69f93e58e9fe79086_1\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e6b58fe8a788e599a8e6b8b2e69f93e58e9fe79086_1\" class=\"blank_anchor_name\"></a><a id=\"e6b58fe8a788e599a8e6b8b2e69f93e58e9fe79086_1\" class=\"blank_anchor_id\"></a><a name=\"浏览器渲染原理\" class=\"blank_anchor_name\"></a><a id=\"浏览器渲染原理\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">浏览器渲染原理</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">在讨论 Composite 之前，有必要先简单了解下一些浏览器（本文只是针对 Chrome 来说）的渲染原理，方便对之后一些概念的理解。更多详细的内容可以参阅 <a href=\"http://www.chromium.org/developers/design-documents/gpu-accelerated-compositing-in-chrome\" class=\"xsj_link xsj_manu_link\">GPU Accelerated Compositing in Chrome</a></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">注：由于 Chrome 对 Blank 引擎某些实现的修改，某些我们之前熟知的类名有了变化，比如 RenderObject 变成了 LayoutObject，RenderLayer 变成了 PaintLayer。感兴趣的看以参阅 <a href=\"https://www.chromium.org/blink/slimming-paint\" class=\"xsj_link xsj_manu_link\">Slimming Paint</a>。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">在浏览器中，页面内容是存储为由 Node 对象组成的树状结构，也就是 DOM 树。每一个 HTML element 元素都有一个 Node 对象与之对应，DOM 树的根节点永远都是 Document Node。这一点相信大家都很熟悉了，但其实，从 DOM 树到最后的渲染，需要进行一些转换映射。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 39.453125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='157'%3e%3cpath%20d='M343%2014c-3%200-5%204-6%209%200%203-1%204-2%204-1-1-2%200-2%201%200%202%200%202%202%202%201-1%202%200%203%203%202%206%203%206%2026%206%2027%200%2026%200%2027-12%200-7%200-8-2-11l-3-2-20-1-23%201m-92%202l-4%201c-5%202-8%2013-5%2020%202%205%207%206%2016%206l7%201a5856%205856%200%20011%201c1-1%2032%2024%2032%2025l-8%201c-11%200-13%202-13%2013%200%2013%200%2013%2025%2013h20l3-3c3-3%203-3%203-11-1-11-2-12-16-12-8%200-10%200-10-2l-2-1-16-12-15-12%209-1c11-1%2013-2%2014-10%201-7%200-12-3-14-2-2-3-3-20-3h-18m-90%205l-1%202-1%201c-1-1-1%200-1%202a65%2065%200%2001-1%208c0%202%200%202-2%202-2-1-2-1-2%201s0%202%202%202c2-1%202-1%202%201%200%206%203%208%2012%208l8%201-10%207-12%208-2%202c0%202-1%202-8%202-8%200-13%201-11%203l-1%201c-1-1-1%200-2%203%200%203-1%204-2%204-1-1-2%200-2%201-1%201%200%202%203%201l1%204c-1%2010%201%2011%2013%2011h8v13c0%2011%200%2014%202%2013V96h8c12%200%2013-1%2013-13%200-13-1-14-11-15-10%200-10-1%204-11l11-8%2014%2014a1743%201743%200%20001-2l-13-13h8c10%200%2011-1%2012-10%201-8%200-15-3-17-2-1-35-2-37%200M43%2027c-3%201-4%203-4%2010%200%209%201%2011%209%2011l5%201-14%209a176%20176%200%2001-17%2012l-8%201C4%2071%203%2072%203%2082s1%2011%2011%2011h7v10l-1%209v2c1%202%201%202-6%202-10%200-11%201-11%2011%200%2011%201%2011%2019%2011%2016%200%2018-1%2018-8%200-12-1-14-10-14h-8V93h7c9%200%2010-1%2011-8%201-10-1-14-9-14s-9%200%2014-15l12-8%2014%2014%2014%2014-6%201-8%202-1%202%201%207c0%2010%200%2010%2017%2011%2019%200%2020%200%2020-12l1-6v-1l-3-1c-1-2-3-2-9-2l-9-1-1-2c0%201-7-5-14-13L60%2048h6l8-1%203-8v-1l1-2-2-3c0-6-2-6-17-7l-16%201m320%2015l-7%2076c0%202%202%204%203%202v-3a1659%201659%200%20014-75M198%2080c-3%201-5%206-4%2010%201%202%200%202-1%201-2%200-2%200-2%202s0%202%202%202c1-1%202%200%201%203-1%207%201%208%2022%208%2023%200%2022%200%2022-14-1-14%200-13-20-13-12-1-18%200-20%201m-63%2044l-1%202-1%201c-1-1-1%200-2%203%200%203-1%204-2%204h-3c-1%201-1%201%202%202%203%200%203%200%203%206%200%209%201%209%2022%209%2022%200%2021%200%2022-10%201-9-1-15-4-17h-36m94%201l-2%205c0%203%200%203-2%203-2-1-3%200-2%202h2c2%200%202%200%202%204%200%209%203%2010%2025%2010%2024%200%2025-1%2025-14%200-12%200-12-25-12-20%200-21%200-23%202m103%200c-4%204-4%2017%200%2021%202%202%204%202%2024%202h22l3-2c3-4%203-16%200-20l-2-3h-23c-20%200-23%200-24%202'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/49fb09262a1a84c0d3558538649638d4/37523/1603721617656.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617656.png\" data-src=\"./images/1603721617656.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/49fb09262a1a84c0d3558538649638d4/6f3f2/1603721617656.png 256w,\n/acorns/static/49fb09262a1a84c0d3558538649638d4/01e7c/1603721617656.png 512w,\n/acorns/static/49fb09262a1a84c0d3558538649638d4/37523/1603721617656.png 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e4bb8e20nodes20e588b020layoutobjects_2\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e4bb8e20nodes20e588b020layoutobjects_2\" class=\"blank_anchor_name\"></a><a id=\"e4bb8e20nodes20e588b020layoutobjects_2\" class=\"blank_anchor_id\"></a><a name=\"从-nodes-到-layoutobjects\" class=\"blank_anchor_name\"></a><a id=\"从-nodes-到-layoutobjects\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">从 Nodes 到 LayoutObjects</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">DOM 树中得每个 Node 节点都有一个对应的 LayoutObject 。LayoutObject 知道如何在屏幕上 paint Node 的内容。</p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e4bb8e20layoutobjects20e588b020paintlayers_3\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e4bb8e20layoutobjects20e588b020paintlayers_3\" class=\"blank_anchor_name\"></a><a id=\"e4bb8e20layoutobjects20e588b020paintlayers_3\" class=\"blank_anchor_id\"></a><a name=\"从-layoutobjects-到-paintlayers\" class=\"blank_anchor_name\"></a><a id=\"从-layoutobjects-到-paintlayers\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">从 LayoutObjects 到 PaintLayers</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">一般来说，拥有相同的坐标空间的 LayoutObjects，属于同一个渲染层（PaintLayer）。PaintLayer 最初是用来实现 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Understanding_z_index/The_stacking_context\" class=\"xsj_link xsj_manu_link\">stacking contest（层叠上下文）</a>，以此来保证页面元素以正确的顺序合成（composite），这样才能正确的展示元素的重叠以及半透明元素等等。因此满足形成层叠上下文条件的 LayoutObject 一定会为其创建新的渲染层，当然还有其他的一些特殊情况，为一些特殊的 LayoutObjects 创建一个新的渲染层，比如 <code>overflow != visible</code> 的元素。根据创建 PaintLayer 的原因不同，可以将其分为常见的 3 类：</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>NormalPaintLayer</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>根元素（HTML）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有明确的定位属性（relative、fixed、sticky、absolute）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>透明的（opacity 小于 1）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 CSS 滤镜（fliter）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 CSS mask 属性</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 CSS mix-blend-mode 属性（不为 normal）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 CSS transform 属性（不为 none）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>backface-visibility 属性为 hidden</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 CSS reflection 属性</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 CSS column-count 属性（不为 auto）或者 有 CSS column-width 属性（不为 auto）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>当前有对于 opacity、transform、fliter、backdrop-filter 应用动画</p>\n</li>\n</ul>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>OverflowClipPaintLayer</p>\n<ul class=\"markdown_ul\">\n<li><span class=\"xsj_placeholder_span\"></span>overflow 不为 visible</li>\n</ul>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>NoPaintLayer</p>\n<ul class=\"markdown_ul\">\n<li><span class=\"xsj_placeholder_span\"></span>不需要 paint 的 PaintLayer，比如一个没有视觉属性（背景、颜色、阴影等）的空 div。</li>\n</ul>\n</li>\n</ul>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">满足以上条件的 LayoutObject 会拥有独立的渲染层，而其他的 LayoutObject 则和其第一个拥有渲染层的父元素共用一个。</p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e4bb8e20paintlayers20e588b020graphicslayers_4\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e4bb8e20paintlayers20e588b020graphicslayers_4\" class=\"blank_anchor_name\"></a><a id=\"e4bb8e20paintlayers20e588b020graphicslayers_4\" class=\"blank_anchor_id\"></a><a name=\"从-paintlayers-到-graphicslayers\" class=\"blank_anchor_name\"></a><a id=\"从-paintlayers-到-graphicslayers\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">从 PaintLayers 到 GraphicsLayers</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">某些特殊的渲染层会被认为是合成层（Compositing Layers），合成层拥有单独的 GraphicsLayer，而其他不是合成层的渲染层，则和其第一个拥有 GraphicsLayer 父层公用一个。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">每个 GraphicsLayer 都有一个 GraphicsContext，GraphicsContext 会负责输出该层的位图，位图是存储在共享内存中，作为纹理上传到 GPU 中，最后由 GPU 将多个位图进行合成，然后 draw 到屏幕上，此时，我们的页面也就展现到了屏幕上。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">渲染层提升为合成层的原因有一下几种：</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">注：渲染层提升为合成层有一个先决条件，该渲染层必须是 SelfPaintingLayer（基本可认为是上文介绍的 NormalPaintLayer）。以下所讨论的渲染层提升为合成层的情况都是在该渲染层为 SelfPaintingLayer 前提下的。</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>直接原因（direct reason）</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>硬件加速的 iframe 元素（比如 iframe 嵌入的页面中有合成层）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/direct/iframe.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>video 元素</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>覆盖在 video 元素上的视频控制栏</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>3D 或者 硬件加速的 2D Canvas 元素</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/direct/canvas.html?spm=taofed.bloginfo.blog.5.2c585ac8CtBH5d\" class=\"xsj_link xsj_manu_link\">demo：普通 2D Canvas 不会提升为合成层</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/direct/webgl.html\" class=\"xsj_link xsj_manu_link\">demo：3D Canvas 提升为合成层</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>硬件加速的插件，比如 flash 等等</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>在 DPI 较高的屏幕上，fix 定位的元素会自动地被提升到合成层中。但在 DPI 较低的设备上却并非如此，因为这个渲染层的提升会使得字体渲染方式由子像素变为灰阶（详细内容请参考：<a href=\"http://www.html5rocks.com/en/tutorials/internals/antialiasing-101/?redirect_from_locale=zh#toc-text-rendering\" class=\"xsj_link xsj_manu_link\">Text Rendering</a>）</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 3D transform</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>backface-visibility 为 hidden</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>对 opacity、transform、fliter、backdropfilter 应用了 animation 或者 transition（需要是 active 的 animation 或者 transition，当 animation 或者 transition 效果未开始或结束后，提升合成层也会失效）</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_6\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/direct/animation.html\" class=\"xsj_link xsj_manu_link\">demo：animation</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_6\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/direct/transition.html\" class=\"xsj_link xsj_manu_link\">demo：transition</a></p>\n</li>\n</ul>\n</li>\n</ul>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:959px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 38.67187499999999%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='154'%3e%3cpath%20d='M11%2011c-7%205-7%207-1%2015l5%206%203-3%208-5c5-4%205-4-1-11s-8-7-14-2m32-1l1%201h42c2-2-3-3-22-3-18%200-21%200-21%202m218%200l22%201%2021-1c0-2-3-2-21-2-19%200-22%200-22%202m-35%209v9h19V9h-19v10m67%20112h-3c-3%200-4%201-4%202v2h30c1%201%201%201%201-1%200-3%200-3-4-3h-10l-1%202h-1l-3-2h-5'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/5a70536d4914ca6112ac9583c2bef717/9100a/1603721617681.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617681.jpg\" data-src=\"./images/1603721617681.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/5a70536d4914ca6112ac9583c2bef717/e4a55/1603721617681.jpg 256w,\n/acorns/static/5a70536d4914ca6112ac9583c2bef717/36dd4/1603721617681.jpg 512w,\n/acorns/static/5a70536d4914ca6112ac9583c2bef717/9100a/1603721617681.jpg 959w\" sizes=\"(max-width: 959px) 100vw, 959px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span></p>\n<ul class=\"markdown_ul\">\n<li><span class=\"xsj_placeholder_span\"></span>will-change 设置为 opacity、transform、top、left、bottom、right（其中 top、left 等需要设置明确的定位属性，如 relative 等）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/direct/will-change.html?spm=taofed.bloginfo.blog.10.2c585ac8CtBH5d\" class=\"xsj_link xsj_manu_link\">demo</a></li>\n</ul>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>后代元素原因</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有合成层后代同时本身有 transform、opactiy（小于 1）、mask、fliter、reflection 属性 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/descendant/combo.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有合成层后代同时本身 overflow 不为 visible（如果本身是因为明确的定位因素产生的 SelfPaintingLayer，则需要 z-index 不为 auto） <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/descendant/overflow.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有合成层后代同时本身 fixed 定位 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/descendant/fixed.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 3D transfrom 的合成层后代同时本身有 preserves-3d 属性 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/descendant/preserves-3d.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>有 3D transfrom 的合成层后代同时本身有 perspective 属性 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/descendant/perspective.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>overlap 重叠原因<br>\n为什么会因为重叠原因而产生合成层呢？举个简单的栗子。<br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:491px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 60.9375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='244'%3e%3cpath%20d='M66%209H43c-22%200-25%200-24%204v15a1822%201822%200%20000%20139%20321%20321%200%20010%2041c-1%204%200%2022%201%2023l87%201a40111%2040111%200%2001268%200h5V10l-63-1a1726%201726%200%2001-66%200h-62A2888%202888%200%200166%209m-43%205l-1%20108%201%20107h176l177-1V15c0-2-1-2-176-2L23%2014m151%2037v32h-2a1801%201801%200%2001-124%201c-1%202%200%20129%201%20130l93%201h91v-27c0-26%200-26%202-26a1562%201562%200%2001117-2c2%200%202-7%202-70V20H174v31m50%2011h64v14h-32l-32%201h65V61h-33l-32%201m39%2018h43v56h-36l-35%201h72V79h-86l42%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/10c580164f4ff2099f3bd0fcfed98cf0/aa486/1603721617741.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617741.jpg\" data-src=\"./images/1603721617741.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/10c580164f4ff2099f3bd0fcfed98cf0/e4a55/1603721617741.jpg 256w,\n/acorns/static/10c580164f4ff2099f3bd0fcfed98cf0/aa486/1603721617741.jpg 491w\" sizes=\"(max-width: 491px) 100vw, 491px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span><br>\n蓝色的矩形重叠在绿色矩形之上，同时它们的父元素是一个 GraphicsLayer。此时假设绿色矩形为一个 GraphicsLayer，如果 overlap 无法提升合成层的话，那么蓝色矩形不会提升为合成层，也就会和父元素公用一个 GraphicsLayer。<br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:491px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 60.9375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='244'%3e%3cpath%20d='M20%2010l-1%2095a10396%2010396%200%20010%20124l1%203h360v-60a600%20600%200%2000-1-60V80l1-36V10l-35-1a330%20330%200%2000-38%201%20155%20155%200%2000-36%200l-12-1-13%201h-1a836%20836%200%2000-109%200%20256%20256%200%2000-47%200H20m145%202l-71%201H23l-1%202v109l1%20105h22a954%20954%200%200171%200h19a114%20114%200%200123%200%20289%20289%200%200131%200%20216%20216%200%200140%200%20270%20270%200%200143%201c0-2%2018-2%2019-1h4l1%201a116%20116%200%200127-1%20266%20266%200%200145%200h4c4%200%204%200%204-3V15c0-2-1-2-105-2a1800%201800%200%2001-106-1m8%209c-2%201-2%206-2%2032l-1%2031H48v65c0%2058%200%2065%202%2065h181c2%200%202-3%202-24v-24l2-1%2061-1%2060-1%201-72V20l-92-1c-85%200-91%200-92%202m32%2040h-3v57h15V97l1-21h73v-7c0-7%200-8-2-8h-84m14%2046v29h89V78h-89v29m87-7v27l-1%206h-82v-3c-1-2-1-2-1%201v4l42-1h43v-27l-1-27v20'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/a0c10e1389d4da5c93074874a525dac7/aa486/1603721617749.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617749.jpg\" data-src=\"./images/1603721617749.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/a0c10e1389d4da5c93074874a525dac7/e4a55/1603721617749.jpg 256w,\n/acorns/static/a0c10e1389d4da5c93074874a525dac7/aa486/1603721617749.jpg 491w\" sizes=\"(max-width: 491px) 100vw, 491px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span><br>\n此时，渲染顺序就会发生错误，因此为保证渲染顺序，overlap 也成为了合成层产生的原因，也就是如下的正常情形。<br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:491px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 60.9375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='244'%3e%3cpath%20d='M20%2010l-1%2095a15113%2015113%200%20011%20126%2013690%2013690%200%2000301%201h59V10L219%209a4653%204653%200%2000-199%201m3%205l-1%20108%201%20106h12a1615%201615%200%200144%200%20540%20540%200%200156%200%20514%20514%200%200148%200%205897%205897%200%2001166%200h27V14l-177-1H23v2m150%206l-1%2031-1%2031h-62c-56%200-60%200-62%202l-1%2067v65l2%201c4%201%20185%200%20186-1l1-26%201-26%2059-1%2059-1c2-1%202-7%202-72V20l-91-1c-79%200-91%200-92%202m28%2051v10h8c8%200%208%200%208-2v-3h72V61h-88v11m19%208c1%201%201%201-1%201-1%201-1%201%201%201%202%201%203%200%203-1l2-1c2%200%202%200%201%201-2%201-2%201%201%201l3-1v-1l1%201%202%201c2%200%203%201%203%203l2%202v1c-2%200-2%2047%200%2046l2%201-2%201c-1%201%2014%201%2034%201h35V79h-44c-26%200-44%200-43%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/f8adb9158048463ff872f7ddd6b37e84/aa486/1603721617744.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617744.jpg\" data-src=\"./images/1603721617744.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/f8adb9158048463ff872f7ddd6b37e84/e4a55/1603721617744.jpg 256w,\n/acorns/static/f8adb9158048463ff872f7ddd6b37e84/aa486/1603721617744.jpg 491w\" sizes=\"(max-width: 491px) 100vw, 491px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span><br>\n当然 overlap 的原因也会细分为几类，接下来我们会详细看下。</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_4\"><span class=\"xsj_placeholder_span\"></span>重叠或者说部分重叠在一个合成层之上。<br>\n那如何算是重叠呢，最常见和容易理解的就是元素的 border box（content + padding + border） 和合成层的有重叠，比如：<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/normal.html\" class=\"xsj_link xsj_manu_link\">demo</a>，当然 margin area 的重叠是无效的（<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/margin.html\" class=\"xsj_link xsj_manu_link\">demo</a>）。其他的还有一些不常见的情况，也算是同合成层重叠的条件，如下：</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_6\"><span class=\"xsj_placeholder_span\"></span>filter 效果同合成层重叠 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/filter.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_6\"><span class=\"xsj_placeholder_span\"></span>transform 变换后同合成层重叠 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/transform.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_6\"><span class=\"xsj_placeholder_span\"></span>overflow scroll 情况下同合成层重叠。即如果一个 overflow scroll（不管 <code>overflow:auto</code> 还是 <code>overflow:scrill</code>，只要是能 scroll 即可） 的元素同一个合成层重叠，则其可视子元素也同该合成层重叠 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/overflow.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_6\"><span class=\"xsj_placeholder_span\"></span>假设重叠在一个合成层之上（assumedOverlap）。<br>\n这个原因听上去有点虚，什么叫假设重叠？其实也比较好理解，比如一个元素的 CSS 动画效果，动画运行期间，元素是有可能和其他元素有重叠的。针对于这种情况，于是就有了 assumedOverlap 的合成层产生原因，示例可见：<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/animation.html\" class=\"xsj_link xsj_manu_link\">demo</a>。在本 demo 中，动画元素视觉上并没有和其兄弟元素重叠，但因为 assumedOverlap 的原因，其兄弟元素依然提升为了合成层。<br>\n需要注意的是该原因下，有一个很特殊的情况：<br>\n如果合成层有内联的 transform 属性，会导致其兄弟渲染层 assume overlap，从而提升为合成层。比如：<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/layer-create/overlap/inline.html\" class=\"xsj_link xsj_manu_link\">demo</a>。</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h4 class=\"xsj_heading_hash xsj_heading xsj_heading_h4\" id=\"e5b182e58e8be7bca9_5\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e5b182e58e8be7bca9_5\" class=\"blank_anchor_name\"></a><a id=\"e5b182e58e8be7bca9_5\" class=\"blank_anchor_id\"></a><a name=\"层压缩\" class=\"blank_anchor_name\"></a><a id=\"层压缩\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">层压缩</span></h4>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">基本上常见的一些合成层的提升原因如上所说，你会发现，由于重叠的原因，可能随随便便就会产生出大量合成层来，而每个合成层都要消耗 CPU 和内存资源，岂不是严重影响页面性能。这一点浏览器也考虑到了，因此就有了层压缩（Layer Squashing）的处理。如果多个渲染层同一个合成层重叠时，这些渲染层会被压缩到一个 GraphicsLayer 中，以防止由于重叠原因导致可能出现的“层爆炸”。具体可以看如下 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squash-hover.html\" class=\"xsj_link xsj_manu_link\">demo</a>。一开始，蓝色方块由于<br>\n<code>translateZ</code> 提升为了合成层，其他的方块元素因为重叠的原因，被压缩了一起，大小就是包含这 3 个方块的矩形大小。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 53.90625%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='215'%3e%3cpath%20d='M16%2040v26h43V56h10V13H16v27m244-9h12v10c0%2010%200%2010-2%2010s-3%201-3%203%200%202-9%202h-10V43l-1-12v26h20v61h67V51h-61V30h-25l12%201m13%2024c0%202%200%202-2%202h-3v60h65V52h-60v3m-173%2051l1%2026v19h42v-11h10V98h-53v8'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/85ff6840898713fed056a28e3e6d209e/37523/1603721617747.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617747.png\" data-src=\"./images/1603721617747.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/85ff6840898713fed056a28e3e6d209e/6f3f2/1603721617747.png 256w,\n/acorns/static/85ff6840898713fed056a28e3e6d209e/01e7c/1603721617747.png 512w,\n/acorns/static/85ff6840898713fed056a28e3e6d209e/37523/1603721617747.png 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">当我们 hover 绿色方块时，会给其设置 <code>translateZ</code> 属性，导致绿色方块也被提升为合成层，则剩下的两个被压缩到了一起，大小就缩小为包含这 2 个方块的矩形大小。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 53.90625%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='215'%3e%3cpath%20d='M16%2040v26h43V56h10V13H16v27m230%204v13h24l3-1h-3c-2%200-3%200-3-2%201-2%204-2%205%200l1%203v-3c0-2%200-2%209-2l10%201v9c0%209-1%2010-3%2010-1%200-2%201-2%203v2h-19v-9l-1-9-1%209%201%2010h20v20l1%2021V98c0-20%200-20%202-20l3-1h-3l-2-2c0-3%204-3%204%200l1%203v-3c0-2%200-2%2020-2l21-1h-41V52l-10-1h-10V41l-1-9v19h-3c-2%200-3%201-3%203s-1%202-10%202h-9V32h13l13-1h-27v13m-146%2062l1%2026v19h42v-11h10V98h-53v8'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/1faeae60b56583b9c6694aafd7f34004/37523/1603721617751.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617751.png\" data-src=\"./images/1603721617751.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/1faeae60b56583b9c6694aafd7f34004/6f3f2/1603721617751.png 256w,\n/acorns/static/1faeae60b56583b9c6694aafd7f34004/01e7c/1603721617751.png 512w,\n/acorns/static/1faeae60b56583b9c6694aafd7f34004/37523/1603721617751.png 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">当然，浏览器的自动的层压缩也不是万能的，有很多特定情况下，浏览器是无法进行层压缩的，如下所示，而这些情况也是我们应该尽量避免的。（注：以下情况都是基于重叠原因而言）</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>无法进行会打破渲染顺序的压缩（squashingWouldBreakPaintOrder）<br>\n示例如下：<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squashingWouldBreakPaintOrder-mask.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-html hljs xml code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">style</span>&gt;</span><span class=\"css\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-id\">#ancestor</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">-webkit-mask-image</span>: <span class=\"hljs-built_in\">-webkit-linear-gradient</span>(rgba(0,0,0,1), <span class=\"hljs-built_in\">rgba</span>(0,0,0,0));</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span><span class=\"hljs-tag\">  </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-id\">#composited</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">100%</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">100%</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">transform</span>: <span class=\"hljs-built_in\">translateZ</span>(0);</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-id\">#container</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">position</span>: relative;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">400px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">60px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">border</span>: <span class=\"hljs-number\">1px</span> solid black;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"18\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">18</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"19\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">19</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-id\">#overlap-child</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"20\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">20</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">position</span>: absolute;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"21\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">21</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">left</span>: <span class=\"hljs-number\">0</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"22\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">22</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">top</span>: <span class=\"hljs-number\">0</span> ;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"23\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">23</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">bottom</span>: <span class=\"hljs-number\">0px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"24\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">24</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">100%</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"25\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">25</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">60px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"26\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">26</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: orange;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"27\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">27</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"28\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">28</span><span class=\"hljs-tag\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">style</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"29\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">29</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"30\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">30</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"container\"</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"31\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">31</span>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"composited\"</span>&gt;</span>Text behind the orange box.<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"32\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">32</span>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"ancestor\"</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"33\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">33</span>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"overlap-child\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"34\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">34</span>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"35\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">35</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>在本例中，<code>#overlap-child</code> 同合成层重叠，如果进行压缩，会导致渲染顺序的改变，其父元素 <code>#ancestor</code> 的 mask 属性将失效，因此类似这种情况下，是无法进行层压缩的。目前常见的产生这种原因的情况有两种，一种是上述的祖先元素使用 mask 属性的情况，另一种是祖先元素使用 filter 属性的情况（<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squashingWouldBreakPaintOrder-filter.html\" class=\"xsj_link xsj_manu_link\">demo</a>）。</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>video 元素的渲染层无法被压缩同时也无法将别的渲染层压缩到 video 所在的合成层上（squashingVideoIsDisallowed）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/video.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>iframe、plugin 的渲染层无法被压缩同时也无法将别的渲染层压缩到其所在的合成层上（squashingLayoutPartIsDisallowed）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/layoutpart.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>无法压缩有 reflection 属性的渲染层（squashingReflectionDisallowed）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/reflection.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>无法压缩有 blend mode 属性的渲染层（squashingBlendingDisallowed）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/blend-mode.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当渲染层同合成层有不同的裁剪容器（clipping container）时，该渲染层无法压缩（squashingClippingContainerMismatch）。<br>\n示例如下：<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squashingClippingContainerMismatch.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-html hljs xml code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">style</span>&gt;</span><span class=\"css\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-class\">.clipping-container</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">overflow</span>: hidden;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">10px</span>; </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: blue;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-class\">.composited</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">transform</span>: <span class=\"hljs-built_in\">translateZ</span>(0); </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">10px</span>; </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: red;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-class\">.target</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"18\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">18</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">position</span>:absolute; </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"19\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">19</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">top</span>: <span class=\"hljs-number\">0px</span>; </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"20\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">20</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>:<span class=\"hljs-number\">100px</span>; </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"21\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">21</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>:<span class=\"hljs-number\">100px</span>; </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"22\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">22</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: green;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"23\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">23</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">color</span>: <span class=\"hljs-number\">#fff</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"24\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">24</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"25\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">25</span><span class=\"hljs-tag\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">style</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"26\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">26</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"27\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">27</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"clipping-container\"</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"28\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">28</span>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"composited\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"29\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">29</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"30\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">30</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"target\"</span>&gt;</span>不会被压缩到 composited div 上<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>本例中 <code>.target</code> 同 合成层 <code>.composited</code> 重叠，但是由于 <code>.composited</code> 在一个 <code>overflow: hidden</code> 的容器中，导致 <code>.target</code> 和合成层有不同的裁剪容器，从而 <code>.target</code> 无法被压缩。</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>相对于合成层滚动的渲染层无法被压缩（scrollsWithRespectToSquashingLayer）<br>\n示例如下：<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/scrollsWithRespectToSquashingLayer.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-html hljs xml code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">style</span>&gt;</span><span class=\"css\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-tag\">body</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">1500px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">overflow-x</span>: hidden;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-class\">.composited</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">50px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">50px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: red;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">position</span>: absolute;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">left</span>: <span class=\"hljs-number\">50px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">top</span>: <span class=\"hljs-number\">400px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">transform</span>: <span class=\"hljs-built_in\">translateZ</span>(0);</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"18\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">18</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-class\">.overlap</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"19\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">19</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">200px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"20\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">20</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">200px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"21\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">21</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: green;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"22\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">22</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">position</span>: fixed;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"23\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">23</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">left</span>: <span class=\"hljs-number\">0px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"24\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">24</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">top</span>: <span class=\"hljs-number\">0px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"25\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">25</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"26\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">26</span><span class=\"hljs-tag\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">style</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"27\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">27</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"28\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">28</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"composited\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"29\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">29</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"overlap\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>本例中，红色的 <code>.composited</code> 提升为了合成层，绿色的 <code>.overlap</code> fix 在页面顶部，一开始只有 <code>.composited</code> 合成层。<br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:640px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 70.3125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='281'%3e%3cpath%20d='M0%2058v58h115V0H0v58M170%202h-50v8h101V6l-1-4h-50M28%20246l1%2015h28v-29H28v14'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/3a71224199c7adc9daa91362a2772ef1/c08c5/1603721617752.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617752.jpg\" data-src=\"./images/1603721617752.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/3a71224199c7adc9daa91362a2772ef1/e4a55/1603721617752.jpg 256w,\n/acorns/static/3a71224199c7adc9daa91362a2772ef1/36dd4/1603721617752.jpg 512w,\n/acorns/static/3a71224199c7adc9daa91362a2772ef1/c08c5/1603721617752.jpg 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span><br>\n当滑动页面，<code>.overlap</code> 重叠到 <code>.composited</code> 上时，<code>.overlap</code> 会因重叠原因提升为合成层，同时，因为相对于合成层滚动，因此无法被压缩。<br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:640px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 70.3125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='281'%3e%3cpath%20d='M0%2058v58h27c1%200%202%203%202%207v6h29v-13h57l1-58V0H0v58M123%205v5h101V1H123v4m133%2069v28l3%201c3%200%204%200%204%202%201%202%206%203%206%201l-2-1-3-1c0-2%206-1%206%201s0%202%201%200%202-2%208-2h7V73h-15l-15%201m1%2014v14h3c2%200%203%200%203-2s1-2%204-2%204%200%204%202%201%202%207%202h7V74h-28v14'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/84a9ee3058f6910a921be0a607d09986/c08c5/1603721617753.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617753.jpg\" data-src=\"./images/1603721617753.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/84a9ee3058f6910a921be0a607d09986/e4a55/1603721617753.jpg 256w,\n/acorns/static/84a9ee3058f6910a921be0a607d09986/36dd4/1603721617753.jpg 512w,\n/acorns/static/84a9ee3058f6910a921be0a607d09986/c08c5/1603721617753.jpg 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当渲染层同合成层有不同的具有 opacity 的祖先层（一个设置了 opacity 且小于 1，一个没有设置 opacity，也算是不同）时，该渲染层无法压缩（squashingOpacityAncestorMismatch，同 squashingClippingContainerMismatch）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squashingOpacityAncestorMismatch.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当渲染层同合成层有不同的具有 transform 的祖先层时，该渲染层无法压缩（squashingTransformAncestorMismatch，同上） <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squashingTransformAncestorMismatch.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当渲染层同合成层有不同的具有 filter 的祖先层时，该渲染层无法压缩（squashingFilterAncestorMismatch，同上）<a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/squashingFilterAncestorMismatch.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当覆盖的合成层正在运行动画时，该渲染层无法压缩（squashingLayerIsAnimating），当动画未开始或者运行完毕以后，该渲染层才可以被压缩 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/squash/animating.html\" class=\"xsj_link xsj_manu_link\">demo</a><br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:960px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 40.625%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='163'%3e%3cpath%20d='M9%2011c-6%206-6%208-1%2014%203%203%205%205%205%207l1%204h19V16h-3l-8-5c-7-6-8-6-13%200m214%207l1%2010h3c4%200%204%200%204%204v4h20V16h-8V8h-20v10m48-5l-7%201c-7%200-8%200-8%202s1%202%2022%202c20%200%2021%200%2021-2s-1-2-13-2l-14-1h-1M37%2015c-1%203%202%203%2022%203%2019%200%2021-1%2021-2%200-2-1-2-21-2l-22%201m47%20137h-1l-2%201H62c-1%203%200%203%205%203l5-1h1l7%201h1c2%201%209%201%2010-1%201-1%201-1%201%201%201%201%201%201%201-1s-1-2-4-2l-4-1h-1m191%202v2l29-1c1-1%201-1%201%201%201%201%201%201%201-1s-1-2-6-2l-6%201-1-1c0-2-2-1-2%201h-1c-1-2-15-2-15%200'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/923418ecbdb842c9ed0fabe10fbf97fd/6a068/1603721617754.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617754.jpg\" data-src=\"./images/1603721617754.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/923418ecbdb842c9ed0fabe10fbf97fd/e4a55/1603721617754.jpg 256w,\n/acorns/static/923418ecbdb842c9ed0fabe10fbf97fd/36dd4/1603721617754.jpg 512w,\n/acorns/static/923418ecbdb842c9ed0fabe10fbf97fd/6a068/1603721617754.jpg 960w\" sizes=\"(max-width: 960px) 100vw, 960px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span></p>\n</li>\n</ul>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e5a682e4bd95e69fa5e79c8be59088e68890e5b182_6\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e5a682e4bd95e69fa5e79c8be59088e68890e5b182_6\" class=\"blank_anchor_name\"></a><a id=\"e5a682e4bd95e69fa5e79c8be59088e68890e5b182_6\" class=\"blank_anchor_id\"></a><a name=\"如何查看合成层\" class=\"blank_anchor_name\"></a><a id=\"如何查看合成层\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">如何查看合成层</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">使用 Chrome DevTools 工具来查看页面中合成层的情况。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">比较简单的方法是打开 DevTools，勾选上 <code>Show layer borders</code></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:276px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 59.375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='238'%3e%3cpath%20d='M144%20160l-2%204c0%202%203%205%205%205h1l-2%201-3%201c0%202%207%201%207-1%204-8-1-16-6-10'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/472127e6fd1cf4c368e5473d9651e97e/f2d11/1603721617755.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617755.png\" data-src=\"./images/1603721617755.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/472127e6fd1cf4c368e5473d9651e97e/6f3f2/1603721617755.png 256w,\n/acorns/static/472127e6fd1cf4c368e5473d9651e97e/f2d11/1603721617755.png 276w\" sizes=\"(max-width: 276px) 100vw, 276px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">其中，页面上的合成层会用黄色边框框出来。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:593px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 101.171875%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='405'%3e%3cpath%20d='M12%2065v43h8v22l1%2022v-44h202V21H12v44m168-13l-1%203-1%203c-1%200-2%203-1%204%202%201%203%201%203-1%201-2%204-3%206-1%201%201%202%202%201%203-1%202-1%204%202%204l1-3%202-2c2-3%202-6%200-6l-2-1c0-1-1-1-3%201l-2%202v-2c1-4-3-7-5-4M48%2078v25h4a188%20188%200%200037-1l-1-2-1%201-19%201H49V54h38v6l1%205%201-6v-6H48v25m81-23c-4%202-2%209%203%2011%202%200%203%200%205-2%203-4%203-7-1-9h-7m20%203l-1%205c0%205-1%206-3%204h-1l1%202c2%201%201%202-1%202-3-1-4%201-2%203%201%201%202%202%201%204l1%2010v17c0%202%201%202%203%202%203%200%203-1%203-5s0-4%203-3h3v-6l1-6%202%202%201%202%201-4c0-3-3-7-4-6l-2-3%204%201c3%202%203%202%203%200h-1l-1-1-1-2-1%201h-2l-4-1-2%201c-1%203-1%203%201%206%203%204%204%2010%201%2013-4%203-6-2-5-17%200-8%200-10%202-8h2c2-3%203-2%205%200%201%202%202%203%203%202s0-2-4-8l-5-8-1%201m-36%208v7c1%201%200%203-1%204-2%203-3%2021-1%2021l2-2c0-2%202-3%203-4%202%200%202-1%202-5-1-5%200-4%201%202l2%203c2-1%206%201%207%203%200%202%201%203%202%203l1%205v4h5c6%200%206%200%205-5%200-3-1-4-4-6-3-1-5-3-3-3s3-3%202-5l-1-7%201-4h-4l-5-1c-1-1%201-1%205-1h7l-8-1c-8%200-8%200-8-2s0-2-1%200c-3%206-6%205-6-3-1-6-2-7-3-3m49-2c-2%200-2%201%203%208l6%206h2c0%202%203%203%203%201l1-2c1%200%202%202%202%205s2%202%203-1c1-9-2-14-8-14l-7-2-5-1m-47%2032c-1%201%200%202%201%203%203%202%202%203-1%201-2-1-4%201-3%203%200%202%201%202%203%202h1c-1%202-1%202%201%202l3-1h1c0%202%204%201%206-1%203-2%202-6-1-5-2%200-2%200-1-2%202-1%202-2%201-3-2-2-5-1-5%202v3l-1-3c-1-3-4-4-5-1m-79%2020c-5%202-8%206-7%2012%200%204%201%207%203%207l1%201c2%205%2017%205%2017-1l1-1c1%201%203-2%203-7%200-9-10-16-18-11m52-1c-7%203-10%2011-7%2017%204%2010%2017%2011%2022%202%206-10-5-24-15-19m103%200c-10%203-13%2015-5%2021%209%208%2020%203%2020-9%200-6-2-9-8-12h-7m-54%202c-9%204-7%2018%202%2022%2013%205%2023-14%2011-22-3-2-10-2-13%200m3%205c-3%203-2%206%201%209l3%203%202-3c3-3%204-7%201-9-2-3-5-2-7%200M36%20158c-11%205-9%2022%203%2025%207%201%2015-5%2015-12%200-10-9-16-18-13m51%201c-7%203-9%2012-6%2018%202%202%202%202%203%201%202-3%203-2%203%201v4l1-3c1-9%208-9%208-1l1%203v-3l1-3%202%202c0%202%203-1%204-5%203-9-8-19-17-14m104-1c-16%205-9%2028%206%2024%2011-3%2012-21%202-24h-8m-52%201c-5%202-9%209-7%2014%204%2014%2023%2011%2023-3%200-9-8-14-16-11m1%203c-2%201-5%205-4%206%200%202%201%201%203-1%202-6%2010-3%2010%203%200%203%200%203-1%200%200-3-1-4-5-4-3%200-4%201-4%203a1666%201666%200%2001-1%203c-1-2-2-2-2-1-2%202%204%207%208%207s8-5%208-9c-2-6-7-9-12-7m-104%202v7l1%206h9v-13l-5-1-5%201m-16%2044c-2%203-2%204%202%204l11%201h11l1-1h3l1-1c1-6%201-6-2-6-2%200-3%201-3%202l-2%202v-2c0-2%200-2-3-1h-3l-8-1c-7%200-7%200-8%203m34%2018h42v101h-3c-3%201-3%201%200%201h4V226h63c35%200%2016-1-42-1l-64%201m133%204l-1%202c0%202%200%202-1%201-2-1-4%200-3%201l4%203c3%201%203%201%203%205v4c2%201%201%202-1%203-3%201-4%205-2%208v3c-2%203%200%204%206%204h4v-16l1-6%203-2%203-2c2-2%203-8%201-9l-1%202c0%201%200%202-2%201l-1%201c1%201%200%202-1%202-1%201-1%201-1-2v-2l-1%202-2%203c-2%201-2%201-2-1%201-2%200-3-1-3v2l-1%201-1-1v-1l-1%201c-1%201-1%200-1-1%201-3%200-5-1-3M19%20261v6h13v-12H19v6m17%200v6h12v-12H36v6m17%200v6h12v-12H53v6m14%2010l-5%205c-2%202-2%202-5%201-7-2-10-2-12%200-1%201-1%201%201%203l7%201%204%201-5%201c-11-1-29%206-30%2011%200%202%205%204%2011%204s3%201-4%201h-6c-1-1-1-1-1%201l-2%202-2%204c-2%208%207%2016%2020%2016%203%200%209-4%209-6h-1c-4%203-7%203-11%201-6-3-3-4%203-2%205%201%208%200%205-2-1-1-1-1%201-1h2l-2-2h2c12%202%2036-3%2036-7h-3l-1-3c-3-2-2-3%200-4%202%200%202%200%201-2v-1l2-1v-2c2%200%203-8%202-12-2-6-10-9-16-7m128%2025l2%206v3h-5c-5%200-5%200-5-3v-3l-1%203c-1%203-2%203-5%203-4%200-4%201-4%2013v8h14c19%200%2018%200%2015-17v-3l-3-1c-3%200-4%200-4-4-1-4-3-8-5-8l1%203m-73%202l-6%2018c1%202%203%201%204-2v7c-1%203%204%204%2011%203l6-1-1-3c0-3%200-4%202-4s1-2-2-11l-2-7-5-1-7%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/33db7008744a3b47b299727ba2fc5b12/0b5b1/1603721617756.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617756.png\" data-src=\"./images/1603721617756.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/33db7008744a3b47b299727ba2fc5b12/6f3f2/1603721617756.png 256w,\n/acorns/static/33db7008744a3b47b299727ba2fc5b12/01e7c/1603721617756.png 512w,\n/acorns/static/33db7008744a3b47b299727ba2fc5b12/0b5b1/1603721617756.png 593w\" sizes=\"(max-width: 593px) 100vw, 593px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">当然，更加详细的信息可以通过 Timeline 来查看。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">每一个单独的帧，看到每个帧的渲染细节：</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:325px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 60.15625%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='240'%3e%3cpath%20d='M28%206v6l2-3%201-1%201%205v5h7l8-1c1-1%200-4-2-4l-1-4c-1-5-5-6-7-2l-1%203-1-2c-2-3-5-4-7-2M0%2052v12l11-1h11l-1-4-1-14c0-2-2-1-2%203-1%203-4%204-5%200%200-7-1-8-7-8H0v12m34-10l-2%2010c-1%206-1%209-3%2010-1%201-1%201%203%201h157l-2-2c-1-2-3-3-3-2%200%202-6-2-6-5l-1-2-1%202c0%202%200%203-3%202l-5-2c-2-2-4-1-5%201-2%204-5%202-6-3s-2-6-3%200c-1%204-2%207-4%206l-1-13v-3l-3%203-3%206-4%201c-3%200-3%200-4-7l-5-5-1%202-1%202-2-2c-2-2-3-2-17-2a333%20333%200%2000-22%201l-26-1c-25%200-27%200-27%202m2%2041l164%201a23635%2023635%200%2000-164-1m-19%2019l3%204c3%203%204%205%203%205v3c2%202%200%203-8%203H0v14h167l-1%208v8h14v-15h-7v7l-1%207v-7c0-6%200-7-2-7l114-1h117v-14h-21v-16H199l-182%201m9%207v6l95-1c96%200%20102%200%2092-1-5%200-6-1-6-4v-3h5l5-1h1l3%201%202%201-1%201v1c2%201%201%203-1%204l-2%201a5075%205075%200%2000158-2c2%200%201-3-2-6l-3-3H115v5l-1%205-1-5%201-5H26v6m155-4c-1%201%200%201%201%201%202%200%202%200%200%201l-2%201%202%201c2%201%202%201%200%202-3%200-2%202%202%202%202%200%203%200%203-2h2c1%202%203%202%209%202l7-1v-5c-1-4-6-4-7%201-1%203-4%204-4%201v-3c-1-2-5-2-6%200%200%203-2%203-1%200%200-2%200-2-3-2l-3%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/1392b4ee143264c5029e4f79e0bd921a/c989d/1603721617757.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617757.jpg\" data-src=\"./images/1603721617757.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/1392b4ee143264c5029e4f79e0bd921a/e4a55/1603721617757.jpg 256w,\n/acorns/static/1392b4ee143264c5029e4f79e0bd921a/c989d/1603721617757.jpg 325w\" sizes=\"(max-width: 325px) 100vw, 325px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">点击之后，你就会在视图中看到一个新的选项卡：Layers。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:333px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 78.125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='312'%3e%3cpath%20d='M0%20156v156h401V0H0v156m194-66a59%2059%200%2000-52%2065c0-2%201-3%202-3v1l-1%204-1%202c-1%201%203%2013%205%2017l3%202c2%200%203%200%203%204%201%205%201%206%207%2012%2032%2029%2083%2016%2098-26%204-10%203-29-1-39a61%2061%200%2000-63-39'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/b619c78ae7d4f94cc6c14d0e12885b50/77c11/1603721617758.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617758.jpg\" data-src=\"./images/1603721617758.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/b619c78ae7d4f94cc6c14d0e12885b50/e4a55/1603721617758.jpg 256w,\n/acorns/static/b619c78ae7d4f94cc6c14d0e12885b50/77c11/1603721617758.jpg 333w\" sizes=\"(max-width: 333px) 100vw, 333px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">点击这个 Layers 选项卡，你会看到一个新的视图。在这个视图中，你可以对这一帧中的所有合成层进行扫描、缩放等操作，同时还能看到每个渲染层被创建的原因。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 52.34375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='210'%3e%3cpath%20d='M6%2029a382%20382%200%20001%2029l-1%208v7h14l-1-12c0-12%200-12%202-12%204%200%207-1%207-3l2-2%202-1c0-2%202-2%206-2%206%200%206%200%205%202-1%204%203%2012%206%2010h2l-2%201v1l1%202%201%201v1c-1%201-1%201%201%201l2%201v1l1%202%202%204v2c-3%200-2%203%200%203%2010%201%2010%201%2013-2l4-3%201-1-4-1-4-1h-4v3c-2%201-2%201-2-1l-1-3c-2%200-3-3-2-4l-1-1c-1%200-2-1-1-3l-1-5c-2%200-1-2%200-1%202%200%204-2%202-3h-7l1-1%203-2c2-3%202-3%2018-3%208%200%2015%200%2014%201-3%200-5%202-4%203l-1%201v4l-1%206v4l1%208-1%205h15c17%200%2016%201%2016-12%200-10-1-13-2-9-1%202-1%202-1-1l-1-3v3l-1%203-1-4c0-3%200-3%203-3l3%201V19H6v10m277-1v2c-1%202-36%202-36%200h-10l-60%202c-49%200-60%201-60%202l19%201c17%200%2018%200%2018%202%200%201%200%202%206%202%205%200%205-1%205-2%200-2%201-2%202-2%202%200%203%201%203%202%200%202%201%202%205%202%203%200%204%200%205-2%201-3%2052-3%2053%200s7%203%206%200a351%20351%200%200183-1l4-1%203-1c0-2-3-2-22-2h-23v-2l-1-2M19%2077c-4%201-5%208-2%2011%205%204%2013-3%209-9l-5-3-2%201m23%201c-2%201-3%207%200%209%203%204%2010%201%2010-4s-6-8-10-5m25%201c-3%203-2%206%200%208%204%204%2010%201%2010-4%200-6-7-8-10-4m25%200c-5%206%203%2014%208%208%202-2%203-7%201-9s-8-1-9%201m25%207c0%202%200%202%2020%202%2035%200%2036%200%2036-2s-1-2-28-2-28%200-28%202M17%20100c-4%204-1%2010%204%2010s8-7%204-10c-2-3-6-2-8%200m75%200c-3%203-2%206%200%208%204%204%2010%201%2010-4%200-6-7-8-10-4m133%2025c0%2014%201%2014%201%201%201-12%200-11%205-11%207-1%208-1%208%207l1%207v-15h51l-33-1h-33v12m20%2014v3l-9-1-9%201c0%201%2012%202%2039%201h20v-4c0-3%200-3-1-1%200%203-3%204-26%203h-13v-3c-1-2-1-2-1%201m-24%208l-1%202-1%201%2011%201h11v6l1%206%201-7v-5h20c19%200%2020%200%2019-2l-30-1c-29%201-29%201-30-1l-1-2v2m-188%207l-5%202h-3v5l-1%206c-1%201-2-9-2-11%201-2%200-3-3%200l-1%2011-1%2011c-1%201%201%201%204%201l6-1%204-1%204%201v-7c0-4%200-6%202-6%201%200%205-4%205-6%200-4-6-7-9-5m64%2013c1%203%201%203-4%203h-5v5c-1%206-1%206%208%206%205%200%207-1%207-2l-2-9-3-3-1-2v2m171%208l-2%205%201%202h-25a327%20327%200%20004%201l1%2010%201%2011v-21h18a158%20158%200%200017-1c-1%200-2-1-2-3l-1-2v2c0%202%200%203-2%203s-3%200-2-3l-1-4-2-2h-1c0%202-2%203-2%201%200-1-1-1-2%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/6dd94635d18cf2389a95e1ecbf53154d/80e3c/1603721617761.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617761.jpg\" data-src=\"./images/1603721617761.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/6dd94635d18cf2389a95e1ecbf53154d/e4a55/1603721617761.jpg 256w,\n/acorns/static/6dd94635d18cf2389a95e1ecbf53154d/36dd4/1603721617761.jpg 512w,\n/acorns/static/6dd94635d18cf2389a95e1ecbf53154d/80e3c/1603721617761.jpg 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">有了这个视图，你就能知道页面中到底有多少个合成层。如果你在对页面滚动或渐变效果的性能分析中发现 Composite 过程耗费了太多时间，那么你可以从这个视图里看到页面中有多少个渲染层，它们为何被创建，从而对合成层的数量进行优化。</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e680a7e883bde4bc98e58c96_7\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e680a7e883bde4bc98e58c96_7\" class=\"blank_anchor_name\"></a><a id=\"e680a7e883bde4bc98e58c96_7\" class=\"blank_anchor_id\"></a><a name=\"性能优化\" class=\"blank_anchor_name\"></a><a id=\"性能优化\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">性能优化</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">提升为合成层简单说来有以下几点好处：</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>合成层的位图，会交由 GPU 合成，比 CPU 处理要快</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当需要 repaint 时，只需要 repaint 本身，不会影响到其他的层</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>对于 transform 和 opacity 效果，不会触发 layout 和 paint</p>\n</li>\n</ul>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">利用合成层对于提升页面性能方面有很大的作用，因此我们也总结了一下几点优化建议。</p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e68f90e58d87e58aa8e794bbe69588e69e9ce79a84e58583e7b4a0_8\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e68f90e58d87e58aa8e794bbe69588e69e9ce79a84e58583e7b4a0_8\" class=\"blank_anchor_name\"></a><a id=\"e68f90e58d87e58aa8e794bbe69588e69e9ce79a84e58583e7b4a0_8\" class=\"blank_anchor_id\"></a><a name=\"提升动画效果的元素\" class=\"blank_anchor_name\"></a><a id=\"提升动画效果的元素\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">提升动画效果的元素</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">合成层的好处是不会影响到其他元素的绘制，因此，为了减少动画元素对其他元素的影响，从而减少 paint，我们需要把动画效果中的元素提升为合成层。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">提升合成层的最好方式是使用 CSS 的 will-change 属性。从上一节合成层产生原因中，可以知道 will-change 设置为 opacity、transform、top、left、bottom、right 可以将元素提升为合成层。</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-css hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-selector-id\">#target</span> {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>  <span class=\"hljs-attribute\">will-change</span>: transform;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">其兼容如下所示：</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 22.65625%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='91'%3e%3cpath%20d='M1%2029a92%2092%200%2001-1%2022v6h42l-1%205v5h37v-9H60l160-1h178V45h-41V12h-38v17l1%2016h-43V35h-37v10H78V35H41v5l-1%205-1-16V12H1v17m119-15l1%206v4h37V12h-19c-17%200-19%200-19%202m1%2016v4h37v-9h-37v5M81%2040v4h37v-9H81v5m40%200v4h37v-9h-37v5M81%2063v4h37v-9H81v5m40%200v4h36v-9h-36v5m40%200v4h36v-9h-36v5m40%200v4h36v-9h-36v5m39%200v4h37v-9h-37v5M81%2073v4h37v-9H81v5m40%200v4h36v-9h-36v5m80%200v4h36v-9h-36v5m-80%2010v4h36v-8h-36v4m-40%200v4h37v-8H81v4'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/80df96b4e2f947b57777f96d0d0bcb01/37523/1603721617759.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617759.png\" data-src=\"./images/1603721617759.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/80df96b4e2f947b57777f96d0d0bcb01/6f3f2/1603721617759.png 256w,\n/acorns/static/80df96b4e2f947b57777f96d0d0bcb01/01e7c/1603721617759.png 512w,\n/acorns/static/80df96b4e2f947b57777f96d0d0bcb01/37523/1603721617759.png 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">对于那些目前还不支持 will-change 属性的浏览器，目前常用的是使用一个 3D transform 属性来强制提升为合成层：</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-css hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-selector-id\">#target</span> {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>  <span class=\"hljs-attribute\">transform</span>: <span class=\"hljs-built_in\">translateZ</span>(0);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">但需要注意的是，不要创建太多的渲染层。因为每创建一个新的渲染层，就意味着新的内存分配和更复杂的层的管理。之后我们会详细讨论。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">如果你已经把一个元素放到一个新的合成层里，那么可以使用 Timeline 来确认这么做是否真的改进了渲染性能。别盲目提升合成层，一定要分析其实际性能表现。</p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e4bdbfe794a820transform20e68896e8808520opacity20e69da5e5ae9ee78eb0e58aa8e794bbe69588e69e9c_9\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e4bdbfe794a820transform20e68896e8808520opacity20e69da5e5ae9ee78eb0e58aa8e794bbe69588e69e9c_9\" class=\"blank_anchor_name\"></a><a id=\"e4bdbfe794a820transform20e68896e8808520opacity20e69da5e5ae9ee78eb0e58aa8e794bbe69588e69e9c_9\" class=\"blank_anchor_id\"></a><a name=\"使用-transform-或者-opacity-来实现动画效果\" class=\"blank_anchor_name\"></a><a id=\"使用-transform-或者-opacity-来实现动画效果\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">使用 transform 或者 opacity 来实现动画效果</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">文章最开始，我们讲到了页面呈现出来所经历的渲染流水线，其实从性能方面考虑，最理想的渲染流水线是没有布局和绘制环节的，只需要做合成层的合并即可：</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 15.234375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='61'%3e%3cpath%20d='M11%2012a3913%203913%200%20010%2037l44%201h44l4-9c6-11%206-10%201-21-4-8-5-9-8-9a889%20889%200%2000-85%201m92-1l4%2010%204%209-4%209-4%2010c0%201%2025%202%2059%201l10-20-5-10-4-10h-30l-30%201m194%200l4%208c6%2012%206%2012-3%2028l-1%203h93V10h-46l-47%201M52%2026v2c1%203%200%203-1%201-2-3-8-3-9-1-1%201-1%201-1-1%200-1%200-2-1-1h-4c-3%201-4%201-4%204%200%204%200%204%203%204s3%200%203-3v-2l1%202c1%204%204%204%204%200l2-3v4c0%202%203%202%2012%202%2012%200%2012%200%2012-3l1-2c1-1%201%200%201%202l1%203%201-5-1-5v1c0%201-3%202-8%201l-4%201c-1%202-5%201-5%200h2c2%200%203-2%200-2-2-1-4-1-5%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/be5379640eeaf1ace09616756b90aa1c/80e3c/1603721617760.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617760.jpg\" data-src=\"./images/1603721617760.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/be5379640eeaf1ace09616756b90aa1c/e4a55/1603721617760.jpg 256w,\n/acorns/static/be5379640eeaf1ace09616756b90aa1c/36dd4/1603721617760.jpg 512w,\n/acorns/static/be5379640eeaf1ace09616756b90aa1c/80e3c/1603721617760.jpg 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">为了实现上述效果，就需要只使用那些仅触发 Composite 的属性。目前，只有两个属性是满足这个条件的：transforms 和 opacity。更详细的信息可以查看 <a href=\"http://csstriggers.com/\" class=\"xsj_link xsj_manu_link\">CSS Triggers</a>。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">注意：元素提升为合成层后，transform 和 opacity 才不会触发 paint，如果不是合成层，则其依然会触发 paint。具体见如下两个 demo。</p>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/paint/promote-element/no-promote-transform.html\" class=\"xsj_link xsj_manu_link\">demo 1：transform</a><br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:640px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 57.8125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='231'%3e%3cpath%20d='M61%2010v3c1%202%200%202-30%202H0v7h24l25%201H0v6h97v-6H73c-17%200-11-1%2016-1h41v7h36v-3c0-4%200-4%203-4s3%200%203%204v3h30v-7h15v7h22v-7h23v7h42V15H184C67%2015%2065%2015%2066%2013s0-5-2-5l-3%202M0%2033v3h32l31%201v3l1%203h27v-6H77l-13-1h29v-6H0v3m224%201l-2%201-12%2012-12%2011H0v7h304v-7H201l11-10%2012-9%204-5h-4M80%20171v3h29l28-1-1-1v-4l-2%202-1%202-1-2-1-2c-1%200-2%200-2%202l-1%202-1-3-1-2v3c0%203-2%202-3-1-1-2-1-2-1%200s-1%203-2%203l-1-3v-2l-1%203-1%202-1-2c0-1-1-2-3-2-3%200-4%201-4%202l-1%202-2-1%201-1%201-2-2-1-1%203c0%202%200%202-3%202s-3%200-3-2c1-1%200-2-1-2-1-1-1%200-1%202s0%202-1%200c0-2-2-3-4%200-1%201-1%201-1-1l-1-2v2l-1%202h-1c0-3-2-4-3-2h-1l-2-2c-2%200-2%201-2%204M4%20184v3h7c7%200%208%200%208-2h1c0%202%209%202%2010%201h1l1%201v-4h-7l-1-1h-7l-5%201h-1c-1-1-2-1-3%201-2%202-3%202-2%200l-1-2c-1-1-1%200-1%202m0%2011c0%203%202%204%204%202h1c0%201%203%201%204-1%201-1%201-1%201%201v2l1-2%201-1c0%202%205%202%205%201h2c0-2%200-2%201-1h3c0%202%2010%202%2011%200h1c0%203%205%202%205-1%200-2-1-3-3%200h-1c0-2-1-2-4-2h-4c0-2-2-1-2%201s0%202-1%201c0-1-2-2-9-2h-9l-3-1c-4%200-4%200-4%203m73%209l-1%203v3h36v-3c-1-4-3-5-3-1%200%202%200%202-1%200%200-2-1-2-12-2H77'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/d5f62f6e2a9d49ba33237ab42fa0eb10/6af66/1603721617762.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617762.png\" data-src=\"./images/1603721617762.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/d5f62f6e2a9d49ba33237ab42fa0eb10/6f3f2/1603721617762.png 256w,\n/acorns/static/d5f62f6e2a9d49ba33237ab42fa0eb10/01e7c/1603721617762.png 512w,\n/acorns/static/d5f62f6e2a9d49ba33237ab42fa0eb10/6af66/1603721617762.png 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/paint/promote-element/no-promote-opacity.html\" class=\"xsj_link xsj_manu_link\">demo 2：opacity</a><br>\n<span class=\"story_inline_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:640px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 59.375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='238'%3e%3cpath%20d='M1%2014l-1%207v6h4c4%200%204%200%204-3s0-4%202-4c1%200%202%201%202%203v4h29v-3c0-4%200-4%203-4s3%200%203%204v3h36v-7h31v7h37v-7h28v7h108v-7h18v-7H153L1%2014m127%2017l-2%203-7%2012-7%2010H56L1%2057v6h298v4c0%203%200%203%203%203h3V56H114l7-10%208-10c1%200%202-1%202-3v-3l-3%201M83%20167l-1%204-1%202h29c16%200%2028%200%2027-1v-4l-2%202c0%201%200%202-2%201v-3c0-1-1-1-2%201l-2%202v-2l-1-3v3l-1%203-2-3-1-2-1%201-1%204-1-2v-3l-2%202-1%203v-2c0-2%200-2-2-2h-4l-1%202-2%202c-2%200-2%200%200-2v-3c-1-2-3%200-3%203%200%202%200%202-3%202-2%200-2-1-2-3s-1-3-2-1h-3c-1%200-2%200-2%202l-1-1-1-2-1%202-1%203-1-1c1-2-1-4-2-3l-2-1h-2m1%2036h-4l-2%201v3c-1%202%201%202%2018%202%2015%200%2018%200%2017-1v-3l-1-2-2%201h-5c-3-2-9-1-9%202h-1c-1-2-1-2-1%200s0%202-2%201v-2l1-2-2%201h-5c-1%201-1%201-1-1h-1'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/b067ac154b6f3ddc45101a1ba3e1a793/6af66/1603721617763.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617763.png\" data-src=\"./images/1603721617763.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/b067ac154b6f3ddc45101a1ba3e1a793/6f3f2/1603721617763.png 256w,\n/acorns/static/b067ac154b6f3ddc45101a1ba3e1a793/01e7c/1603721617763.png 512w,\n/acorns/static/b067ac154b6f3ddc45101a1ba3e1a793/6af66/1603721617763.png 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div></span></p>\n</li>\n</ul>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">可以看到未提升 target element 为合成层，transform 和 opacity 依然会触发 paint。</p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e5878fe5b091e7bb98e588b6e58cbae59f9f_10\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e5878fe5b091e7bb98e588b6e58cbae59f9f_10\" class=\"blank_anchor_name\"></a><a id=\"e5878fe5b091e7bb98e588b6e58cbae59f9f_10\" class=\"blank_anchor_id\"></a><a name=\"减少绘制区域\" class=\"blank_anchor_name\"></a><a id=\"减少绘制区域\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">减少绘制区域</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">对于不需要重新绘制的区域应尽量避免绘制，以减少绘制区域，比如一个 fix 在页面顶部的固定不变的导航 header，在页面内容某个区域 repaint 时，整个屏幕包括 fix 的 header 也会被重绘，见 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/paint/reduce/no-reduce.html\" class=\"xsj_link xsj_manu_link\">demo</a>，结果如下：</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:699px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 43.359375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='174'%3e%3cpath%20d='M84%2060v6h12V55l-6-1h-6v6m0%2038l-1%203h29c19%200%2029%200%2028-1v-5l-2%203c0%201-1%202-2%201v-1c1-1%201-3-1-3l-2%202-1%203v-3l-1-3-1%203c1%204-1%204-2%200l-1-2-1%202c-1%204-3%204-2%200l-1-3-1%203-1%203-1-2-1-2c-1-1-3%201-2%203l-1%201c-2%200-2-2-1-4v-1l-2%203-2%202v-2l1-2h-1l-1-1v-1l-1%203c0%202-1%203-3%203s-4-2-3-4l-1-1-1%203v2l-1-2c-1-3-3-4-4-1l-1%202v-2c-1-2-1-2-2%200%200%203-2%204-2%201s-2-3-3-1c0%204-3%204-3%200l1-1h1c0-4-3-2-3%202m-4%2034l-1%204v2h19c18%200%2019%200%2017-3v-3c-2-1-2%200-2%202s0%202-1%201l-1-1-1%202v-2c1-1%200-2-6-2-5%200-6%200-6%202h-1c-1-2-1-2-1%200s-1%202-2%201c-2-2-2-2-2%200-1%201-1%201-1-1s-2-3-3-1h-1c0-2%200-2-2-1h-5m20%2042'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/9f04611a77f8966a90d481a3d0bcfd90/3fe45/1603721617764.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617764.png\" data-src=\"./images/1603721617764.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/9f04611a77f8966a90d481a3d0bcfd90/6f3f2/1603721617764.png 256w,\n/acorns/static/9f04611a77f8966a90d481a3d0bcfd90/01e7c/1603721617764.png 512w,\n/acorns/static/9f04611a77f8966a90d481a3d0bcfd90/3fe45/1603721617764.png 699w\" sizes=\"(max-width: 699px) 100vw, 699px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">而对于固定不变的区域，我们期望其并不会被重绘，因此可以通过之前的方法，将其提升为独立的合成层。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">减少绘制区域，需要仔细分析页面，区分绘制区域，减少重绘区域甚至避免重绘。</p>\n<h3 class=\"xsj_heading_hash xsj_heading xsj_heading_h3\" id=\"e59088e79086e7aea1e79086e59088e68890e5b182_11\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e59088e79086e7aea1e79086e59088e68890e5b182_11\" class=\"blank_anchor_name\"></a><a id=\"e59088e79086e7aea1e79086e59088e68890e5b182_11\" class=\"blank_anchor_id\"></a><a name=\"合理管理合成层\" class=\"blank_anchor_name\"></a><a id=\"合理管理合成层\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">合理管理合成层</span></h3>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">看完上面的文章，你会发现提升合成层会达到更好的性能。这看上去非常诱人，但是问题是，创建一个新的合成层并不是免费的，它得消耗额外的内存和管理资源。实际上，在内存资源有限的设备上，合成层带来的性能改善，可能远远赶不上过多合成层开销给页面性能带来的负面影响。同时，由于每个渲染层的纹理都需要上传到 GPU 处理，因此我们还需要考虑 CPU 和 GPU 之间的带宽问题、以及有多大内存供 GPU 处理这些纹理的问题。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">对于合成层占用内存的问题，我们简单做了几个 demo 进行了验证。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/multi-layers-expect.html\" class=\"xsj_link xsj_manu_link\">demo 1</a> 和 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/multi-layers.html\" class=\"xsj_link xsj_manu_link\">demo 2</a> 中，会创建 2000 个同样的 div 元素，不同的是 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/multi-layers.html\" class=\"xsj_link xsj_manu_link\">demo 2</a> 中的元素通过 will-change 都提升为了合成层，而两个 demo 页面的内存消耗却有很明显的差别。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:972px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 49.21875%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='198'%3e%3cpath%20d='M233%2015l-1%203a3168%203168%200%2000125-2l-23-1c0-2-1-2-5-2a1913%201913%200%2001-40-1c-8%200-9%201-11%202-1%202-1%202-2%201h-2l-12%201c-10%200-11%200-11-2-1-3-4-3-5%200l-1%202v-2c-1-2-3-3-5-1h-1c-2-2-5-1-6%202m-3%207c-2%205-3%20135-1%20142%201%202%202%206%204%207l3%204h68l72-1c4-2%208-8%208-10v-1c2%200%201-135%200-139l-2-4v5l-1%2072%201%2067H232V91c0-66-1-73-2-69m67%2011l-2%202c-2%201-3%207%200%207l1%202%202%201%202-2h1v1l1%201%201-1%201-2%201%201%202%202%203-1c-1-1%200-2%201-2%203-1%204-6%201-7l-2-2c-1-2-5-1-6%201h-1c0-2%200-2-1%200s-1%202-1%200-4-3-4-1M86%2034l-1%202-1%201c-3%200-4%200-4%203l2%204c2%202%204%202%204%201h2l1%201h2c0-2%202-3%202-1s4%202%206-1c2-2%203-7%201-7l-2-2c-1-1-1-2-3-1-2%200-3%202%200%202%201%201%200%201-1%201-2%200-3%200-3-2s-2-2-5-1M24%20166l76%201a900%20900%200%2000-5-2c-45%200-72%200-71%201m43%2017v3c-1%202%200%202%202%202h6c4%201%204%201%204-1s0-2%201-1c0%202%202%203%202%201h1c1%202%201%202%202%200s1-2%202-1c1%204%205%203%205%200%200-4-2-5-5-3h-8c0-2-6-1-6%201h-1c-1-2-5-3-5-1m213%202c0%204%200%204%204%203h6l3-2h1c1%203%205%204%205%201%200-2%200-2%201-1%200%201%202%202%206%202%207%201%207%201%207-2s0-4-3-4c-2%200-3%200-3%203l-1%203v-3c0-3-1-3-4-2h-10l-3-1c-1%200-2%200-1%201l-1%201-1-1-3-1c-3%200-3%200-3%203'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/04bae98859169855a265a0f9d51385fa/95c6e/1603721617865.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617865.jpg\" data-src=\"./images/1603721617865.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/04bae98859169855a265a0f9d51385fa/e4a55/1603721617865.jpg 256w,\n/acorns/static/04bae98859169855a265a0f9d51385fa/36dd4/1603721617865.jpg 512w,\n/acorns/static/04bae98859169855a265a0f9d51385fa/95c6e/1603721617865.jpg 972w\" sizes=\"(max-width: 972px) 100vw, 972px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<h4 class=\"xsj_heading_hash xsj_heading xsj_heading_h4\" id=\"e998b2e6ada2e5b182e78886e782b8_12\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e998b2e6ada2e5b182e78886e782b8_12\" class=\"blank_anchor_name\"></a><a id=\"e998b2e6ada2e5b182e78886e782b8_12\" class=\"blank_anchor_id\"></a><a name=\"防止层爆炸\" class=\"blank_anchor_name\"></a><a id=\"防止层爆炸\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">防止层爆炸</span></h4>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">通过之前的介绍，我们知道同合成层重叠也会使元素提升为合成层，虽然有浏览器的层压缩机制，但是也有很多无法进行压缩的情况。也就是说除了我们显式的声明的合成层，还可能由于重叠原因不经意间产生一些不在预期的合成层，极端一点可能会产生大量的额外合成层，出现层爆炸的现象。我们简单写了一个极端点但其实在我们的页面中比较常见的 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/layer-explode.html\" class=\"xsj_link xsj_manu_link\">demo</a>。</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-html hljs xml code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">style</span>&gt;</span><span class=\"css\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span><span class=\"hljs-tag\">  @-<span class=\"hljs-keyword\">webkit</span>-<span class=\"hljs-keyword\">keyframes</span> slide {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span><span class=\"hljs-tag\">    <span class=\"hljs-selector-tag\">from</span> { <span class=\"hljs-attribute\">transform</span>: none; }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span><span class=\"hljs-tag\">    <span class=\"hljs-selector-tag\">to</span> { <span class=\"hljs-attribute\">transform</span>: <span class=\"hljs-built_in\">translateX</span>(100px); }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span><span class=\"hljs-tag\">    }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span><span class=\"hljs-tag\">    <span class=\"hljs-selector-class\">.animating</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span><span class=\"hljs-tag\">    </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">300px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">30px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: orange;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">color</span>: <span class=\"hljs-number\">#fff</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">-webkit-animation</span>: slide <span class=\"hljs-number\">5s</span> alternate linear infinite;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span><span class=\"hljs-tag\">    }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span><span class=\"hljs-tag\">  <span class=\"hljs-selector-tag\">ul</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">padding</span>: <span class=\"hljs-number\">5px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"18\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">18</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">border</span>: <span class=\"hljs-number\">1px</span> solid <span class=\"hljs-number\">#000</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"19\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">19</span><span class=\"hljs-tag\">  }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"20\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">20</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"21\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">21</span><span class=\"hljs-tag\">    <span class=\"hljs-selector-class\">.box</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"22\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">22</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"23\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">23</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">600px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"24\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">24</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">30px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"25\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">25</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">margin-bottom</span>: <span class=\"hljs-number\">5px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"26\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">26</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">background-color</span>: blue;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"27\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">27</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">color</span>: <span class=\"hljs-number\">#fff</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"28\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">28</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">position</span>: relative;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"29\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">29</span><span class=\"hljs-tag\">    <span class=\"hljs-comment\">/* 会导致无法压缩：squashingClippingContainerMismatch */</span></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"30\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">30</span><span class=\"hljs-tag\">    <span class=\"hljs-attribute\">overflow</span>: hidden;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"31\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">31</span><span class=\"hljs-tag\">    }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"32\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">32</span><span class=\"hljs-tag\"></span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"33\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">33</span><span class=\"hljs-tag\">    <span class=\"hljs-selector-class\">.inner</span> {</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"34\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">34</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">position</span>: absolute;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"35\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">35</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">top</span>: <span class=\"hljs-number\">2px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"36\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">36</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">left</span>: <span class=\"hljs-number\">2px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"37\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">37</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">font-size</span>: <span class=\"hljs-number\">16px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"38\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">38</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">line-height</span>: <span class=\"hljs-number\">16px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"39\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">39</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">padding</span>: <span class=\"hljs-number\">2px</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"40\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">40</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">margin</span>: <span class=\"hljs-number\">0</span>;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"41\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">41</span><span class=\"hljs-tag\">      <span class=\"hljs-attribute\">background-color</span>: green;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"42\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">42</span><span class=\"hljs-tag\">    }</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"43\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">43</span><span class=\"hljs-tag\"></span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">style</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"44\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">44</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"45\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">45</span><span class=\"hljs-comment\">&lt;!-- 动画合成层 --&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"46\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">46</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"animating\"</span>&gt;</span>composited animating<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"47\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">47</span><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ul</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"48\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">48</span>  <span class=\"hljs-comment\">&lt;!-- assume overlap --&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"49\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">49</span>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">li</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"box\"</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"50\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">50</span>    <span class=\"hljs-comment\">&lt;!-- assume overlap --&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"51\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">51</span>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"inner\"</span>&gt;</span>asume overlap, 因为 squashingClippingContainerMismatch 无法压缩<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"52\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">52</span>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">li</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"53\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">53</span>  <span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"54\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">54</span>  ...<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"55\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">55</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">ul</span>&gt;</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"><a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/layer-explode.html\" class=\"xsj_link xsj_manu_link\">demo</a> 中，<code>.animating</code> 的合成层在运行动画，会导致 <code>.inner</code> 元素因为上文介绍过的 assumedOverlap 的原因，而被提升为合成层，同时，<code>.inner</code> 的父元素 <code>.box</code> 设置了 <code>overflow: hidden</code>，导致 <code>.inner</code> 的合成层因为 squashingClippingContainerMismatch 的原因，无法压缩，就出现了层爆炸的问题。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 55.859375%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='224'%3e%3cpath%20d='M3%2021v5h173v-9H3v4m186%200c0%202%202%203%206%202%201%200%202-1%201-2l1-1%201%202%2021%201c20%200%2021%200%2021-2s-1-2-26-2c-24%200-25%200-25%202M3%2032v4h173v-9H3v5m0%2010v4h173v-9H3v5m277%200c0%201%200%202%201%201%200-2-3-2%2083-2l5-1-44-1h-45v3M3%2052v4h173v-9H3v5m0%2010v4h173v-9H3v5m321-2h-44v8c0%204%200%207%201%206%200-2%203-2%2039-2l39-1-39-1-39-1c0-2%205-2%2038-2a805%20805%200%20006-2c-43%200-44%200-44-2s1-2%2044-2c38%200%2046%200%2044-1h-45M3%2072v4h173v-9H3v5m0%2010v4h173v-9H3v5m1%206l-1%204v4h173v-8l-86-1-86%201m276%208c0%203%200%205%201%204%200-2%203-2%2038-2a855%20855%200%2000-38-3%202084%202084%200%200044-3l-45-1v5M3%2098v8h173v-8l-86-1-87%201m3%2010c-3%200-3%200-3%204v4h173v-8H6m71%2010H3v8h173v-8H77m203%209c0%203%200%205%201%204%200-2%203-2%2038-2l45-1%206-1h-8a28293%2028293%200%2000-81-1l1-2a30297%2030297%200%200143-2h-45v5M3%20132v4h173v-8H3v4m0%2010c0%203%200%204%202%204h171v-8H3v4m0%2010c0%203%200%204%202%204l86%201h85v-9H3v4m0%2010l1%205h172v-9H3v4m0%2010l1%205h172v-9H3v4m0%2011v4h173v-9H3v5m0%2010v4h173v-9H3v5m0%2010v4h173v-9H3v5m0%2010v4h173v-9H3v5'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/1e913a2e0f9ddb467d0f1f5be0060b7b/80e3c/1603721617866.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617866.jpg\" data-src=\"./images/1603721617866.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/1e913a2e0f9ddb467d0f1f5be0060b7b/e4a55/1603721617866.jpg 256w,\n/acorns/static/1e913a2e0f9ddb467d0f1f5be0060b7b/36dd4/1603721617866.jpg 512w,\n/acorns/static/1e913a2e0f9ddb467d0f1f5be0060b7b/80e3c/1603721617866.jpg 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">这种情况平时在我们的业务中还是很常见的，比如 slider + list 的结构，一旦满足了无法进行层压缩的情况，就很容易出现层爆炸的问题。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">解决层爆炸的问题，最佳方案是打破 overlap 的条件，也就是说让其他元素不要和合成层元素重叠。对于上述的示例，我们可以将 <code>.animation</code> 的 z-index 提高。修改后 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/layer-explode-zIndex.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-css hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-selector-class\">.animating</span> {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>  <span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>  ...<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>  <span class=\"hljs-comment\">/* 让其他元素不和合成层重叠 */</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>  <span class=\"hljs-attribute\">position</span>: relative;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>  <span class=\"hljs-attribute\">z-index</span>: <span class=\"hljs-number\">1</span>;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">此时，就只有 <code>.animating</code> 提升为合成层，如下：</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 57.03125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='228'%3e%3cpath%20d='M196%2011c-3%200-4%201-4%202%200%202%201%202%2012%202l10-1h-8l-6-1%209-1c6%200%208%200%208%202l13%201c13%200%2013%200%2013-2v-2h-47M3%2019v4l-1%203h176v-9H91C8%2017%203%2017%203%2019m0%2013v4h175v-9H3v5m0%209v5l88%201h87v-9H3v3m0%208a44%2044%200%20000%207l88%201h87v-9H91L3%2049m0%209v9h175v-9H3m0%2011v8h175v-9H91L3%2069m0%2011a44%2044%200%20000%207l88%201h87v-9H91L3%2080m0%2012c-1%207-9%206%2088%206h87v-9H3v3m0%209v4l-1%203h176v-9H91c-83%200-88%200-88%202m0%2010v4l-1%203h120l56%201v-9H91l-88%201m0%2014v4h175v-9H2l1%205m0%206l-1%204%201%204h175v-9H91l-88%201m0%2010v8h175v-9c-1-1-175%200-175%201m0%2010v8l88%201h87v-9h-13a172020%20172020%200%2001-162%200m0%2013v5l88%201h87v-9H3v3m0%209v7h175v-9H91c-87%200-88%200-88%202m0%2010v7h175v-9H91c-78%200-88%200-88%202m-1%2013c0%203%201%204%202%204h88l86%201v-9H2v4m1%207l-1%204%201%204h175v-9H91l-88%201m0%2010v8h175v-9H91l-88%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/19f81661baea24bdad3a4b14b5362f4a/80e3c/1603721617917.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617917.jpg\" data-src=\"./images/1603721617917.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/19f81661baea24bdad3a4b14b5362f4a/e4a55/1603721617917.jpg 256w,\n/acorns/static/19f81661baea24bdad3a4b14b5362f4a/36dd4/1603721617917.jpg 512w,\n/acorns/static/19f81661baea24bdad3a4b14b5362f4a/80e3c/1603721617917.jpg 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">同时，内存占用比起之前也降低了很多。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:947px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 51.171875%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='205'%3e%3cpath%20d='M236%2011l-2%203c-1%202%202%202%2048%202s49-1%2050-2c0-2-1-2-5-2l-8-1h-2l-7%201h-11l-10-1c-9%200-11%200-11%203l-2%201-3-1h-10c-8%200-10%200-11-2s-5-1-4%201l-1%202-1-2c0-2-3-3-5-1-1%202-1%202-1%200-1-2-2-3-4-1M20%2013c-4%203-3%204%2031%203a160%20160%200%200034-1l14%201a2196%202196%200%200162-1%20217%20217%200%2000-43%200c-2%200-2-2-1-2%201-1-1-1-4-1l-8-1-4%201h-1c-1-1-11-1-13%201l-3-1c-2-2-20-1-20%201l-13%201H39c0%202-2%201-2-1-1-3-4-3-5%200l-1%202v-2c-1-3-4-3-4%200v3l-1-3c-1-2-4-3-6%200m176%2072a1610%201610%200%20001%200l-1-70v70m181%201v70H234V90c0-69%200-75-3-66-1%206-2%20127%200%20133l4%207%203%203h67c74%200%2071%200%2073-7l1-65a437%20437%200%20010-70l-1-7-1%2068M162%2023l-1%2068v65l-71-1H20l-1-66-1-67c-2-5-2%206-2%2066%200%2073%200%2067%203%2072%203%206%203%206%2074%206h64l4-4%203-4V90c0-63-1-78-2-67m-81%209l-3%201c-2%200-2%201-2%204s0%203%203%203l3%201h6l3%201%202-1%202-1%202-4c0-2%200-3-2-3l-2-1-2-2c-2%200-3%201-3%202l-1%201v-1c0-2-1-2-3-2s-3%201-3%202m215-1l-2%202c-2%200-2%201-2%203s0%203%202%203l2%201c0%202%205%202%206%201h1l3%201%202-1%202-2%203-2c0-3-2-5-3-4l-2-1c0-2-5-3-5-1h-1l-2-1-2%201h-2M67%20188v4h7c5%200%206%200%206-2s0-2%201%200c1%203%206%202%206-2%200-3-3-4-6-2h-8l-3-1c-3%200-3%200-3%203m210-1c-2%204-1%205%206%205%204%200%207%200%206-1v-1h2c1%202%208%202%208%201l-2-1-1-2c0-2%200-3-3-3-2%200-3%200-3%202h-1c-2-2-5-1-6%200h-1c0-3-5-3-5%200m34%200v3c-1%202%200%202%209%202%2011%200%2011-1%2010-4%200-4-5-4-5-1v3l-1-3c-1-2-4-3-6-1h-1l-3-1c-3%200-3%200-3%202'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/007218d32d9917192a7138154606b85b/d412e/1603721617918.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617918.jpg\" data-src=\"./images/1603721617918.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/007218d32d9917192a7138154606b85b/e4a55/1603721617918.jpg 256w,\n/acorns/static/007218d32d9917192a7138154606b85b/36dd4/1603721617918.jpg 512w,\n/acorns/static/007218d32d9917192a7138154606b85b/d412e/1603721617918.jpg 947w\" sizes=\"(max-width: 947px) 100vw, 947px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">如果受限于视觉需要等因素，其他元素必须要覆盖在合成层之上，那应该尽量避免无法层压缩情况的出现。针对上述示例中，无法层压缩的情况（squashingClippingContainerMismatch），我们可以将 <code>.box</code> 的 <code>overflow: hidden</code> 去掉，这样就可以利用浏览器的层压缩了。修改后 <a href=\"https://suziwen.github.io/taofeddemo/performance-composite-demo/memory/layer-explode-squash.html\" class=\"xsj_link xsj_manu_link\">demo</a></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">此时，由于第一个 <code>.box</code> 因为 squashingLayerIsAnimating 的原因无法压缩，其他的都被压缩到了一起。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:720px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 56.640625%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='226'%3e%3cpath%20d='M3%2017v9h175v-9H3m189%204v3h51v-5h-21c-20%200-22%200-22%202h-1c0-3-7-3-7%200M3%2027v9h175v-9H3m0%2012v7h88l87%201v-9H91L3%2039m0%2010v8h175v-9H91L3%2049m0%2010l-1%204%201%204h175v-9H91L3%2059m0%2010v8h175v-9H91L3%2069m0%2011v7h87a1465%201465%200%20010%202L3%2090v7l88%201h87V78H91c-79%200-88%201-88%202m0%2023v5h175v-9H3v4m0%208v7h175v-9H91c-85%200-88%200-88%202m0%209v8h175v-9H91l-88%201m7%2010l-7%201-1%203v4h92l84%201v-9H10m-7%2012v7h175v-9H91c-83%200-88%200-88%202m0%208v9h175v-9H3m0%2010v9h175v-9H3m6%2011c-6%200-7%201-6%205v3h175v-9H96l-87%201m-6%2014v5h175v-9H3v4m0%206v9h175v-9H3m0%2013v5l88%201h87v-9H3v3m0%209v7h175v-9H3v2'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/a0dec6992ccca03f130b6f461412b13c/80e3c/1603721617919.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617919.jpg\" data-src=\"./images/1603721617919.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/a0dec6992ccca03f130b6f461412b13c/e4a55/1603721617919.jpg 256w,\n/acorns/static/a0dec6992ccca03f130b6f461412b13c/36dd4/1603721617919.jpg 512w,\n/acorns/static/a0dec6992ccca03f130b6f461412b13c/80e3c/1603721617919.jpg 720w\" sizes=\"(max-width: 720px) 100vw, 720px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">同时，内存占用比起之前也降低了很多。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:936px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 51.171875%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='205'%3e%3cpath%20d='M17%2012c-4%205-6%205%2071%205h72v140H17V89c0-63-1-74-3-66a2155%202155%200%20002%20138c0%206%209%207%2078%207%2068-1%2067%200%2069-10a1923%201923%200%2000-2-141v-3h-21l-21%201h-1l-2-1h-1c0-2-1-2-6-2l-24%201-3-1-10-1c-8%200-9%200-10%202%200%202-1%202-8%201a156%20156%200%2001-14%200c0%201-4%200-5-2-2-2-4-1-5%201l-1%202v-2c-1-2-2-3-4%200h-2c0-2-4-2-6-1m216%201l-1%203a2205%202205%200%2000101-1l-1-1c0-2%200-2-21-2h-9l-2%201-2-1h-19l-2%202-1%201-1-2h-1c-1%202-23%202-23%200-1-3-6-2-5%200%200%203-2%202-2%200-1-2-4-3-4%200h-1c-2-3-4-2-6%200m-3%208l-1%2071c0%2064%200%2068%202%2071%204%206%202%206%2073%206%2069%200%2069%200%2074-5l2-2V91c0-64-1-79-2-68l-1%2069v66H232V88c0-58-1-70-2-67M84%2031h-1c-1-2-2-2-3%200l-3%202c-2%200-3%201-3%204s0%203%203%203l3%201h3c0-1%201-1%201%201h1l1-2%201%201c0%201%200%202%202%202l2-1%202-2c2%200%202-1%202-2a392%20392%200%2000-1-5l-2-1c-1-2-6-2-5%200l-1%201c-1%200-2-1-1-2v-2l-1%202m154%201v1l1%206c-1%204-1%205%201%205l2-1h5l4-1-1-1h-5c-2%200-3-1-3-2l-1-1-1-1h2l2%201c0%201%2015%201%2016-1%202-2%200-2-10-2l-8%201v-3c0-3-2-4-4-1m58%200l-3%201c-3%200-3%200-3%204v3h5l5%201c0%201%201%202%204%202%202%200%203-1%203-2l2-1c3%200%203%200%203-3l-2-4-2-1c-1-2-4-2-6%200h-1c0-2-5-2-5%200M67%20187l-2%204v3l8-1h11c2-4%201-5-1-6H67m213%200h-1c-1%200-2%201-2%203-1%203-1%203%2012%203%208%201%2010%200%2010-1v-1c-2%201-2%200-2-2l-2-2c-4%200-5%200-4%201l-1%201-1-1-1-1h-2c-1-1-1%200-2%201%200%202-1%202-1%201%200-2-3-4-3-2m25%200c-1%206-1%206%205%207l10-1c5%200%205%200%205-3-1-4-1-4-4-3h-16'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/f43d66ff055c4f3dd7bce9c67806c1d3/38044/1603721617920.jpg\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1603721617920.jpg\" data-src=\"./images/1603721617920.jpg\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/f43d66ff055c4f3dd7bce9c67806c1d3/e4a55/1603721617920.jpg 256w,\n/acorns/static/f43d66ff055c4f3dd7bce9c67806c1d3/36dd4/1603721617920.jpg 512w,\n/acorns/static/f43d66ff055c4f3dd7bce9c67806c1d3/38044/1603721617920.jpg 936w\" sizes=\"(max-width: 936px) 100vw, 936px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e69c80e5908e_13\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e69c80e5908e_13\" class=\"blank_anchor_name\"></a><a id=\"e69c80e5908e_13\" class=\"blank_anchor_id\"></a><a name=\"最后\" class=\"blank_anchor_name\"></a><a id=\"最后\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">最后</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">之前无线开发时，大多数人都很喜欢使用 <code>translateZ(0)</code> 来进行所谓的硬件加速，以提升性能，但是性能优化并没有所谓的“银弹”，<code>translateZ(0)</code> 不是，本文列出的优化建议也不是。抛开了对页面的具体分析，任何的性能优化都是站不住脚的，盲目的使用一些优化措施，结果可能会适得其反。因此切实的去分析页面的实际性能表现，不断的改进测试，才是正确的优化途径。</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e58f82e88083_14\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e58f82e88083_14\" class=\"blank_anchor_name\"></a><a id=\"e58f82e88083_14\" class=\"blank_anchor_id\"></a><a name=\"参考\" class=\"blank_anchor_name\"></a><a id=\"参考\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">参考</span></h2>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/core/paint/PaintLayer.h\" class=\"xsj_link xsj_manu_link\">PaintLayer.h</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/core/paint/PaintLayer.cpp\" class=\"xsj_link xsj_manu_link\">PaintLayer.cpp</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/platform/graphics/CompositingReasons.cpp\" class=\"xsj_link xsj_manu_link\">CompositingReasons.cpp</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/platform/graphics/CompositingReasons.h\" class=\"xsj_link xsj_manu_link\">CompositingReasons.h</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://code.google.com/p/chromium/codesearch#chromium/src/third_party/WebKit/Source/core/layout/compositing/CompositingRequirementsUpdater.cpp&amp;q=CompositingRequirementsUpdater&amp;sq=package:chromium&amp;type=cs&amp;l=212\" class=\"xsj_link xsj_manu_link\">CompositingRequirementsUpdater.cpp</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://www.chromium.org/developers/testing/webkit-layout-tests\" class=\"xsj_link xsj_manu_link\">chrome layout test</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://www.chromium.org/blink/slimming-paint\" class=\"xsj_link xsj_manu_link\">Slimming Paint</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Understanding_z_index/The_stacking_context\" class=\"xsj_link xsj_manu_link\">The stacking contest</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://docs.google.com/presentation/d/1WOhbWLkhMyo4vZUaHq-FO-mt0B2sejXw-lMwohD5iUo/edit?pref=2&amp;pli=1#slide=id.g2a949df15_00\" class=\"xsj_link xsj_manu_link\">Blink Compositing Update: Recap and Squashing</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"http://www.chromium.org/developers/design-documents/gpu-accelerated-compositing-in-chrome\" class=\"xsj_link xsj_manu_link\">GPU Accelerated Compositing in Chrome</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"http://csstriggers.com/\" class=\"xsj_link xsj_manu_link\">CSS Triggers</a></p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><a href=\"https://developers.google.com/web/fundamentals/performance/rendering/?hl=zh-cn\" class=\"xsj_link xsj_manu_link\">google render performance</a></p>\n</li>\n</ul>\n</div>\n\n","excerpt":"一个 Web 页面的展示，简单来说可以认为经历了以下下几个步骤。 \n当然，本文我们只来关注 Composite 部分。\n在讨论 Composite 之前，有必要先简单了解下一些浏览器（本文只是针对 Chrome 来说）的渲染原理，方便对之后一些概念的理解。更多详细的内容可以参阅 G...","docType":"posts","slug":"web/performance-composite","title":"无线性能优化：Composite","customCss":"","createDate":"October 26, 2020","updateDate":"October 27, 2020","tags":["文章","转载","技术","前端"]}},"pageContext":{"slug":"web/performance-composite","zipPath":"/home/runner/work/acorns/acorns/posts/web/无线性能优化：Composite.zip","prev":{"title":"A tale of two viewports — part two","docType":"posts","slug":"web/viewports2"},"next":{"title":"2020-10-9 中印界湖-班公湖","docType":"posts","slug":"bike/2020-10-9 中印界湖-班公湖"},"pluginOptions":{"tagsPath":"/tags/","archivesPath":"/archives/","basePath":"/","commentType":"gitalk"},"basePath":"/"}},"staticQueryHashes":["2682448919","2682448919"]}