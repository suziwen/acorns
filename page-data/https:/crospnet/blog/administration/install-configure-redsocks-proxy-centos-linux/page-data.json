{"componentChunkName":"component---node-modules-suziwen-gatsby-theme-sculpting-src-templates-template-blog-post-js","path":"/https:/crospnet/blog/administration/install-configure-redsocks-proxy-centos-linux","result":{"data":{"zipFile":{"publicURL":"/acorns/static/6705cf95b6934264776d1815e852558c/How to install and configure Redsocks on Centos Linux.zip"},"site":{"siteMetadata":{"siteUrl":"https://suziwen.github.io/acorns"}},"storyWriterMarkdown":{"id":"d29af7d8-8e59-58f5-9da2-5c971b35f0bf","html":"\n\n\t<div class=\"preview html_preview xsj_export_zip\"><div style=\"overflow: hidden; position: absolute; top: 0; height: 1px; width: auto; padding: 0; border: 0; margin: 0; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;\"><svg><defs id=\"MathJax_SVG_glyphs\"/><defs xmlns=\"http://www.w3.org/2000/svg\"><filter xmlns=\"http://www.w3.org/2000/svg\" id=\"dropshadow\" height=\"130%\">      <fegaussianblur in=\"SourceAlpha\" stddeviation=\"3\"/>       <feoffset dx=\"2\" dy=\"2\" result=\"offsetblur\"/>       <femerge>         <femergenode/>        <femergenode in=\"SourceGraphic\"/>       </femerge>    </filter><filter id=\"editing-stripe-bk\" filterunits=\"userSpaceOnUse\" x=\"-100%\" y=\"-100%\" width=\"300%\" height=\"300%\"><feflood flood-color=\"#700f0f\" result=\"flood1\"/><feflood flood-color=\"#fff\" flood-opacity=\"0.5\" result=\"flood2\"/><feimage xlink:href=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAwcHgiIGhlaWdodD0iMTAwMHB4Ij48ZGVmcz48cGF0dGVybiBpZD0icGF0dGVybiIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjQiIGhlaWdodD0iNCI+PHBhdGggZD0iTSAtNCAtNCBMIDggOCBNIC04IC00IEwgNCA4IE0gLTQgLTggTCA4IDQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI3BhdHRlcm4pIi8+PC9zdmc+\" x=\"0\" y=\"0\" width=\"2000\" height=\"1000\" result=\"image\"/><fetile in=\"image\" result=\"tile\"/><fecomposite operator=\"in\" in=\"flood1\" in2=\"tile\" result=\"tile2\"/><fegaussianblur in=\"SourceAlpha\" stddeviation=\"10\" result=\"blur\"/><fecomposite operator=\"in\" in=\"tile2\" in2=\"blur\" result=\"cloud\"/><femorphology operator=\"dilate\" radius=\"2\" in=\"SourceAlpha\" result=\"dilate\"/><fecomposite operator=\"in\" in=\"flood2\" in2=\"dilate\" result=\"base\"/><femerge><femergenode in=\"cloud\"/><femergenode in=\"base\"/><femergenode in=\"SourceGraphic\"/></femerge></filter></defs></svg></div><blockquote class=\"markdown_blockquote\">\n<p class=\"xsj_paragraph xsj_paragraph_level_1\"><span class=\"xsj_placeholder_span\"></span>本文为转载文章, 仅用于自己的知识管理收集, 如果涉及侵权,请联系 <a href=\"mailto:suziwen1@gmail.com\" class=\"xsj_link xsj_auto_link\">suziwen1@gmail.com</a>,会第一时间删除<br>\n收集该文章,并非代表本人支持文中观点,只是觉得文章内容容易引起思考,讨论,有它自有的价值</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_1\"><span class=\"xsj_placeholder_span\"></span>转载自: <a href=\"https://crosp.net/blog/administration/install-configure-redsocks-proxy-centos-linux/\" class=\"xsj_link xsj_auto_link\">https://crosp.net/blog/administration/install-configure-redsocks-proxy-centos-linux/</a></p>\n</blockquote>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"toc mindmap_toc mindmap_container\" data-vdom-skip=\"true\" data-hash=\"3490696b6cfb21db7e5c468e915a10ca_mindmap_toc\"><div class=\"xsj_mindmap xsj_mindmap_toc\"><svg id=\"xsj_mindmap_toc_1628091625283\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" class=\"xsj_svg_viewbox\" style=\"max-width:1425px;max-height:692px;\" viewbox=\"0 0 1425 692\" width=\"100%\" height=\"100%\"><g transform=\"translate(571,368) scale(1)\"><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#dc3912\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,234 443,234 L445,234\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,234)\"><path class=\"markmap-node-path\" d=\"M0,0L96,0\" stroke-width=\"4\" stroke=\"#dc3912\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(96, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(220, 57, 18);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#ff9900\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,156 443,156 L445,156\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,156)\"><path class=\"markmap-node-path\" d=\"M0,0L356,0\" stroke-width=\"4\" stroke=\"#ff9900\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(356, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(255, 153, 0);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,78 443,78 L445,78\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,78)\"><path class=\"markmap-node-path\" d=\"M0,0L283,0\" stroke-width=\"4\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(283, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#990099\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,0 443,0 L445,0\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,0)\"><path class=\"markmap-node-path\" d=\"M0,0L283,0\" stroke-width=\"4\" stroke=\"#990099\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(283, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(153, 0, 153);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#0099c6\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,-78 443,-78 L445,-78\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,-78)\"><path class=\"markmap-node-path\" d=\"M0,0L269,0\" stroke-width=\"4\" stroke=\"#0099c6\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(269, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(0, 153, 198);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#dd4477\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,-156 443,-156 L445,-156\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,-156)\"><path class=\"markmap-node-path\" d=\"M0,0L362,0\" stroke-width=\"4\" stroke=\"#dd4477\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(362, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(221, 68, 119);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#66aa00\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,-234 443,-234 L445,-234\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,-234)\"><path class=\"markmap-node-path\" d=\"M0,0L245,0\" stroke-width=\"4\" stroke=\"#66aa00\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(245, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(102, 170, 0);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"4\" d=\"M335,-39 L340,-39 C412,-39 407,-312 443,-312 L445,-312\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(335, -39)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(443,-312)\"><path class=\"markmap-node-path\" d=\"M0,0L115,0\" stroke-width=\"4\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(115, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-node markmap-root-node\" transform=\"translate(-479,-39)\"><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(813, 0)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: rgb(51, 102, 204);\"/><g transform=\"translate(1, -34)\"><rect class=\"markmap-node-rect\" rx=\"10\" ry=\"10\" height=\"68\" width=\"812\" fill=\"rgb(78, 156, 255)\" stroke=\"#3366cc\" stroke-width=\"1\"/><text class=\"markmap-node-text\" alignment-baseline=\"middle\" x=\"407\" y=\"38\" text-anchor=\"middle\" style=\"font: bolder 30px sans-serif; fill-opacity: 1; fill: rgb(255, 255, 255);\">How to install and configure Redsocks on Centos Linux</text></g></g><g class=\"markmap-node\" transform=\"translate(443,234)\"><a xlink:href=\"#conclusion_8\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); stroke: white; stroke-width: 2px; cursor: pointer;\">Conclusion</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); cursor: pointer;\">Conclusion</text></a></g><g class=\"markmap-node\" transform=\"translate(443,156)\"><a xlink:href=\"#step20520e2809420testing20proxies20with20redsocks_7\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); stroke: white; stroke-width: 2px; cursor: pointer;\">Step 5 — Testing proxies with Redsocks</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); cursor: pointer;\">Step 5 — Testing proxies with Redsocks</text></a></g><g class=\"markmap-node\" transform=\"translate(443,78)\"><a xlink:href=\"#step20420e2809420configuring20redsocks_6\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">Step 4 — Configuring Redsocks</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">Step 4 — Configuring Redsocks</text></a></g><g class=\"markmap-node\" transform=\"translate(443,0)\"><a xlink:href=\"#step20320e2809420setting20iptables20rules_5\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(153, 0, 153); stroke: white; stroke-width: 2px; cursor: pointer;\">Step 3 — Setting Iptables Rules</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(153, 0, 153); cursor: pointer;\">Step 3 — Setting Iptables Rules</text></a></g><g class=\"markmap-node\" transform=\"translate(443,-78)\"><a xlink:href=\"#step20220e2809420compiling20redsocks_4\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(0, 153, 198); stroke: white; stroke-width: 2px; cursor: pointer;\">Step 2 — Compiling Redsocks</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(0, 153, 198); cursor: pointer;\">Step 2 — Compiling Redsocks</text></a></g><g class=\"markmap-node\" transform=\"translate(443,-156)\"><a xlink:href=\"#step20120e2809420getting20redsocks20source20code_3\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(221, 68, 119); stroke: white; stroke-width: 2px; cursor: pointer;\">Step 1 — Getting Redsocks source code</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(221, 68, 119); cursor: pointer;\">Step 1 — Getting Redsocks source code</text></a></g><g class=\"markmap-node\" transform=\"translate(443,-234)\"><a xlink:href=\"#how20does20redsocks20work20_2\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(102, 170, 0); stroke: white; stroke-width: 2px; cursor: pointer;\">How does Redsocks work ?</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(102, 170, 0); cursor: pointer;\">How does Redsocks work ?</text></a></g><g class=\"markmap-node\" transform=\"translate(443,-312)\"><a xlink:href=\"#prerequisites_1\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">Prerequisites</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">Prerequisites</text></a></g><g class=\"annotation-group\"><g class=\"annotations\"/></g></g></svg></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"><strong class=\"markdown_strong_asterisk\">Redsocks</strong> is the tool that allows you to proxify(redirect) network traffic through a <strong class=\"markdown_strong_asterisk\">SOCKS4</strong>, <strong class=\"markdown_strong_asterisk\">SOCKS5</strong> or <strong class=\"markdown_strong_asterisk\">HTTPs</strong> proxy server. It works on the lowest level, the kernel level (<strong class=\"markdown_strong_asterisk\">iptables</strong>). The other possible way is to use <strong class=\"markdown_strong_asterisk\">application level proxy</strong>, when <strong class=\"markdown_strong_asterisk\">the proxy client</strong> is implemented in the same language as an application is written in. <strong class=\"markdown_strong_asterisk\">Redsocks</strong> operates on the lowest system level, that’s why all running application don’t even have an idea that network traffic is sent through a proxy server, as a result it is called a <strong class=\"markdown_strong_asterisk\">transparent proxy redirector</strong>.</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"prerequisites_1\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"prerequisites_1\" class=\"blank_anchor_name\"></a><a id=\"prerequisites_1\" class=\"blank_anchor_id\"></a><a name=\"prerequisites\" class=\"blank_anchor_name\"></a><a id=\"prerequisites\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Prerequisites</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">If you are reading this article, you should probably have an idea why do you need to use <strong class=\"markdown_strong_asterisk\">a proxy server</strong>. Furthermore, you should be acquainted with basic proxy terms and definitions in order to understand everything described in this tutorial. It wouldn’t hurt to have some Linux administration skills as well.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">For this tutorial I will be using <strong class=\"markdown_strong_asterisk\">Centos 7 Minimal installation</strong>, it has only the most essential applications installed. But you are free to use any distro, you may skip some steps then.</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"how20does20redsocks20work20_2\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"how20does20redsocks20work20_2\" class=\"blank_anchor_name\"></a><a id=\"how20does20redsocks20work20_2\" class=\"blank_anchor_id\"></a><a name=\"how-does-redsocks-work\" class=\"blank_anchor_name\"></a><a id=\"how-does-redsocks-work\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">How does Redsocks work ?</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Before start installing <strong class=\"markdown_strong_asterisk\">Redsocks</strong>, I think it is always worth to know how something works internally. And it will help to understand this tool better and therefore troubleshoot issues.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">First of all, <strong class=\"markdown_strong_asterisk\">Redsocks</strong> leverages features provided by <strong class=\"markdown_strong_asterisk\">the Linux kernel firewall</strong> (<strong class=\"markdown_strong_asterisk\">Netfilter module</strong>)</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">I hope this diagram will help you to understand the flow of a packet while using <strong class=\"markdown_strong_asterisk\">Redsocks</strong>.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:688px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 61.328125%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='246'%3e%3cpath%20d='M367%202l-9%202-4%201v12c0%2012%200%2012-2%2012l-2%201c1%201%200%202-1%202l-1%202%202-1h3c1-1%201%200%201%205v7l9%202%2013%203c2-1%204-1%205%201%203%203%2011%202%2014-1%205-5%205-12%201-17-3-2-3-3-3-15V5l-8-3c-9-2-10-2-18%200m0%201l-9%203h-1l-1%202c0%201%201%202%207%204l7%203-7-1-7-3v9c0%206%200%208%201%206l1-4%202%203%207%205%205%202V21l1-10%204-2%209-2%205-1-8-3-8-2-8%202M14%2027l-1%205c0%203%201%204%206%204l6-2c1-1%201-1%203%201h5l3%201c3%200%204-5%202-7-2-1-5%200-5%202%201%201-4%204-5%203s1-4%202-3l2-1c0-2-3-2-4-1-2%202-2%202-3%200-2-2-5%200-5%203l-2%202c-3%200-3-1-3-4l-1-3m345%2040c-2%201-1%203%202%204l1%201h-4c0%202%203%202%205%201h8l2%201%202-1-1-1-2-2%202-1%202%201v2c0%202%200%202%201%201h2l1%201v-5h-1l-2-2h-1c0%201-1%202-2%201l-3%201h-1c-2-2-5-1-5%201l-1%201v-3c0-2-4-3-5-1M111%2096c-16%2017-20%2020-22%2020H76l-11%201c-1%201%202%201%2010%201l12%201h3c2-1%203-1%2022%2019l20%2019%2020-19%2020-20h7l8%201h2c2-1%202-1%202%209%200%208%200%2010%202%2011%201%202%205%202%2034%202%2036%200%2034%200%2034-8%200-3%200-3%202-2l2%201-2-2c-2-1-2-2-2-8v-6h33a3397%203397%200%200058%203c2-1%202-1%202%205l1%206%209%203c6%202%2010%203%2012%202s3%200%205%201c4%203%2011%203%2015-1l3-5%201-2v-2l-1-2-3-5-3-3V90l-9-2-9-3-10%203-10%203-1%2012c0%2012%200%2012-2%2011-2%200-2%200-1%201l-19%201-45-1h-26v-6c0-4%201-6%202-7v-2c-2%201-2%200-2-4%200-8%201-8-35-8-38%200-35-1-35%2016%200%2012%200%2012-2%2012h-17l-20-20-20-20-21%2020m1%201l-19%2020%2020%2019%2019%2019%2019-19%2019-19-19-20-20-19-19%2019m252-8c-7%202-8%203-8%205l1%202c1-1%2013%203%2013%204l-7-1-7-2a96%2096%200%20001%2015c0-5%200-5%202-3%201%202%2011%208%2012%208l1-10V96l4-1%209-2c6-2%206-2-2-4-7-2-8-2-19%200m-169%2029v20h21c19%200%2021%200%2018-1l-6-2c-5%200-15-4-18-6-2-2-2-3-2-12l-1-11v-4c0-2%201-2%2010-2l11%201-1%204v4h7c6%200%209%201%207%204-2%205-1%209%203%2013%205%204%205%206%202%209l-2%203h14V99l-32-1h-31v20M24%20106l-1%2012%201%2010h17l18-1v-21c-2-2-33-1-35%200m1%2011v9l3-2%205-5%203-3-5-4-6-5v10m3-10l7%206%206%206%204-3%207-6%204-3H28m24%205l-5%205%205%204%205%205%201-9v-10l-6%205m-19%2010l-5%204%2014%201c15%200%2015%200%207-6-4-3-4-3-6-2-1%202-2%202-4%200-2-1-2-1-6%203m93%202l-1%201-5-1c-4%200-5%200-5%203v3l1-2%201-3%201%203c0%202%200%202%202%201h1c0%202%203%201%204-1h1c2%203%205%202%205-2%200-2%200-3%202-3v1l-1%203c0%204%203%204%204%200l1-2v2c0%203%202%204%202%202h1c2%202%204%201%204-1l1%201c2%201%202%201%202-1l1-3c1-1-1-1-3-1-4%200-5%201-6%202-1%202-1%202-1%200%201-3%200-5-1-3h-9c-1-1-1-1-2%201m94%2028l-2%201c-2%201-2%202-2%204l1%203h8l9-1h2c1%201%204%201%204-1h-1c-2%201-3%200-3-2l2-1c2%201%203-1%200-2l-3%201-1%201c-1-3-5-2-6%200%200%201-1%202-2%201l-1-1%202-1-2-1c-2%201-3%200-3-1l-1-1-1%201m145%2022l-10%203-1%2010-1%209h-2l-2-1v1l1%203%202%201c2%200%202%201%202%208l1%208%209%203c6%202%209%203%2012%202%202-1%203%200%205%201%2012%208%2025-7%2015-17l-3-3v-26l-9-2-9-3-10%203m-1%201c-7%202-8%203-8%205l1%202c1-1%2013%203%2013%204l-9-2-5-1v8l1%205c0-3%200-3%202-1%201%202%2011%208%2012%208l1-10v-11l4-1%209-2%206-2-7-2c-8-2-9-2-20%200'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/da873d98f82462fd16703e257e771596/ebf47/1628091098582.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt=\"Redsocks packet flow\" title=\"Redsocks packet flow\" name=\"images/1628091098582.png\" data-src=\"./images/1628091098582.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/da873d98f82462fd16703e257e771596/6f3f2/1628091098582.png 256w,\n/acorns/static/da873d98f82462fd16703e257e771596/01e7c/1628091098582.png 512w,\n/acorns/static/da873d98f82462fd16703e257e771596/ebf47/1628091098582.png 688w\" sizes=\"(max-width: 688px) 100vw, 688px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption \">Redsocks packet flow</div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Here is a brief explanation how does a packet get redirected to <strong class=\"markdown_strong_asterisk\">Redsocks</strong>.</p>\n<ol class=\"markdown_ol\">\n<li><span class=\"xsj_placeholder_span\"></span>When a packet is sent from an app in the system it is handled by the kernel, it triggers the <strong class=\"markdown_strong_asterisk\">NT_ hooks</strong> (defined in &lt;linux/netfilter.h&gt;).</li>\n<li><span class=\"xsj_placeholder_span\"></span>The <strong class=\"markdown_strong_asterisk\">ip_tables kernel module</strong> registers at <strong class=\"markdown_strong_asterisk\">netfilter’s hooks</strong> and proceed them according to defined rules.</li>\n<li><span class=\"xsj_placeholder_span\"></span>We are defining rules using <strong class=\"markdown_strong_asterisk\">the iptables command line utility</strong> (these rules will be described later in this article). And they are defined in the way that some or mostly all packets are redirected to the local process listening on a port, <strong class=\"markdown_strong_asterisk\">12345</strong> in case of <strong class=\"markdown_strong_asterisk\">Redsocks</strong>.</li>\n<li><span class=\"xsj_placeholder_span\"></span>All redirected packets are handled by <strong class=\"markdown_strong_asterisk\">Redsokcs</strong> conforming to the configuration file rules.</li>\n<li><strong class=\"markdown_strong_asterisk\">Redsocks</strong> redirects packets to proxy servers.</li>\n</ol>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"step20120e2809420getting20redsocks20source20code_3\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"step20120e2809420getting20redsocks20source20code_3\" class=\"blank_anchor_name\"></a><a id=\"step20120e2809420getting20redsocks20source20code_3\" class=\"blank_anchor_id\"></a><a name=\"step-1-getting-redsocks-source-code\" class=\"blank_anchor_name\"></a><a id=\"step-1-getting-redsocks-source-code\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Step 1 — Getting Redsocks source code</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">First and foremost, you need to update repositories and installed software on the system.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>yum update<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">In order to install <strong class=\"markdown_strong_asterisk\">Redsocks</strong> we need to compile it at first. Change into a directory you want to keep source code in.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>cd /opt/<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">By default the <strong class=\"markdown_strong_asterisk\">git command line tool</strong> is not installed in most Centos distros. So install it at first.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>yum install git<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">And clone <strong class=\"markdown_strong_asterisk\">Redsocks source code</strong> from the git repository.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>git clone https://github.com/darkk/redsocks<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Now change the directory to the <strong class=\"markdown_strong_asterisk\">redsocks</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>cd redsocks/<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Try to compile the application, but it will probably fail. In my case I don’t have even <strong class=\"markdown_strong_asterisk\">make</strong> installed.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>[root@centos7 redsocks]# make<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>-bash: make: command not found<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>[root@centos7 redsocks]#<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"step20220e2809420compiling20redsocks_4\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"step20220e2809420compiling20redsocks_4\" class=\"blank_anchor_name\"></a><a id=\"step20220e2809420compiling20redsocks_4\" class=\"blank_anchor_id\"></a><a name=\"step-2-compiling-redsocks\" class=\"blank_anchor_name\"></a><a id=\"step-2-compiling-redsocks\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Step 2 — Compiling Redsocks</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Firstly you need to install <strong class=\"markdown_strong_asterisk\">build-tools(Development Tools)</strong> if you haven’t already.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>yum group install \"Development Tools\"<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Next, we need to install dependencies to successfully compile <strong class=\"markdown_strong_asterisk\">Redsocks</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>yum install libevent libevent-devel<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">After installation try to compile <strong class=\"markdown_strong_asterisk\">Redsocks</strong> again using the <strong class=\"markdown_strong_asterisk\">make</strong> command. If compilation succeed you should see the compiled binary file in the current directory.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>[root@centos7 redsocks]# ls -l redsocks<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>-rwxr-xr-x 1 root root 415968 Jul  7 08:49 redsocks<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Now you can copy the binary file to any folder defined in <strong class=\"markdown_strong_asterisk\">the $PATH variable</strong>, to be able to execute it without specifying a full path to <strong class=\"markdown_strong_asterisk\">Redsocks</strong>.</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"step20320e2809420setting20iptables20rules_5\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"step20320e2809420setting20iptables20rules_5\" class=\"blank_anchor_name\"></a><a id=\"step20320e2809420setting20iptables20rules_5\" class=\"blank_anchor_id\"></a><a name=\"step-3-setting-iptables-rules\" class=\"blank_anchor_name\"></a><a id=\"step-3-setting-iptables-rules\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Step 3 — Setting Iptables Rules</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">To redirect necessary packets to <strong class=\"markdown_strong_asterisk\">Redsocks</strong> we need to define some <strong class=\"markdown_strong_asterisk\">iptables rules</strong>. I will use the rules suggested on <a href=\"http://darkk.net.ru/redsocks/\" class=\"xsj_link xsj_manu_link\">the official Redsocks page</a>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span># Create new chain<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>iptables -t nat -N REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">The rule above creates a new custom chain in <strong class=\"markdown_strong_asterisk\">the NAT table</strong>.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Next we need to exclude all local and reserved network addresses. As a result all packets with the destination address from the following ranges will not be sent to <strong class=\"markdown_strong_asterisk\">Redsocks</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span># Exclude local and reserved addresses<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>iptables -t nat -A REDSOCKS -d 0.0.0.0/8 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>iptables -t nat -A REDSOCKS -d 10.0.0.0/8 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>iptables -t nat -A REDSOCKS -d 127.0.0.0/8 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>iptables -t nat -A REDSOCKS -d 169.254.0.0/16 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>iptables -t nat -A REDSOCKS -d 172.16.0.0/12 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>iptables -t nat -A REDSOCKS -d 192.168.0.0/16 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>iptables -t nat -A REDSOCKS -d 224.0.0.0/4 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>iptables -t nat -A REDSOCKS -d 240.0.0.0/4 -j RETURN<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Now we need to add a rule that will redirect all packets from our custom <strong class=\"markdown_strong_asterisk\">REDSOCKS chain</strong> to the local port, we will use the default one – <strong class=\"markdown_strong_asterisk\">12345</strong></p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports 12345<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Please note, this rule doesn’t redirect every packet sent in the system to <strong class=\"markdown_strong_asterisk\">the port 12345</strong>, it only redirects packets that are <strong class=\"markdown_strong_asterisk\">already passed</strong> inside <strong class=\"markdown_strong_asterisk\">the REDSOCKS chain</strong>. You can check this, for example using the following command.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>wget google.com<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Consequently, we need to define a rule that will redirect chosen packets by some criteria to <strong class=\"markdown_strong_asterisk\">the REDSOCKS chain</strong>. You are free to apply any rules you want, but I will show how to redirect all HTTP and HTTPS packets through a proxy. Define the following rules.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span># Redirect all HTTP and HTTPS outgoing packets through Redsocks<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>iptables -t nat -A OUTPUT -p tcp --dport 443 -j REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>iptables -t nat -A OUTPUT -p tcp --dport 80 -j REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Also you may need to define the following rules in the <strong class=\"markdown_strong_asterisk\">PREROUTING chain</strong>. For redirecting incomming packets to <strong class=\"markdown_strong_asterisk\">the REDSOCKS chain</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>iptables -t nat -A PREROUTING -p tcp --dport 1080 -j REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Do not be confused about these rules. They are applied only for incoming packets, that’s why the chain is called <strong class=\"markdown_strong_asterisk\">PRE ROUTING</strong>. Here is the diagram that shows <strong class=\"markdown_strong_asterisk\">the packet flow</strong> through <strong class=\"markdown_strong_asterisk\">iptables tables and chains</strong>.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:514px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 199.21875%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='797'%3e%3cpath%20d='M0%2026v26h71v17l-1%2016-1-3c-1-1-1-2-2-1l2%205%201%205%204%201%203-1-3-1c-1%200-1-1%201-5l2-4c-1-1-2%200-3%203l-2%204V52h71V0H0v26m250%200v26h36c36%200%2037%200%2034%204l-2%206%202-3c2-3%202-2%202%2027v30l-19%2010-18%2010a544%20544%200%200037%2020l-2%205-2%205s2-1%202-3c2-2%202-2%202%208v10h-17c-15%200-18%200-18%202l-1%2015%201%2014c0%202%203%202%2018%202l17%201-3%205-1%205%202-3c2-3%202-3%202%207v10h3l3-1-2-1c-3%200-3%200-3-9s0-9%202-8l1%204%201%201c1-1%200-3-1-5-3-6-4-6%2015-6h17v-33h-35v-11c0-10%200-10%202-7l2%203c1%200%201-1-1-5l-2-4c0-1%208-6%2019-11%2020-11%2022-11%2029-6%206%204%2013%2015%2015%2024a8206%208206%200%20016%2031l2%2024c1%208%202%2062%202%20231%200%20207-1%20220-2%20231-3%2015-8%2032-12%2038-9%2014-24%2013-42-3l-3-3%203%201%203-1-4-2c-2%200-3%200-2-1%203%200%202-2-1-2-4%200-4%201-2%207%201%205%204%207%202%202%200-2%200-2%206%203%2023%2018%2039%2014%2047-14l7-27a13323%2013323%200%2000-2-487l-2-9c-4-28-16-48-29-48-3%200-36-16-40-19l-1-30c0-26%200-29%201-28l2%203%201%201c1%200%200-3-2-5l-2-5h71V0H250v26M1%2026v24h141V1H1v25m251%200v24h140V1H252v25M32%2020l2%201%201%204%201%204%201-4c0-3%200-4%202-4l3%204c1%205%204%205%205%201l1-3v3l3%203%203-9c0-2-2-1-3%202l-1%203v-3c-1-4-3-4-5-1v3l-1-3c0-2-1-2-6-2l-6%201m250%200l1%201c1%200%202%201%202%204%201%205%203%205%203%200%200-6%203-6%205%200%201%205%203%205%204%201l2-3v3c1%204%204%204%205-1v-6l-2%202-1%202-1-2c0-3-3-2-4%201l-1%203v-3c-1-3-1-3-7-3l-6%201M28%2071C16%2076%208%2087%204%20106a28178%2028178%200%20001%20506c0%204%206%2027%209%2033%203%207%209%2013%2014%2015l22%2010%2018%2010v30c0%2024%200%2029-1%2027-2-4-3-1-1%203l2%204H37l-31%201-1%2025v26h372v-51l-27-1h-27v-15c0-13%200-14%202-13l1%203%201%201-1-4c-2-5-3-6-1-6l3-1-3-1c-3%200-4%200-3%201l-2%206-2%205%202-2c2-3%202-3%202%2011v15H71l2-4%201-4-3%203c-1%203-1%200-1-28v-31l19-10%2019-10-19-10c-20-11-19-10-16-16v-4l-2%203c-1%202-1-3-1-22%200-23%200-24%202-24l2-1-3-1h-3v25c0%2023%200%2024-2%2022%200-2-1-3-2-3l2%205%202%205-19%2011c-17%209-17%209-21%208-12-4-20-26-23-66V110c3-19%2013-34%2023-37%209-2%2019%201%2024%208%203%204%203%205%201%203l-3-1%202%203%205%204c2%202%207%203%207%201l-2-1c-1%200-2%200-2-5%200-6-2-8-2-3v3l-6-6c-8-8-16-11-24-8m29%2032c0%204%203%206%203%202h1c2%202%204%203%204%201h1c4%203%2010-1%207-5-2-3-8-2-8%202l-1%202v-3c0-2-1-3-4-3s-3%200-3%204m-22%2011l-1%2017v16h37v15l-2-3c-2-5-2-2%200%203l2%204H25v17l1%2017h45v8c0%208%200%208-2%205-2-5-3-3-1%202l2%204-18%201-17%201-1%2016v17h36v7c0%203%200%206-1%205%200-2-2-3-2-1l2%205%202%204H25v33h92v-33H95c-24%200-24%200-20-6%202-3%202-4%201-4%200%200-2%201-2%203-2%202-2%202-2-5v-8h37v-33l-18-1H73l2-4c2-4%202-5%201-5l-2%202c-1%202-1%201-1-5v-8h45v-34H73l2-4c2-5%202-8%200-3l-2%203v-15h36v-33l-37-1-37%201m270%2012l-16%2010%2017%209%2017%209%2018-9%2016-10-18-9-16-9-18%209m-158%2088v52h100V162H147v52m2%200v50h96V163h-96v51M27%20183v15h89v-30H27v15m126%200l-1%207v6h13v-13l-6-1-6%201m135%2015v14h69v-29h-69v15m-136%208v6h13v-13h-13v7m0%2016v6h13v-13h-13v7m0%2017v6h13v-13h-13v7m128%2011c0%204%202%206%203%203l2-2%202-1%201%201c2%203%207%203%208%201%203-4-3-8-7-5h-2l-4-1c-3%200-3%200-3%204m25-3l1%201%201%203c0%202%201%203%202%203l1-3c0-2%201-3%202-3l1%203c0%203%203%204%203%201h1c2%202%204%203%204%201h1c4%203%2010-1%207-5-2-3-8-2-8%202l-1%202v-3c0-2-1-3-8-3l-7%201m-153%208v6h13v-13h-13v7m130%2025v16h20l20%201-3%204-1%205h1l1-3c2-1%202-1%202%205v7h-20l-20%201v33h81v-33l-20-1h-19v-6c0-5%201-6%201-4l2%202c1%200%201-1-1-5-3-6-4-6%2018-6h19v-33h-81v17M70%20321c0%205%200%208-1%207l-1-2c-1%200-1%201%201%204%202%205%202%205-18%205H32v33h36v14c0%2014%200%2014-2%2011l-2-3%201%206%203%204-3%202a647%20647%200%2001-35%2019l8%205%2019%2010%2011%205v13c0%2011%200%2012-1%2011l-2-3-1-1%201%205c2%202%203%205%202%206l3%201c4%200%205-2%202-2-2%200-2-1%200-5%202-5%201-7-1-2-1%203-2%203-2-9l1-14a489%20489%200%200143-20c6%200%206%200%205%201l-3%202-1%201c1%201%203%200%206-2%206-3%206-3-2-6-5-2-5-1-1%201l4%202h-15l-19-10-18-10%203-4c3-5%202-7-1-3l-2%203v-14l1-13%2020-1h21v-32l-19-1-19-1%202-4%201-4-2%203c-2%204-2%202-2-6%200-9%200-9%203-9%202-1%202-1-1-1h-4v8m-36%2031v15h75v-30H34v15m264%203c-1%201%200%201%201%201%203%200%202%201-2%204l-3%204%203-1c3-3%203-2%201%203a285%20285%200%2001-31%2055c1%200%201%201%207-7%209-14%2017-29%2027-50l1-2v2c0%205%202%203%202-1%200-7-1-9-4-9l-2%201m24%200v1l-2%206c-2%202-3%204-2%205l1-1%201-3c2-1%202-1%202%209v10l-18%209-19%2010%2018%2011%2019%2010-3%205-1%205c1%200%202-1%202-3%202-3%202-3%202%204v8h3c2%200%203%200%202-1l-2-1c-1%200-2-1-2-6%200-6%200-6%201-5l2%203%201%201-1-5-3-5%2019-10%2018-11-19-10-18-9v-11c0-10%200-10%202-7l2%203c1%200%201-1-1-5-3-5-3-6%200-6l2-1h-6m-17%2037l-18%209%2018%2010%2018%209%2017-9%2016-10-17-9-16-9-18%209M50%20412l-17%209%208%204%2018%2010%2010%205%208-5a689%20689%200%200126-14l-34-18-19%209m83%2018v16h57v-16h5c5%200%205%200%203%201l-3%202-1%201c0%201%201%201%205-1l4-2%201%208v7h56v-33h-56v8c0%208%200%208-5%206-3-2-6-2-4%200%202%201%202%201-1%201h-4v-15h-57v17m73%200v14h26l26%201v-30h-52v15m91%2051l1%2017h11c13%200%2013%200%2010%206l-1%204%202-2c1-2%201-1%201%204v6h-44l-1%2016v17h22l23%201-2%205c-2%204-2%205-1%205l2-3c1-2%201-2%201%204v6h-12l-11%201-1%2016v17h12l12%201-2%204c-2%204-2%205-1%205l2-2c1-2%201%200%201%206v8h-45v33h23l22%201-2%204c-2%204-2%205-1%205l2-2c1-2%201-1%201%203v6h-24v33h51v-33h-25v-13l2%203%202%203c1%200%201-1-1-6l-3-4h46v-33h-45l-1-9c0-9%200-9%202-6l2%203c1%200%201-1-1-6l-3-4h25v-33l-13-1h-12v-7c0-6%200-6%202-4%200%202%202%203%202%203l-2-5-2-5h46v-33h-46v-7c0-7%200-7%201-4l3%203-1-5-3-5h24v-34h-50v17m2%200v15h46v-30h-46v15m-236%200c0%203%200%207%202%208l1-1c0-3%205-4%206-2%201%204%207%203%207-2l2-2%201%204c0%204%202%204%203-1%200-2%201-3%202-3v-1l-5-1c-5%200-6%201-6%203%200%204-2%204-2%200%200-3-2-4-3-1h-1c-1-2-6-3-7-1m-19%2015l-1%2016v16h25v9c0%208%200%2010-2%206l-2-3%202%205%202%205H38v17l1%2017h59v-34H70l2-4a633%20633%200%2000-1-4l-1-5v-8l12-1h12v-33H69l-25%201m-4%2071v15h56v-30H40v15m238%2072v15h89v-30h-89v15m-222%209a1372%201372%200%2001-21%2012l34%2018%2035-18-4-3-18-9-13-7-13%207m104%2043c0%201%201%203%203%203h1l2%201%201-2h1c2%201%206%201%208-1h1l1%202h3l2%201%201-1%201-1c1%201%202%200%202-1%200-2-4-4-6-2h-14c0-1-6-1-7%201M7%20770v24h368v-48H7v24'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/dea13/1628091098586.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt title name=\"images/1628091098586.png\" data-src=\"./images/1628091098586.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/6f3f2/1628091098586.png 256w,\n/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/01e7c/1628091098586.png 512w,\n/acorns/static/6ff9868b0ea9a6ef158cd4c88625734b/dea13/1628091098586.png 514w\" sizes=\"(max-width: 514px) 100vw, 514px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption story_image_blank_caption\"></div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Furthermore, you are free to define any rules you need, just remember to jump <strong class=\"markdown_strong_asterisk\">(-j REDSOCKS)</strong> to the <strong class=\"markdown_strong_asterisk\">REDSOCKS chain</strong>. Here another example from the official documentation. It redirects only packets sent <strong class=\"markdown_strong_asterisk\">from a specific user</strong>, this could be very useful in some cases. You can follow the <strong class=\"markdown_strong_asterisk\">user per application strategy (similar used in Android)</strong>, as a result you will be able set <strong class=\"markdown_strong_asterisk\">application specific rules</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>iptables -t nat -A OUTPUT -p tcp -m owner --uid-owner crosp -j REDSOCKS<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">One more important point, avoid using <strong class=\"markdown_strong_asterisk\">the root user</strong> in <strong class=\"markdown_strong_asterisk\">iptables rules</strong> or you may get stuck in <strong class=\"markdown_strong_asterisk\">the infinite loop</strong>. Here is <a href=\"https://github.com/darkk/redsocks/issues/108\" class=\"xsj_link xsj_manu_link\">a problem</a> I’ve encountered because of my inattention.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Having set iptables rules the final step is to <strong class=\"markdown_strong_asterisk\">configure Redsocks</strong> itself using the configuration file.</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"step20420e2809420configuring20redsocks_6\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"step20420e2809420configuring20redsocks_6\" class=\"blank_anchor_name\"></a><a id=\"step20420e2809420configuring20redsocks_6\" class=\"blank_anchor_id\"></a><a name=\"step-4-configuring-redsocks\" class=\"blank_anchor_name\"></a><a id=\"step-4-configuring-redsocks\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Step 4 — Configuring Redsocks</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Create a file with the name <strong class=\"markdown_strong_asterisk\">redsocks.conf</strong> in the same directory (or any other directory) where the binary file is located. And let’s start by defining the <strong class=\"markdown_strong_asterisk\">base section</strong> of the configuration file as follows.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>base {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span> log_debug = on;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span> log_info = on;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span> log = \"stderr\";<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span> daemon = off;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span> redirector = iptables;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">I think each parameter is self-explanatory. You can find a complete description of every option in the example of <a href=\"https://github.com/darkk/redsocks/blob/master/redsocks.conf.example\" class=\"xsj_link xsj_manu_link\">configuration file</a> in the <a href=\"https://github.com/darkk/redsocks\" class=\"xsj_link xsj_manu_link\">official repository</a>.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Next we need to define <strong class=\"markdown_strong_asterisk\">proxies</strong>. This is done using <strong class=\"markdown_strong_asterisk\">redsocks sections</strong>. Here is an example of a possible proxy configuration.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>redsocks {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>    // Local IP listen to<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>    local_ip = 127.0.0.1;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>    // Port to listen to<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>    local_port = 12345;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>    // Remote proxy address<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>    ip = super.socks.proxy.com;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>    port = 9966;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>    // Proxy type<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span>    type = socks5;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span>    // Username to authorize on proxy server<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span>    login = anonymous;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span>    // Password for a proxy user<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span>    password = verystrongpassword;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span>    // Do not disclose real IP<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span>    disclose_src = false;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">As you can see from the configuration above, this is the <strong class=\"markdown_strong_asterisk\">SOCKS5 proxy configuration</strong>. Redsocks will listen to the <strong class=\"markdown_strong_asterisk\">port 12345</strong>. We have provided credentials to authenticate ourselves on the proxy server as well.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">You create multiple <strong class=\"markdown_strong_asterisk\">redsocks sections</strong>. But you have to specify <strong class=\"markdown_strong_asterisk\">a different local port</strong> and as a result you need to set <strong class=\"markdown_strong_asterisk\">appropriate iptables rules</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>redsocks {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>    // Local IP listen to<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>    local_ip = 127.0.0.1;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>    // Port to listen to<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>    local_port = 83333;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>    // Remote proxy address<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>    ip = puper.socks.proxy.com;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>    port = 6699;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>    // Proxy type<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span>    type = socks5;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span>    // Username to authorize on proxy server<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span>    login = anonymous2;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span>    // Password for a proxy user<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span>    password = verystrongpassword;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span>    // Do not disclose real IP<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span>    disclose_src = false;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">As an example, you can use the tricky technique to simulate <strong class=\"markdown_strong_asterisk\">load balancing</strong> with the help of <strong class=\"markdown_strong_asterisk\">the random module</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>iptables -t nat -A REDSOCKS -p tcp -m random --mode random --probability 0.5 -j REDIRECT --to-ports 83333<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports 12345<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">There are lot of other ways to define iptables rules for using with <strong class=\"markdown_strong_asterisk\">multiple proxies</strong>, for instance you can use <strong class=\"markdown_strong_asterisk\">the mangle table</strong>, <strong class=\"markdown_strong_asterisk\">create another chain</strong> (ex. REDSOCKS_HTTP) and so on.</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"step20520e2809420testing20proxies20with20redsocks_7\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"step20520e2809420testing20proxies20with20redsocks_7\" class=\"blank_anchor_name\"></a><a id=\"step20520e2809420testing20proxies20with20redsocks_7\" class=\"blank_anchor_id\"></a><a name=\"step-5-testing-proxies-with-redsocks\" class=\"blank_anchor_name\"></a><a id=\"step-5-testing-proxies-with-redsocks\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Step 5 — Testing proxies with Redsocks</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Now it is time to test our configuration. Save the configuration file. Navigate to the folder with the <strong class=\"markdown_strong_asterisk\">Redsocks compiled executable file</strong>. And execute the following command.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>./redsocks -c /etc/redsocks.conf<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">If your configuration file is valid and there are no other errors you should almost return immediately in case or running in <strong class=\"markdown_strong_asterisk\">the daemon mode</strong> or see the similar output <strong class=\"markdown_strong_asterisk\">with the daemon mode off</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>1499876514.801445 notice main.c:165 main(...) redsocks started, conn_max=128<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Furthermore, you can use <strong class=\"markdown_strong_asterisk\">the netstat tool</strong> to get list of processes <strong class=\"markdown_strong_asterisk\">bound to ports</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>[root@centos ~]# netstat -tulpn<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>Active Internet connections (only servers)<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>tcp        0      0 127.0.0.1:27017         0.0.0.0:*               LISTEN      533/mongod<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      50/sshd<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>tcp        0      0 127.0.0.1:12345         0.0.0.0:*               LISTEN      465/./redsocks<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>tcp6       0      0 :::22                   :::*                    LISTEN      50/sshd<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>udp        0      0 0.0.0.0:14332           0.0.0.0:*                           229/dhclient<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>udp        0      0 0.0.0.0:68              0.0.0.0:*                           229/dhclient<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span>udp6       0      0 :::28185                :::*                                229/dhclient<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">Now try to make any request as <strong class=\"markdown_strong_asterisk\">the specified user</strong> or to match a rule you defined on your own. For example, use the following curl request to get <strong class=\"markdown_strong_asterisk\">your external IP address</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>curl 'https://api.ipify.org?format=json'<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">If <strong class=\"markdown_strong_asterisk\">the redsocks process</strong> is attached to the terminal, you should see something like that in <strong class=\"markdown_strong_asterisk\">stderr</strong>.</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>1499882494.465788 info redsocks.c:1243 redsocks_accept_client(...) [192.168.0.128:34470-&gt;50.19.238.1:443]: accepted<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>1499882495.249026 debug redsocks.c:341 redsocks_start_relay(...) [192.168.0.128:34470-&gt;50.19.238.1:443]: data relaying started<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>1499882496.359465 info redsocks.c:671 redsocks_drop_client(...) [192.168.0.128:34470-&gt;50.19.238.1:443]: connection closed<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">If you encountered any error check debug output in the first place.</p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"conclusion_8\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"conclusion_8\" class=\"blank_anchor_name\"></a><a id=\"conclusion_8\" class=\"blank_anchor_id\"></a><a name=\"conclusion\" class=\"blank_anchor_name\"></a><a id=\"conclusion\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">Conclusion</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">In this tutorial I’ve described how to install <strong class=\"markdown_strong_asterisk\">Redsocks</strong> on <strong class=\"markdown_strong_asterisk\">Centos 7</strong>. Redsocks provides a very convenient way to configure a proxy environment, starting from a single proxy server to a dozens of proxies of different type. In addition if you are missing some features <a href=\"https://github.com/darkk/redsocks\" class=\"xsj_link xsj_manu_link\">in the original project</a>, you can check out a fork – <a href=\"https://github.com/semigodking/redsocks\" class=\"xsj_link xsj_manu_link\">Redsocks2</a>.</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">I hope this tutorial was useful for you. If you have any troubles with setting up Redsocks, please feel free to leave comments below.</p>\n</div>\n\n","excerpt":"Redsocks is the tool that allows you to proxify(redirect) network traffic through a SOCKS4, SOCKS5 or HTTPs proxy server. It works on the lo...","docType":"posts","slug":"https:/crospnet/blog/administration/install-configure-redsocks-proxy-centos-linux","title":"How to install and configure Redsocks on Centos Linux","customCss":"","createDate":"August 04, 2021","updateDate":"August 04, 2021","tags":["技术","代理","网络"]}},"pageContext":{"slug":"https:/crospnet/blog/administration/install-configure-redsocks-proxy-centos-linux","zipPath":"/home/runner/work/acorns/acorns/posts/net/How to install and configure Redsocks on Centos Linux.zip","prev":{"title":"2021-8-4 魔术头巾的绑法","docType":"posts","slug":"bike_magic"},"next":{"title":"利用PPTP, redsocks, iptables, https/socks5 proxy实现全局代理上网","docType":"posts","slug":"https:/docsgooglecom/document/d/1OGIrebKWq__Lt0ADxprxapevC1BEzPaR6ry9XY_WDdA"},"pluginOptions":{"tagsPath":"/tags/","archivesPath":"/archives/","basePath":"/","commentType":"gitalk"},"basePath":"/"}},"staticQueryHashes":["2682448919","2682448919"]}